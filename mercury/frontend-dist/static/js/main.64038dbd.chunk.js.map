{"version":3,"sources":["utils.ts","slices/authSlice.ts","components/LoginButton.tsx","components/UserButton.tsx","components/NavBar.tsx","slices/appSlice.ts","widgets/Types.tsx","components/WindowDimensions.tsx","slices/sitesSlice.ts","slices/notebooksSlice.ts","slices/tasksSlice.ts","widgets/Checkbox.tsx","widgets/Numeric.tsx","widgets/Range.tsx","widgets/Select.tsx","widgets/Slider.tsx","widgets/File.tsx","widgets/Text.tsx","slices/wsSlice.tsx","widgets/Markdown.tsx","websocket/Provider.tsx","components/StatusBar.tsx","widgets/Button.tsx","components/RunButton.tsx","components/SideBar.tsx","components/MainView.tsx","components/FileItem.tsx","components/FilesView.tsx","components/MadeWithDiv.tsx","components/RestAPIView.tsx","components/WaitPDFExport.tsx","components/ShareDialog.tsx","components/DefaultLogo.tsx","views/AppView.tsx","views/App.tsx","components/Footer.tsx","components/HomeNavBar.tsx","views/AccountView.tsx","slices/versionSlice.ts","views/HomeView.tsx","views/LoginView.tsx","views/LostConnection.tsx","views/SiteAccessForbiddenView.tsx","views/SiteLoadingView.tsx","views/SiteNetworkErrorView.tsx","views/SiteNotFoundView.tsx","views/SitePleaseRefreshView.tsx","views/SiteNotReadyView.tsx","views/NotebookNotFoundView.tsx","components/RequireAuth.tsx","views/OpenAPIView.tsx","Routes.tsx","Root.tsx","store.ts","rootReducer.ts","index.tsx"],"names":["getSessionId","forceReload","sessionId","sessionStorage","getItem","uuidv4","setItem","setAxiosAuthToken","token","axios","defaults","headers","common","handleDownload","url","filename","get","responseType","then","res","fileDownload","data","catch","err","toast","error","initToken","localStorage","initialState","username","user","pk","first_name","last_name","email","authSlice","createSlice","name","reducers","setToken","state","action","payload","removeItem","setUsername","setUserInfo","actions","getToken","auth","getUsername","getUserInfo","LoginButton","style","color","padding","float","to","className","aria-hidden","UserButton","dispatch","useDispatch","navigate","useNavigate","margin","href","role","id","data-bs-toggle","aria-expanded","aria-labelledby","onClick","a","post","success","logout","NavBar","isSitePublic","logoSrc","navbarColor","headerBgClass","headerStyle","backgroundColor","alt","src","height","paddingLeft","appSlice","view","files","filesState","showSideBar","storageType","showShareDialog","setView","setFilesState","setFiles","setShowSideBar","toggleShowSideBar","setStorageType","setShowShareDialog","getView","app","getOutputFilesState","getOutputFiles","getShowSideBar","getStorageType","getShowShareDialog","deleteUserFileUploaded","siteId","site_id","session_id","console","isSelectWidget","widget","input","isCheckboxWidget","isNumericWidget","isSliderWidget","isRangeWidget","isFileWidget","isTextWidget","isOutputFilesWidget","output","isMarkdownWidget","isButtonWidget","getWindowDimensions","window","width","innerWidth","innerHeight","SiteStatus","site","siteStatus","Unknown","sitesSlice","setSite","setSiteStatus","getSiteStatus","sites","getSiteId","getSiteWelcome","welcome","isPublic","share","getLogoFilename","undefined","info","JSON","parse","logoFilename","getNavbarColor","getFooterText","footerText","fetchSite","siteSlug","process","REACT_APP_SERVER_URL","location","host","split","origin","endsWith","status","NotReady","Loaded","log","message","NetworkError","response","AccessForbidden","NotFound","PleaseRefresh","notebooks","loadingState","selectedNotebook","selectedNotebookId","loadingStateSelected","watchModeCounter","slidesHash","widgets","widgetsUrlValues","nbIframes","widgetsInitialized","urlValuesUsed","notebooksSlice","setWidgetValue","key","value","setWidgetUrlValue","clearWidgets","clearWidgetsUrlValues","setNotebooks","setLoadingState","setSelectedNotebook","startsWith","file_updated_at","setLoadingStateSelected","setSlidesHash","updateWidgetsParams","widgetKey","updated","noMatch","Object","keys","params","disabled","hidden","min","max","step","label","rows","choices","toString","hideWidgets","initWidgets","updateTitle","title","updateShowCode","setNbIframes","setWidgetsInitialized","setUrlValuesUsed","getNotebooks","getLoadingState","getSelectedNotebook","getSelectedNotebookId","isStaticNotebook","st","static_notebook","getLoadingStateSelected","getSlidesHash","getWidgetsValues","getWidgetsUrlValues","getWidgetsInitialized","getUrlValuesUsed","fetchNotebooks","clearExecutionHistory","parsedNotebooks","map","notebook","parsedParams","tasksSlice","currentTask","historicTask","showCurrent","previousTask","exportingToPDF","exportToPDFJobId","exportToPDFCounter","executionHistory","setShowCurrent","setCurrentTask","setHistoricTask","setPreviousTask","copyCurrentToPreviousTask","setExportingToPDF","setExportToPDFJobId","resetExportToPDFCounter","increaseExportToPDFCounter","stopPDFExport","setExecutionHistory","getCurrentTask","tasks","getHistoricTask","getPreviousTask","getExportingToPDF","getExportToPDFJobId","getExportToPDFCounter","scrapeSlidesHash","iframeElement","document","getElementById","hash","contentWindow","CheckboxWidget","runNb","url_key","useState","userInteraction","useSearchParams","searchParams","useEffect","urlValue","toLowerCase","display","type","onChange","checked","htmlFor","NumericWidget","continuousUpdate","apply","showApply","minValue","maxValue","stepValue","displayValue","isNaN","parseFloat","validateValue","e","target","onBlur","onKeyPress","preventDefault","position","top","left","fontSize","border","RangeWidget","vertical","i","length","values","paddingTop","justifyContent","flexWrap","onFinalChange","renderTrack","props","children","onMouseDown","onTouchStart","ref","borderRadius","background","getTrackBackground","colors","alignSelf","renderThumb","index","isDragged","alignItems","boxShadow","outline","fontWeight","fontFamily","SelectWidget","multi","selectStyles","menu","base","zIndex","arr","filter","includes","selectedValue","selectedValues","options","choice","push","isDisabled","styles","isMulti","isSingleOption","vs","Array","from","SliderWidget","vals","FileWidget","maxFileSize","useSelector","fileSizeLimit","storage_type","mediaServerActions","baseURL","revert","uniqueFileId","load","delete","s3ServerActions","fieldName","file","metadata","progress","abort","abortController","AbortController","size","config","onUploadProgress","progressEvent","total","loaded","put","signal","userFileUploaded","onprocessfile","serverId","server","labelIdle","TextWidget","sanitize","rowsValue","sanitizeString","input_string","replace","registerPlugin","FilePondPluginImageExifOrientation","FilePondPluginImagePreview","FilePondPluginFileValidateSize","WebSocketState","WorkerState","MarkdownWidget","rehypePlugins","remarkGfm","rehypeHighlight","emoji","rehypeRaw","webSocketState","workerState","workerId","notebookSrc","tryConnectCount","wsSlice","setWebSocketState","setWorkerState","setWorkerId","setNotebookSrc","increaseTryConnectCount","resetTryConnectCount","getWebSocketState","ws","getWorkerState","getWorkerId","getNotebookSrc","getTryConnectCount","runNotebook","widgets_params","purpose","WebSocketContext","createContext","wsServer","localServer","REACT_APP_SERVER_WS","connectCounter","globalConnection","WebSocketProvider","isStatic","connection","MAX_CONNECT_COUNT","close","sendMessage","readyState","OPEN","send","onOpen","event","stringify","address","Connected","ping","onMessage","MaxIdleTimeReached","MaxRunTimeReached","reloadNotebook","silent","show_sidebar","fetchNotebook","body","showCode","onError","Disconnected","onClose","setTimeout","connect","WebSocket","onopen","onmessage","onerror","onclose","Provider","StatusBar","allowDownload","allowShare","waiting","staticNotebook","notebookId","notebookPath","notebookTitle","runDownloadHTML","runDownloadPDF","wsStatus","LostConnection","wifiColor","workerColor","Running","Busy","Missing","paddingBottom","xmlns","fill","viewBox","d","fillRule","strokeWidth","stroke","strokeLinecap","strokeLinejoin","cursor","notebook_id","notebook_path","job_id","exportToPDF","ButtonWidget","selectedClass","marginRight","RunButton","SideBar","notebookSchedule","taskCreatedAt","widgetsParams","watchMode","displayEmbed","showFiles","isPresentation","notebookParseErrors","widgetsValues","useContext","execNb","entries","widgetParams","fileKeys","widgetKeys","parts","sort","b","additionalStyle","addSpaceInsteadTitle","overflowY","blocking","data-toggle","data-placement","UsageLimitReached","reload","Queued","Starting","MainView","appView","errorMsg","columnsWidth","fullScreen","windowDimensions","setWindowDimensions","handleResize","addEventListener","removeEventListener","useWindowDimensions","iframeHeight","nb","indexOf","splitted","injectCode","nbPath","nbSrc","mainStyle","paddingRight","divStyle","maxWidth","hideBlockUi","tag","reloadDocument","srcDoc","html","FileItem","fname","downloadLink","firstItem","lastItem","marginBottom","borderTopRightRadius","borderTopLeftRadius","borderBottomRightRadius","borderBottomLeftRadius","FilesView","filesLinks","myFiles","f","pop","marginTop","MadeWithDiv","rel","RestAPIView","slug","taskSessionId","msg","setResponse","examplePostData","fetchResponse","postRequest","WaitPDFExport","counter","jobId","exportingPDF","ready","getPDF","autoClose","ShareDialog","noUrlKeys","urlParams","v","join","slice","transform","aria-label","pathname","AppView","isSingleApp","notebookSlug","task","outputFiles","outputFilesState","setLogoSrc","pleaseWait","isWatchMode","NotebookNotFound","fetchNotebookWithSlug","version","fetchWorkerOutputFiles","default_view_path","result","showRestApi","DefaultLogoSrc","schedule","created_at","areOutputFilesAvailable","errors","continuous_update","allow_download","doAllowDownload","allow_share","doAllowShare","full_screen","isFullScreen","MyApp","useParams","embed","Footer","bottom","lineHeight","borderTop","textAlign","textDecoration","AccountView","oldPassword","setOldPassword","newPassword1","setNewPassword1","newPassword2","setNewPassword2","old_password","new_password1","new_password2","changePassword","versionSlice","fetchingIsPro","isPro","setVersion","setWelcome","getWelcome","HomeView","showButton","setShowButton","siteWelcome","fetchWelcome","firstLetters","text","count","notebookItems","overflow","scrolling","onMouseEnter","onMouseLeave","description","right","welcomeMd","LoginView","setEmail","password","setPassword","redirectPath","useLocation","onSubmit","stopPropagation","non_field_errors","fetchToken","placeholder","required","SiteAccessForbiddenView","SiteLoadingView","SiteNetworkErrorView","SiteNotFoundView","SitePleaseRefreshView","SiteNotReadyView","NotebookNotFoundView","RequireAuth","isPublicSite","OpenAPIView","notebookApis","endpoint","parameters","p","w","s","desc","getTask","schema","App","AppLayout","AppRoutes","path","element","Root","store","history","createBrowserHistory","rootReducer","combineReducers","notebooksReducer","tasksReducer","versionReducer","appReducer","authReducer","wsReducer","sitesReducer","middleware","getDefaultMiddleware","configureStore","reducer","preloadedState","render","hideProgressBar","newestOnTop","closeOnClick","pauseOnHover"],"mappings":"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","file":"static/js/main.64038dbd.chunk.js","sourcesContent":["import { v4 as uuidv4 } from 'uuid';\r\nimport axios from \"axios\";\r\nimport fileDownload from \"js-file-download\";\r\nimport { toast } from 'react-toastify';\r\n\r\nexport const getSessionId = (forceReload: boolean = false): string => {\r\n    var sessionId = sessionStorage.getItem(\"sessionId\");\r\n    if (sessionId === null || forceReload === true) {\r\n        sessionId = uuidv4();\r\n        sessionStorage.setItem(\"sessionId\", sessionId);\r\n    }\r\n    return sessionId;\r\n}\r\n\r\nexport const setAxiosAuthToken = (token: string | null) => {\r\n    if (typeof token !== \"undefined\" && token) {\r\n        // Apply for every request\r\n        axios.defaults.headers.common[\"Authorization\"] = \"Token \" + token;\r\n    } else {\r\n        // Delete auth header\r\n        delete axios.defaults.headers.common[\"Authorization\"];\r\n    }\r\n};\r\n\r\nexport const handleDownload = (url: string, filename: string) => {\r\n    axios\r\n        .get(url, {\r\n            responseType: \"blob\",\r\n        })\r\n        .then((res) => {\r\n            fileDownload(res.data, filename);\r\n        })\r\n        .catch((err) => {\r\n            toast.error(`Error during ${filename} download`)\r\n        })\r\n};","/* eslint-disable import/no-cycle */\r\nimport {\r\n  createSlice,\r\n  PayloadAction,\r\n  AnyAction,\r\n  Dispatch,\r\n} from \"@reduxjs/toolkit\";\r\nimport axios, { AxiosError } from \"axios\";\r\nimport { NavigateFunction } from \"react-router-dom\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nimport { RootState } from \"../store\";\r\nimport { setAxiosAuthToken } from \"../utils\";\r\n\r\nlet initToken = null;\r\nif (localStorage.getItem(\"token\")) {\r\n  initToken = localStorage.getItem(\"token\");\r\n  setAxiosAuthToken(initToken);\r\n}\r\n\r\ntype UserType = {\r\n  pk: number;\r\n  username: string;\r\n  first_name: string;\r\n  last_name: string;\r\n  email: string;\r\n};\r\n\r\nconst initialState = {\r\n  token: initToken as string | null,\r\n  username: \"\" as string,\r\n  user: {\r\n    pk: 0,\r\n    username: \"\",\r\n    first_name: \"\",\r\n    last_name: \"\",\r\n    email: \"\",\r\n  } as UserType,\r\n};\r\n\r\nconst authSlice = createSlice({\r\n  name: \"auth\",\r\n  initialState,\r\n  reducers: {\r\n    setToken(state, action: PayloadAction<string | null>) {\r\n      state.token = action.payload;\r\n      setAxiosAuthToken(state.token);\r\n      if (state.token) {\r\n        localStorage.setItem(\"token\", state.token);\r\n      } else {\r\n        localStorage.removeItem(\"token\");\r\n      }\r\n    },\r\n    setUsername(state, action: PayloadAction<string | null>) {\r\n      state.username = action.payload ? action.payload : \"\";\r\n      if (state.username && state.username !== \"\") {\r\n        localStorage.setItem(\"username\", state.username);\r\n      } else {\r\n        localStorage.removeItem(\"username\");\r\n      }\r\n    },\r\n    setUserInfo(state, action: PayloadAction<UserType>) {\r\n      state.user = action.payload;\r\n    },\r\n  },\r\n});\r\n\r\nexport default authSlice.reducer;\r\n\r\nexport const { setToken, setUsername, setUserInfo } = authSlice.actions;\r\n\r\nexport const getToken = (state: RootState) => state.auth.token;\r\nexport const getUsername = (state: RootState) => state.auth.username;\r\nexport const getUserInfo = (state: RootState) => state.auth.user;\r\n\r\nexport const fetchToken =\r\n  (\r\n    email: string,\r\n    password: string,\r\n    redirectPath: string,\r\n    navigate: NavigateFunction\r\n  ) =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n      try {\r\n        const url = \"/api/v1/auth/login/\";\r\n        const { data } = await axios.post(url, { email, password });\r\n\r\n        dispatch(setToken(data.key));\r\n        dispatch(setUsername(email.split(\"@\")[0]));\r\n        toast.success(\"Log in successfull\");\r\n        // redirect ...\r\n        navigate(redirectPath);\r\n      } catch (error) {\r\n        const err = error as AxiosError;\r\n\r\n        if (err?.message === \"Network Error\") {\r\n          toast.info(\"Problem with server connection\")\r\n        } else {\r\n          type RegisterErrorType = {\r\n            non_field_errors?: string[];\r\n\r\n          };\r\n\r\n          const data = err.response?.data as RegisterErrorType;\r\n          let msg = \"Problem during authentication. \";\r\n          if (data.non_field_errors !== undefined) {\r\n            msg += data.non_field_errors;\r\n          }\r\n          toast.error(msg);\r\n        }\r\n      }\r\n    };\r\n\r\nexport const logout =\r\n  (navigate: NavigateFunction) => async (dispatch: Dispatch<AnyAction>) => {\r\n    try {\r\n      const url = \"/api/v1/auth/logout/\";\r\n      await axios.post(url);\r\n      toast.success(\"Log out successfull\");\r\n      dispatch(setToken(\"\"));\r\n      dispatch(setUsername(\"\"));\r\n      navigate(\"/\");\r\n    } catch (error) {\r\n      toast.error(\"Problem during log out\");\r\n    }\r\n  };\r\n\r\nexport const fetchUserInfo = () => async (dispatch: Dispatch<AnyAction>) => {\r\n  try {\r\n    const url = \"/api/v1/auth/user/\";\r\n    const { data } = await axios.get(url);\r\n    dispatch(setUserInfo(data));\r\n  } catch (error) {\r\n    console.log(`Problem during getting user info. ${error}`);\r\n  }\r\n};\r\n\r\nexport const changePassword =\r\n  (oldPassword: string, newPassword1: string, newPassword2: string) =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n      try {\r\n        const url = \"/api/v1/auth/password/change/\";\r\n        await axios.post(url, {\r\n          old_password: oldPassword,\r\n          new_password1: newPassword1,\r\n          new_password2: newPassword2,\r\n        });\r\n        toast.success(\"Password changed successfully\");\r\n      } catch (error) {\r\n        // const err = error as AxiosError;\r\n        // if (err !== undefined && err.response !== undefined && err.response.data !== undefined) {\r\n        //   const msg = Object.values(err.response.data);\r\n        //   toast.error(\"Password not changed.\" + msg);\r\n        // } else {\r\n        //   toast.error(\"Password not changed. Problem during password change.\");\r\n        // }\r\n        toast.error(\"Password not changed. Problem during password change.\");\r\n      }\r\n    };\r\n","import React from \"react\";\nimport { Link } from \"react-router-dom\";\n\nexport default function LoginButton() {\n  return (\n    <div style={{ color: \"white\", padding: \"5px\", float: \"right\" }}>\n      <Link to=\"/login\" className=\"btn btn-primary btn-sm \">\n        <i className=\"fa fa-sign-in\" aria-hidden=\"true\"></i> Log in\n      </Link>\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport { logout } from \"../slices/authSlice\";\n\ntype UserButtonProps = {\n  username: string;\n};\n\nexport default function UserButton({ username }: UserButtonProps) {\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n  return (\n    <div>\n      <div className=\"dropdown\" style={{ float: \"right\" }}>\n        <a\n          className=\"btn btn-secondary btn-sm dropdown-toggle\"\n          style={{ margin: \"5px\" }}\n          href=\"#\"\n          role=\"button\"\n          id=\"dropdownMenuLink\"\n          data-bs-toggle=\"dropdown\"\n          aria-expanded=\"false\"\n        >\n          {username}\n        </a>\n\n        <ul\n          className=\"dropdown-menu dropdown-menu-end\"\n          aria-labelledby=\"dropdownMenuLink\"\n        >\n          <li>\n            <Link className=\"dropdown-item\" to=\"/account\">\n              <i className=\"fa fa-user\" aria-hidden=\"true\"></i> Account\n            </Link>\n          </li>\n          <li>\n            <hr className=\"dropdown-divider\" />\n          </li>\n          <li>\n            <Link\n              to={\"/\"}\n              className=\"dropdown-item\"\n              onClick={() => dispatch(logout(navigate))}\n            >\n              <i className=\"fa fa-sign-out\" aria-hidden=\"true\"></i> Log out\n            </Link>\n          </li>\n        </ul>\n      </div>\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport LoginButton from \"./LoginButton\";\nimport UserButton from \"./UserButton\";\n\ntype NavBarProps = {\n  isSitePublic: boolean;\n  username: string;\n  logoSrc: string;\n  navbarColor: string;\n};\n\nexport default function NavBar({\n  isSitePublic,\n  username,\n  logoSrc,\n  navbarColor,\n}: NavBarProps) {\n  \n  let headerBgClass = \"\";\n  let headerStyle = {};\n  if (navbarColor === \"\") {\n    headerBgClass = \"bg-dark\";\n  } else {\n    headerStyle = {\n      backgroundColor: navbarColor,\n    };\n  }\n\n  return (\n    <header\n      className={`navbar navbar-dark sticky-top ${headerBgClass} flex-md-nowrap p-0`}\n      style={headerStyle}\n    >\n      <Link className=\"navbar-brand col-md-3 col-lg-3 me-0 px-3\" to=\"/\">\n        {logoSrc !== \"\" && logoSrc !== \"loading\" && (\n          <img\n            alt=\"\"\n            src={logoSrc}\n            style={{ height: \"28px\", paddingLeft: \"10px\" }}\n          />\n        )}\n      </Link>\n\n      {!isSitePublic && username === \"\" && <LoginButton />}\n      {username !== \"\" && <UserButton username={username} />}\n    </header>\n  );\n}\n","/* eslint-disable import/no-cycle */\r\nimport {\r\n  createSlice,\r\n  PayloadAction,\r\n  AnyAction,\r\n  Dispatch,\r\n} from '@reduxjs/toolkit';\r\nimport axios from 'axios';\r\n\r\nimport { RootState } from '../store';\r\nimport { getSessionId } from '../utils';\r\n\r\n\r\nconst initialState = {\r\n  view: \"app\",\r\n  files: [] as string[],\r\n  filesState: \"unknown\",\r\n  showSideBar: true,\r\n  storageType: \"media\",\r\n  showShareDialog: false,\r\n};\r\n\r\nconst appSlice = createSlice({\r\n  name: 'app',\r\n  initialState,\r\n  reducers: {\r\n    setView(state, action: PayloadAction<string>) {\r\n      state.view = action.payload;\r\n    },\r\n    setFilesState(state, action: PayloadAction<string>) {\r\n      state.filesState = action.payload;\r\n    },\r\n    setFiles(state, action: PayloadAction<string[]>) {\r\n      state.files = action.payload;\r\n    },\r\n    setShowSideBar(state, action: PayloadAction<boolean>) {\r\n      state.showSideBar = action.payload;\r\n    },\r\n    toggleShowSideBar(state) {\r\n      state.showSideBar = !state.showSideBar;\r\n    },\r\n    setStorageType(state, action: PayloadAction<string>) {\r\n      state.storageType = action.payload;\r\n    },\r\n    setShowShareDialog(state, action: PayloadAction<boolean>) {\r\n      state.showShareDialog = action.payload;\r\n    }\r\n  },\r\n});\r\n\r\nexport default appSlice.reducer;\r\n\r\nexport const {\r\n  setView,\r\n  setFilesState,\r\n  setFiles,\r\n  setShowSideBar,\r\n  toggleShowSideBar,\r\n  setStorageType,\r\n  setShowShareDialog,\r\n} = appSlice.actions;\r\n\r\n\r\nexport const getView = (state: RootState) => state.app.view;\r\nexport const getOutputFilesState = (state: RootState) => state.app.filesState;\r\nexport const getOutputFiles = (state: RootState) => state.app.files;\r\nexport const getShowSideBar = (state: RootState) => state.app.showSideBar;\r\nexport const getStorageType = (state: RootState) => state.app.storageType;\r\nexport const getShowShareDialog = (state: RootState) => state.app.showShareDialog;\r\n\r\n\r\nexport const fetchOutputFiles =\r\n  (taskId: number) =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n      try {\r\n        dispatch(setFilesState(\"loading\"))\r\n        dispatch(setFiles([]));\r\n        const sessionId = getSessionId();\r\n        const url = `/api/v1/output_files/${sessionId}/${taskId}/`;\r\n        const { data } = await axios.get(url);\r\n        dispatch(setFiles(data));\r\n        dispatch(setFilesState(\"loaded\"))\r\n      } catch (error) {\r\n        dispatch(setFilesState(\"error\"))\r\n        console.error(`Problem during loading output files. ${error}`);\r\n      }\r\n\r\n    };\r\n\r\nexport const fetchWorkerOutputFiles =\r\n  (workerId: number, notebookId: number) =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n      try {\r\n        dispatch(setFilesState(\"loading\"))\r\n        dispatch(setFiles([]));\r\n        const sessionId = getSessionId();\r\n        const url = `/api/v1/worker-output-files/${sessionId}/${workerId}/${notebookId}/`;\r\n        const { data } = await axios.get(url);\r\n        dispatch(setFiles(data));\r\n        dispatch(setFilesState(\"loaded\"))\r\n      } catch (error) {\r\n        dispatch(setFilesState(\"error\"))\r\n        console.error(`Problem during loading worker output files. ${error}`);\r\n      }\r\n\r\n    };\r\n\r\n\r\nexport const fetchStorageType =\r\n  () =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n      try {\r\n        const url = `/api/v1/storage-type`;\r\n        const { data } = await axios.get(url);\r\n        dispatch(setStorageType(data.storage_type));\r\n\r\n      } catch (error) {\r\n        console.error(`Get storage type error. ${error}`);\r\n      }\r\n\r\n    };\r\n\r\nexport const userFileUploaded =\r\n  (siteId: number, sessionId: string, filename: string) =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n      try {\r\n        const data = { site_id: siteId, session_id: sessionId, filename }\r\n        const url = `/api/v1/nb-file-uploaded`;\r\n        await axios.post(url, data);\r\n      } catch (error) {\r\n        console.error(`Problem with file upload. ${error}`);\r\n      }\r\n    };\r\n\r\n\r\nexport const deleteUserFileUploaded =\r\n  (siteId: number, sessionId: string, filename: string) =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n      try {\r\n        const data = { site_id: siteId, session_id: sessionId, filename }\r\n        const url = `/api/v1/nb-delete-file`;\r\n        await axios.post(url, data);\r\n      } catch (error) {\r\n        console.error(`Problem with file upload. ${error}`);\r\n      }\r\n    };","export interface ISelectWidget {\n  label: string | null;\n  value: string | null;\n  input: string;\n  choices: string[];\n  multi: boolean | undefined;\n  url_key: string;\n  disabled: boolean;\n  hidden: boolean;\n}\n\nexport interface ICheckboxWidget {\n  label: string | null;\n  value: boolean | null;\n  input: string;\n  url_key: string;\n  disabled: boolean;\n  hidden: boolean;\n}\n\nexport interface INumericWidget {\n  label: string | null;\n  value: number | null;\n  input: string;\n  min: number;\n  max: number;\n  step: number;\n  url_key: string;\n  disabled: boolean;\n  hidden: boolean;\n}\n\nexport interface ISliderWidget {\n  vertical: boolean | null;\n  label: string | null;\n  value: number | null;\n  input: string;\n  min: number | null;\n  max: number | null;\n  step: number | null;\n  url_key: string;\n  urlValue: number | null;\n  disabled: boolean;\n  hidden: boolean;\n}\n\nexport interface IRangeWidget {\n  vertical: boolean | null;\n  label: string | null;\n  value: [number, number] | null;\n  input: string;\n  min: number | null;\n  max: number | null;\n  step: number | null;\n  url_key: string;\n  disabled: boolean;\n  hidden: boolean;\n}\n\nexport interface IFileWidget {\n  label: string | null;\n  value: string | null;\n  input: string;\n  maxFileSize: string | null;\n  disabled: boolean;\n  hidden: boolean;\n}\n\nexport interface ITextWidget {\n  label: string | null;\n  value: string | undefined;\n  input: string;\n  rows: number | null;\n  url_key: string;\n  disabled: boolean;\n  hidden: boolean;\n  sanitize: boolean;\n}\n\nexport interface IOutputFilesWidget {\n  output: string;\n  input: null;\n  value: null;\n}\n\nexport interface IMarkdownWidget {\n  output: string;\n  input: null;  // we need to add input to be IWidget\n  value: string;\n}\n\nexport interface IButtonWidget {\n  label: string | null;\n  style: string;\n  input: string;\n  value: string | boolean | null;\n  disabled: boolean;\n  hidden: boolean;\n}\n\nexport interface IAPIResponseWidget {\n  output: string\n  input: null;\n  value: string;\n}\n\n\nexport type IWidget =\n  | ISelectWidget\n  | ICheckboxWidget\n  | INumericWidget\n  | ISliderWidget\n  | IRangeWidget\n  | IFileWidget\n  | ITextWidget\n  | IOutputFilesWidget\n  | IMarkdownWidget\n  | IButtonWidget\n  | IAPIResponseWidget;\n\nexport function isSelectWidget(widget: IWidget): widget is ISelectWidget {\n  return (widget as ISelectWidget).input === \"select\";\n}\n\nexport function isCheckboxWidget(widget: IWidget): widget is ICheckboxWidget {\n  return (widget as ICheckboxWidget).input === \"checkbox\";\n}\n\nexport function isNumericWidget(widget: IWidget): widget is INumericWidget {\n  return (widget as INumericWidget).input === \"numeric\";\n}\n\nexport function isSliderWidget(widget: IWidget): widget is ISliderWidget {\n  return (widget as ISliderWidget).input === \"slider\";\n}\n\nexport function isRangeWidget(widget: IWidget): widget is IRangeWidget {\n  return (widget as IRangeWidget).input === \"range\";\n}\n\nexport function isFileWidget(widget: IWidget): widget is IFileWidget {\n  return (widget as IFileWidget).input === \"file\";\n}\n\nexport function isTextWidget(widget: IWidget): widget is ITextWidget {\n  return (widget as ITextWidget).input === \"text\";\n}\n\nexport function isOutputFilesWidget(widget: IWidget): widget is IOutputFilesWidget {\n  return (widget as IOutputFilesWidget).output === \"dir\";\n}\n\nexport function isMarkdownWidget(widget: IWidget): widget is IMarkdownWidget {\n  return (widget as IMarkdownWidget).output === \"markdown\";\n}\n\nexport function isButtonWidget(widget: IWidget): widget is IButtonWidget {\n  return (widget as IButtonWidget).input === \"button\";\n}\n\nexport function isAPIResponseWidget(widget: IWidget): widget is IAPIResponseWidget {\n  return (widget as IAPIResponseWidget).output === \"apiresponse\";\n}\n","// code from https://stackoverflow.com/questions/36862334/get-viewport-window-height-in-reactjs\nimport { useState, useEffect } from \"react\";\n\nexport function getWindowDimensions() {\n  const { innerWidth: width, innerHeight: height } = window;\n  return {\n    width,\n    height,\n  };\n}\n\nexport default function useWindowDimensions() {\n  const [windowDimensions, setWindowDimensions] = useState(\n    getWindowDimensions()\n  );\n\n  useEffect(() => {\n    function handleResize() {\n      setWindowDimensions(getWindowDimensions());\n    }\n\n    window.addEventListener(\"resize\", handleResize);\n    return () => window.removeEventListener(\"resize\", handleResize);\n  }, []);\n\n  return windowDimensions;\n}\n","/* eslint-disable import/no-cycle */\r\nimport {\r\n  createSlice,\r\n  PayloadAction,\r\n  AnyAction,\r\n  Dispatch,\r\n} from \"@reduxjs/toolkit\";\r\nimport axios, { AxiosError } from \"axios\";\r\n\r\nimport { RootState } from \"../store\";\r\nimport { setToken, setUsername } from \"./authSlice\";\r\n\r\n\r\nexport const SITE_PUBLIC = \"PUBLIC\";\r\nexport const SITE_PRIVATE = \"PRIVATE\";\r\n\r\nexport interface Site {\r\n  id: number;\r\n  title: string;\r\n  slug: string;\r\n  share: string;\r\n  welcome: string;\r\n  active: boolean;\r\n  version: string;\r\n  created_at: Date;\r\n  updated_at: Date;\r\n  created_by: number;\r\n  info: string;\r\n}\r\n\r\nexport enum SiteStatus {\r\n  Unknown = \"Unknown\",\r\n  Loaded = \"Loaded\",\r\n  NotFound = \"Not found\",\r\n  AccessForbidden = \"Access forbidden\",\r\n  NetworkError = \"Network Error\",\r\n  PleaseRefresh = \"Please refresh\",\r\n  LostConnection = \"Lost connection\",\r\n  NotReady = \"Not Ready\",\r\n  NotebookNotFound = \"Notebook not found\",\r\n}\r\n\r\nconst initialState = {\r\n  site: {} as Site,\r\n  siteStatus: SiteStatus.Unknown,\r\n};\r\n\r\nconst sitesSlice = createSlice({\r\n  name: \"sites\",\r\n  initialState,\r\n  reducers: {\r\n    setSite(state, action: PayloadAction<Site>) {\r\n      state.site = action.payload;\r\n    },\r\n    setSiteStatus(state, action: PayloadAction<SiteStatus>) {\r\n      state.siteStatus = action.payload;\r\n    }\r\n  },\r\n});\r\n\r\nexport default sitesSlice.reducer;\r\n\r\nexport const { setSite, setSiteStatus } = sitesSlice.actions;\r\n\r\nexport const getSite = (state: RootState) => state.sites.site;\r\nexport const getSiteStatus = (state: RootState) => state.sites.siteStatus;\r\nexport const getSiteId = (state: RootState) => state.sites.site.id;\r\nexport const getSiteWelcome = (state: RootState) => state.sites.site.welcome;\r\nexport const isPublic = (state: RootState) => {\r\n  return state.sites.site.share === SITE_PUBLIC;\r\n};\r\n\r\nexport const getLogoFilename = (state: RootState) => {\r\n  if (state.sites.site.info === undefined || state.sites.site.info === \"\") {\r\n    return \"\";\r\n  }\r\n  const info = JSON.parse(state.sites.site.info);\r\n  if(info?.logoFilename === undefined) {\r\n    return \"\";\r\n  }\r\n  return info?.logoFilename\r\n};\r\nexport const getNavbarColor = (state: RootState) => {\r\n  if (state.sites.site.info === undefined || state.sites.site.info === \"\") {\r\n    return \"\";\r\n  }\r\n  const info = JSON.parse(state.sites.site.info);\r\n  if(info?.navbarColor === undefined) {\r\n    return \"\";\r\n  }\r\n  return info?.navbarColor;\r\n};\r\nexport const getFooterText = (state: RootState) => {\r\n  if (state.sites.site.info === undefined || state.sites.site.info === \"\") {\r\n    return \"\";\r\n  }\r\n  const info = JSON.parse(state.sites.site.info);\r\n  if(info?.footerText === undefined) {\r\n    return \"\";\r\n  }\r\n  return info?.footerText;\r\n};\r\n\r\n\r\nexport const fetchSite = () => async (dispatch: Dispatch<AnyAction>) => {\r\n  try {\r\n    dispatch(setSite({} as Site));\r\n    dispatch(setSiteStatus(SiteStatus.Unknown));\r\n\r\n    let siteSlug = \"single-site\";\r\n    if (process.env.REACT_APP_SERVER_URL) {\r\n      siteSlug = window.location.host.split(':')[0]\r\n    }\r\n    if (window.location.origin.endsWith(\"hf.space\")) {\r\n      siteSlug = \"localhost\";\r\n    }\r\n\r\n    const url = `/api/v1/get-site/${siteSlug}/`;\r\n    const { data } = await axios.get(url);\r\n\r\n    dispatch(setSite(data as Site));\r\n    if (data?.status !== \"Ready\") {\r\n      dispatch(setSiteStatus(SiteStatus.NotReady));\r\n    } else {\r\n      dispatch(setSiteStatus(SiteStatus.Loaded));\r\n    }\r\n  } catch (error) {\r\n    const err = error as AxiosError;\r\n    console.log(err.message)\r\n    if (err?.message === \"Network Error\") {\r\n      dispatch(setSiteStatus(SiteStatus.NetworkError));\r\n    } else if (err.response!.status === 403) {\r\n      dispatch(setSiteStatus(SiteStatus.AccessForbidden));\r\n    } else if (err.response!.status === 404) {\r\n      dispatch(setSiteStatus(SiteStatus.NotFound));\r\n    } else if (err.response!.status === 401) {\r\n      // invalid token, clear token ...\r\n      dispatch(setToken(\"\"));\r\n      dispatch(setUsername(\"\"));\r\n      dispatch(setSiteStatus(SiteStatus.PleaseRefresh));\r\n    } else {\r\n      console.error(`Problem during loading site information. ${error}`);\r\n    }\r\n  }\r\n};\r\n","/* eslint-disable import/no-cycle */\r\nimport {\r\n  createSlice,\r\n  PayloadAction,\r\n  AnyAction,\r\n  Dispatch,\r\n} from \"@reduxjs/toolkit\";\r\nimport axios, { AxiosError } from \"axios\";\r\n\r\nimport { RootState } from \"../store\";\r\nimport { clearExecutionHistory } from \"./tasksSlice\";\r\nimport { setShowSideBar } from \"./appSlice\";\r\nimport {\r\n  IWidget,\r\n  isSelectWidget,\r\n  isSliderWidget,\r\n  isTextWidget,\r\n  isRangeWidget,\r\n  isCheckboxWidget,\r\n  isNumericWidget,\r\n  isMarkdownWidget,\r\n  isButtonWidget,\r\n  isFileWidget,\r\n} from \"../widgets/Types\";\r\nimport { getWindowDimensions } from \"../components/WindowDimensions\";\r\nimport { setSiteStatus, SiteStatus } from \"./sitesSlice\";\r\n\r\nexport const RUN_DELAY = 600; // ms\r\nexport const RUN_DELAY_FAST = 100; // ms\r\n\r\nexport interface INotebookParams {\r\n  title: string | null;\r\n  description: string | null;\r\n  date: string | null;\r\n  author: string | null;\r\n  \"show-code\": boolean | null;\r\n  params: Record<string, IWidget>; //IWidget[];\r\n  version: string;\r\n  continuous_update: boolean;\r\n  static_notebook: boolean;\r\n  show_sidebar: boolean;\r\n  full_screen: boolean;\r\n  allow_download: boolean;\r\n  allow_share: boolean;\r\n}\r\n\r\nexport interface INotebook {\r\n  id: number;\r\n  created_at: Date;\r\n  file_updated_at: Date;\r\n  title: string;\r\n  slug: string;\r\n  path: string;\r\n  share: string;\r\n  params: INotebookParams;\r\n  state: string;\r\n  default_view_path: string;\r\n  output: string;\r\n  format: string;\r\n  slidesHash: string;\r\n  schedule: string;\r\n  errors: string;\r\n}\r\n\r\nexport type WidgetValueType =\r\n  | string\r\n  | boolean\r\n  | number\r\n  | [number, number]\r\n  | string[]\r\n  | null\r\n  | undefined\r\n  | unknown;\r\n\r\nconst initialState = {\r\n  notebooks: [] as INotebook[],\r\n  loadingState: \"loading\",\r\n  selectedNotebook: {} as INotebook,\r\n  selectedNotebookId: undefined as undefined | number,\r\n  loadingStateSelected: \"loading\",\r\n  watchModeCounter: 0,\r\n  slidesHash: \"\",\r\n  widgets: {} as Record<string, WidgetValueType>,\r\n  widgetsUrlValues: {} as Record<string, WidgetValueType>,\r\n  nbIframes: {} as Record<string, string>, // slug -> signed URL\r\n  widgetsInitialized: false,\r\n  urlValuesUsed: false,\r\n};\r\n\r\nconst notebooksSlice = createSlice({\r\n  name: \"notebooks\",\r\n  initialState,\r\n  reducers: {\r\n    setWidgetValue(\r\n      state,\r\n      action: PayloadAction<{ key: string; value: WidgetValueType }>\r\n    ) {\r\n      const { key, value } = action.payload;\r\n      state.widgets[key] = value;\r\n      //console.log({ key, value });\r\n    },\r\n    setWidgetUrlValue(\r\n      state,\r\n      action: PayloadAction<{ key: string; value: WidgetValueType }>\r\n    ) {\r\n      const { key, value } = action.payload;\r\n      state.widgetsUrlValues[key] = value;\r\n    },\r\n    clearWidgets(state) {\r\n      state.widgets = {};\r\n    },\r\n    clearWidgetsUrlValues(state) {\r\n      state.widgetsUrlValues = {};\r\n    },\r\n    setNotebooks(state, action: PayloadAction<INotebook[]>) {\r\n      state.notebooks = action.payload;\r\n    },\r\n    setLoadingState(state, action: PayloadAction<string>) {\r\n      state.loadingState = action.payload;\r\n    },\r\n    setSelectedNotebook(state, action: PayloadAction<INotebook>) {\r\n      if (\r\n        action.payload.state.startsWith(\"WATCH\") &&\r\n        state.selectedNotebook.file_updated_at ===\r\n        action.payload.file_updated_at\r\n      ) {\r\n        // console.log(\"skip notebook update\")\r\n      } else {\r\n        state.selectedNotebook = action.payload;\r\n        state.selectedNotebookId = state.selectedNotebook.id;\r\n      }\r\n      if (action.payload.state.startsWith(\"WATCH\")) {\r\n        state.watchModeCounter += 1;\r\n      }\r\n    },\r\n    setLoadingStateSelected(state, action: PayloadAction<string>) {\r\n      state.loadingStateSelected = action.payload;\r\n    },\r\n    setSlidesHash(state, action: PayloadAction<string>) {\r\n      state.slidesHash = action.payload;\r\n    },\r\n    updateWidgetsParams(state, action: PayloadAction<any>) {\r\n      const { widgetKey } = action.payload;\r\n\r\n      let updated = false;\r\n\r\n      let noMatch = true;\r\n\r\n      for (let key of Object.keys(state.selectedNotebook.params.params)) {\r\n        if (key === widgetKey) {\r\n          noMatch = false;\r\n          let widget = { ...state.selectedNotebook.params.params[widgetKey] };\r\n\r\n          if (isRangeWidget(widget)) {\r\n            if (widget.disabled !== action.payload.disabled) {\r\n              widget.disabled = action.payload.disabled;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.hidden !== action.payload.hidden) {\r\n              widget.hidden = action.payload.hidden;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.min !== action.payload.min) {\r\n              widget.min = action.payload.min;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.max !== action.payload.max) {\r\n              widget.max = action.payload.max;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.step !== action.payload.step) {\r\n              widget.step = action.payload.step;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.label !== action.payload.label) {\r\n              widget.label = action.payload.label;\r\n              updated = true;\r\n            }\r\n          } else if (isTextWidget(widget)) {\r\n            if (widget.disabled !== action.payload.disabled) {\r\n              widget.disabled = action.payload.disabled;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.hidden !== action.payload.hidden) {\r\n              widget.hidden = action.payload.hidden;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.rows !== action.payload.rows) {\r\n              widget.rows = action.payload.rows;\r\n              updated = true;\r\n            }\r\n            if (widget.label !== action.payload.label) {\r\n              widget.label = action.payload.label;\r\n              updated = true;\r\n            }\r\n          } else if (isSliderWidget(widget)) {\r\n            if (widget.disabled !== action.payload.disabled) {\r\n              widget.disabled = action.payload.disabled;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.hidden !== action.payload.hidden) {\r\n              widget.hidden = action.payload.hidden;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.min !== action.payload.min) {\r\n              widget.min = action.payload.min;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.max !== action.payload.max) {\r\n              widget.max = action.payload.max;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.step !== action.payload.step) {\r\n              widget.step = action.payload.step;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.label !== action.payload.label) {\r\n              widget.label = action.payload.label;\r\n              updated = true;\r\n            }\r\n          } else if (isSelectWidget(widget)) {\r\n            if (widget.disabled !== action.payload.disabled) {\r\n              widget.disabled = action.payload.disabled;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.hidden !== action.payload.hidden) {\r\n              widget.hidden = action.payload.hidden;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (\r\n              widget.choices.toString() !== action.payload.choices.toString()\r\n            ) {\r\n              widget.choices = action.payload.choices;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.label !== action.payload.label) {\r\n              widget.label = action.payload.label;\r\n              updated = true;\r\n            }\r\n          } else if (isCheckboxWidget(widget)) {\r\n            if (widget.disabled !== action.payload.disabled) {\r\n              widget.disabled = action.payload.disabled;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.hidden !== action.payload.hidden) {\r\n              widget.hidden = action.payload.hidden;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.label !== action.payload.label) {\r\n              widget.label = action.payload.label;\r\n              updated = true;\r\n            }\r\n          } else if (isNumericWidget(widget)) {\r\n            if (widget.disabled !== action.payload.disabled) {\r\n              widget.disabled = action.payload.disabled;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.hidden !== action.payload.hidden) {\r\n              widget.hidden = action.payload.hidden;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.min !== action.payload.min) {\r\n              widget.min = action.payload.min;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.max !== action.payload.max) {\r\n              widget.max = action.payload.max;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.step !== action.payload.step) {\r\n              widget.step = action.payload.step;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.label !== action.payload.label) {\r\n              widget.label = action.payload.label;\r\n              updated = true;\r\n            }\r\n          } else if (isMarkdownWidget(widget)) {\r\n            if (widget.value !== action.payload.value) {\r\n              widget.value = action.payload.value;\r\n              updated = true;\r\n            }\r\n          } else if (isButtonWidget(widget)) {\r\n            state.widgets[key] = action.payload.value;\r\n            if (widget.disabled !== action.payload.disabled) {\r\n              widget.disabled = action.payload.disabled;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.hidden !== action.payload.hidden) {\r\n              widget.hidden = action.payload.hidden;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.label !== action.payload.label) {\r\n              widget.label = action.payload.label;\r\n              updated = true;\r\n            }\r\n            if (widget.style !== action.payload.style) {\r\n              widget.style = action.payload.style;\r\n              updated = true;\r\n            }\r\n          } else if (isFileWidget(widget)) {\r\n            state.widgets[key] = action.payload.value;\r\n            if (widget.disabled !== action.payload.disabled) {\r\n              widget.disabled = action.payload.disabled;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.hidden !== action.payload.hidden) {\r\n              widget.hidden = action.payload.hidden;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.label !== action.payload.label) {\r\n              widget.label = action.payload.label;\r\n              updated = true;\r\n            }\r\n          }\r\n\r\n          if (updated) {\r\n            state.selectedNotebook.params.params[widgetKey] = widget;\r\n          }\r\n        }\r\n      }\r\n      if (noMatch) {\r\n        state.selectedNotebook.params.params[widgetKey] = action.payload;\r\n      }\r\n    },\r\n    hideWidgets(state, action: PayloadAction<any>) {\r\n      const { keys } = action.payload;\r\n      for (let key of keys) {\r\n        if (key in state.selectedNotebook.params.params) {\r\n          delete state.selectedNotebook.params.params[key];\r\n        }\r\n      }\r\n    },\r\n    initWidgets(state, action: PayloadAction<any>) {\r\n      const { widgets } = action.payload;\r\n      state.selectedNotebook.params.params = {}\r\n      state.widgets = {}\r\n      for (let widget of widgets) {\r\n        state.selectedNotebook.params.params[widget.widgetKey] = widget;\r\n        state.widgets[widget.widgetKey] = widget.value;\r\n      }\r\n    },\r\n    updateTitle(state, action: PayloadAction<string>) {\r\n      state.selectedNotebook.title = action.payload;\r\n    },\r\n    updateShowCode(state, action: PayloadAction<boolean>) {\r\n      state.selectedNotebook.params[\"show-code\"] = action.payload;\r\n    },\r\n    setNbIframes(state, action: PayloadAction<Record<string, string>>) {\r\n      state.nbIframes = action.payload;\r\n    },\r\n    setWidgetsInitialized(state, action: PayloadAction<boolean>) {\r\n      state.widgetsInitialized = action.payload;\r\n    },\r\n    setUrlValuesUsed(state, action: PayloadAction<boolean>) {\r\n      state.urlValuesUsed = action.payload;\r\n    }\r\n  },\r\n});\r\n\r\nexport default notebooksSlice.reducer;\r\n\r\nexport const {\r\n  setNotebooks,\r\n  setLoadingState,\r\n  setSelectedNotebook,\r\n  setLoadingStateSelected,\r\n  setSlidesHash,\r\n  updateWidgetsParams,\r\n  hideWidgets,\r\n  setWidgetValue,\r\n  setWidgetUrlValue,\r\n  clearWidgets,\r\n  clearWidgetsUrlValues,\r\n  initWidgets,\r\n  updateTitle,\r\n  updateShowCode,\r\n  setNbIframes,\r\n  setWidgetsInitialized,\r\n  setUrlValuesUsed\r\n} = notebooksSlice.actions;\r\n\r\nexport const getNotebooks = (state: RootState) => state.notebooks.notebooks;\r\nexport const getLoadingState = (state: RootState) =>\r\n  state.notebooks.loadingState;\r\nexport const getSelectedNotebook = (state: RootState) =>\r\n  state.notebooks.selectedNotebook;\r\nexport const getSelectedNotebookId = (state: RootState) =>\r\n  state.notebooks.selectedNotebookId;\r\nexport const isStaticNotebook = (state: RootState) => {\r\n  let st = state.notebooks.selectedNotebook?.params?.static_notebook;\r\n  if (st === undefined) {\r\n    return false;\r\n  }\r\n  return st;\r\n};\r\nexport const getLoadingStateSelected = (state: RootState) =>\r\n  state.notebooks.loadingStateSelected;\r\nexport const getWatchModeCounter = (state: RootState) =>\r\n  state.notebooks.watchModeCounter;\r\nexport const getSlidesHash = (state: RootState) => state.notebooks.slidesHash;\r\n\r\nexport const getWidgetsValues = (state: RootState): Record<string, WidgetValueType> => state.notebooks.widgets;\r\nexport const getWidgetsUrlValues = (state: RootState): Record<string, WidgetValueType> => state.notebooks.widgetsUrlValues;\r\n\r\n\r\nexport const getNbIframes = (state: RootState) => state.notebooks.nbIframes;\r\nexport const getWidgetsInitialized = (state: RootState) => state.notebooks.widgetsInitialized;\r\nexport const getUrlValuesUsed = (state: RootState) => state.notebooks.urlValuesUsed;\r\n\r\nexport const fetchNbIframes = (siteId: number) => async (dispatch: Dispatch<AnyAction>) => {\r\n  try {\r\n    const url = `/api/v1/${siteId}/nb-iframes/`;\r\n    const { data } = await axios.get(url);\r\n    dispatch(setNbIframes(data));\r\n  } catch (error) {\r\n    console.error(`Problem during loading notebooks iframes. ${error}`);\r\n  }\r\n};\r\n\r\n\r\nexport const fetchNotebooks = (siteId: number) => async (dispatch: Dispatch<AnyAction>) => {\r\n  try {\r\n    dispatch(setSlidesHash(\"\"));\r\n    dispatch(setLoadingState(\"loading\"));\r\n    dispatch(clearExecutionHistory());\r\n    const url = `/api/v1/${siteId}/notebooks/`;\r\n    const { data } = await axios.get(url);\r\n    const parsedNotebooks = data.map((notebook: any) => {\r\n      const parsedParams = JSON.parse(notebook.params);\r\n\r\n      return {\r\n        ...notebook,\r\n        params: parsedParams as INotebookParams,\r\n      };\r\n    });\r\n    dispatch(setNotebooks(parsedNotebooks));\r\n    dispatch(setLoadingState(\"loaded\"));\r\n  } catch (error) {\r\n    dispatch(setLoadingState(\"error\"));\r\n    console.error(`Problem during loading recent notebooks. ${error}`);\r\n  }\r\n};\r\n\r\nexport const fetchNotebook =\r\n  (siteId: number, id: number, silent = false) =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n      try {\r\n        if (!silent) {\r\n          dispatch(setSlidesHash(\"\"));\r\n          dispatch(clearExecutionHistory());\r\n        }\r\n\r\n        const { width } = getWindowDimensions();\r\n        dispatch(setShowSideBar(width > 992));\r\n\r\n        if (!silent) {\r\n          dispatch(setLoadingStateSelected(\"loading\"));\r\n        }\r\n        const url = `/api/v1/${siteId}/notebooks/${id}/`;\r\n        const { data } = await axios.get(url);\r\n        const parsedParams = JSON.parse(data.params) as INotebookParams;\r\n        dispatch(\r\n          setSelectedNotebook({\r\n            ...data,\r\n            params: parsedParams,\r\n          })\r\n        );\r\n        if (!silent) {\r\n          dispatch(setLoadingStateSelected(\"loaded\"));\r\n        }\r\n        if (parsedParams?.show_sidebar !== null && parsedParams?.show_sidebar !== undefined) {\r\n          dispatch(setShowSideBar(parsedParams?.show_sidebar));\r\n        }\r\n      } catch (error) {\r\n        if (!silent) {\r\n          dispatch(setLoadingStateSelected(\"error\"));\r\n        }\r\n        console.error(\r\n          `Problem during loading selected notebook (${id}). ${error}`\r\n        );\r\n      }\r\n    };\r\n\r\nexport const fetchNotebookWithSlug =\r\n  (siteId: number, slug: string, silent = false) =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n      try {\r\n        if (!silent) {\r\n          dispatch(setSlidesHash(\"\"));\r\n          dispatch(clearExecutionHistory());\r\n        }\r\n\r\n        const { width } = getWindowDimensions();\r\n        dispatch(setShowSideBar(width > 992));\r\n\r\n        if (!silent) {\r\n          dispatch(setLoadingStateSelected(\"loading\"));\r\n        }\r\n        const url = `/api/v1/${siteId}/getnb/${slug}/`;\r\n        const { data } = await axios.get(url);\r\n        const parsedParams = JSON.parse(data.params) as INotebookParams;\r\n        dispatch(\r\n          setSelectedNotebook({\r\n            ...data,\r\n            params: parsedParams,\r\n          })\r\n        );\r\n        if (!silent) {\r\n          dispatch(setLoadingStateSelected(\"loaded\"));\r\n        }\r\n        if (parsedParams?.show_sidebar !== null && parsedParams?.show_sidebar !== undefined) {\r\n          dispatch(setShowSideBar(parsedParams?.show_sidebar));\r\n        }\r\n      } catch (error) {\r\n        const err = error as AxiosError;\r\n\r\n        if (!silent) {\r\n          dispatch(setLoadingStateSelected(\"error\"));\r\n\r\n          if (err.response?.status === 404) {\r\n            // switch to notebook not found view\r\n            dispatch(setSiteStatus(SiteStatus.NotebookNotFound))\r\n          }\r\n        }\r\n        console.error(\r\n          `Problem during loading selected notebook (${slug}). ${error}`\r\n        );\r\n\r\n\r\n      }\r\n    };\r\n","/* eslint-disable import/no-cycle */\r\nimport {\r\n    createSlice,\r\n    AnyAction,\r\n    Dispatch,\r\n    PayloadAction,\r\n} from '@reduxjs/toolkit';\r\nimport axios from 'axios';\r\nimport { RootState } from '../store';\r\nimport { toast } from \"react-toastify\";\r\nimport { getSessionId, handleDownload } from '../utils';\r\nimport { setSlidesHash } from './notebooksSlice';\r\n\r\nexport interface ITask {\r\n    id: number;\r\n    task_id: string;\r\n    session_id: string;\r\n    created_at: Date;\r\n    state: \"CREATED\" | \"RECEIVED\" | \"DONE\" | \"ERROR\";\r\n    params: string;\r\n    result: string;\r\n}\r\n\r\nconst initialState = {\r\n    currentTask: {} as ITask,\r\n    historicTask: {} as ITask,\r\n    showCurrent: true,\r\n    previousTask: {} as ITask,\r\n    exportingToPDF: false,\r\n    exportToPDFJobId: '',\r\n    exportToPDFCounter: 0,\r\n    executionHistory: [] as ITask[],\r\n};\r\n\r\nconst tasksSlice = createSlice({\r\n    name: 'tasks',\r\n    initialState,\r\n    reducers: {\r\n        setShowCurrent(state, action: PayloadAction<boolean>) {\r\n            state.showCurrent = action.payload;\r\n        },\r\n        setCurrentTask(state, action: PayloadAction<ITask>) {\r\n            state.currentTask = action.payload;\r\n        },\r\n        setHistoricTask(state, action: PayloadAction<ITask>) {\r\n            state.historicTask = action.payload;\r\n        },\r\n        setPreviousTask(state, action: PayloadAction<ITask>) {\r\n            state.previousTask = action.payload;\r\n        },\r\n        copyCurrentToPreviousTask(state) {\r\n            state.previousTask = state.currentTask;\r\n        },\r\n        setExportingToPDF(state, action: PayloadAction<boolean>) {\r\n            state.exportingToPDF = action.payload;\r\n        },\r\n        setExportToPDFJobId(state, action: PayloadAction<string>) {\r\n            state.exportToPDFJobId = action.payload;\r\n        },\r\n        resetExportToPDFCounter(state) {\r\n            state.exportToPDFCounter = 0;\r\n        },\r\n        increaseExportToPDFCounter(state) {\r\n            state.exportToPDFCounter += 1;\r\n        },\r\n        stopPDFExport(state) {\r\n            state.exportingToPDF = false;\r\n            state.exportToPDFJobId = \"\";\r\n            state.exportToPDFCounter = 0;\r\n        },\r\n        setExecutionHistory(state, action: PayloadAction<ITask[]>) {\r\n            state.executionHistory = action.payload;\r\n        },\r\n        clearExecutionHistory(state) {\r\n            state.executionHistory = [];\r\n        }\r\n    },\r\n});\r\n\r\nexport default tasksSlice.reducer;\r\n\r\nexport const {\r\n    setShowCurrent,\r\n    setCurrentTask,\r\n    setHistoricTask,\r\n    setPreviousTask,\r\n    copyCurrentToPreviousTask,\r\n    setExportingToPDF,\r\n    setExportToPDFJobId,\r\n    resetExportToPDFCounter,\r\n    increaseExportToPDFCounter,\r\n    stopPDFExport,\r\n    setExecutionHistory,\r\n    clearExecutionHistory\r\n} = tasksSlice.actions;\r\n\r\nexport const getShowCurrent = (state: RootState) => state.tasks.showCurrent;\r\nexport const getCurrentTask = (state: RootState) => state.tasks.currentTask;\r\nexport const getHistoricTask = (state: RootState) => state.tasks.historicTask;\r\nexport const getPreviousTask = (state: RootState) => state.tasks.previousTask;\r\nexport const getExportingToPDF = (state: RootState) => state.tasks.exportingToPDF;\r\nexport const getExportToPDFJobId = (state: RootState) => state.tasks.exportToPDFJobId;\r\nexport const getExportToPDFCounter = (state: RootState) => state.tasks.exportToPDFCounter;\r\nexport const getExecutionHistory = (state: RootState) => state.tasks.executionHistory;\r\n\r\nexport const fetchCurrentTask =\r\n    (notebookId: number) =>\r\n        async (dispatch: Dispatch<AnyAction>) => {\r\n\r\n            const sessionId = getSessionId();\r\n\r\n            try {\r\n                const url = `/api/v1/latest_task/${notebookId}/${sessionId}/`;\r\n                const { data } = await axios.get(url);\r\n                dispatch(setCurrentTask(data))\r\n\r\n            } catch (error) {\r\n                // console.clear();\r\n                dispatch(setCurrentTask({} as ITask));\r\n            }\r\n\r\n        };\r\n\r\nexport const scrapeSlidesHash = () => {\r\n    try {\r\n        const iframeElement = (document.getElementById(\"main-iframe\") as HTMLIFrameElement);\r\n        const hash = iframeElement?.contentWindow?.location?.hash;\r\n        if (hash) {\r\n            return hash;\r\n        }\r\n    } catch (error) { }\r\n    return \"\";\r\n}\r\n\r\n\r\nexport const executeNotebook =\r\n    (notebookId: number) =>\r\n        async (dispatch: Dispatch<AnyAction>, getState: () => any) => {\r\n            const { widgets } = getState().widgets;\r\n            const sessionId = getSessionId();\r\n\r\n            const slidesHash = scrapeSlidesHash();\r\n            dispatch(setSlidesHash(slidesHash));\r\n\r\n            try {\r\n                const task = {\r\n                    session_id: sessionId,\r\n                    params: JSON.stringify(widgets),\r\n                }\r\n                const url = `/api/v1/execute/${notebookId}/`;\r\n                const { data } = await axios.post(url, task);\r\n                dispatch(setCurrentTask(data))\r\n\r\n            } catch (error) {\r\n                console.error(`Problem during notebook execution. ${error}`);\r\n            }\r\n\r\n        };\r\n\r\n\r\nexport const clearTasks =\r\n    (notebookId: number) =>\r\n        async (dispatch: Dispatch<AnyAction>) => {\r\n            try {\r\n                const sessionId = getSessionId();\r\n                const url = `/api/v1/clear_tasks/${notebookId}/${sessionId}/`;\r\n                await axios.post(url);\r\n                dispatch(setCurrentTask({} as ITask));\r\n                dispatch(setHistoricTask({} as ITask));\r\n                dispatch(setPreviousTask({} as ITask));\r\n                dispatch(setExecutionHistory([]));\r\n                toast.success(\"All previous tasks deleted. The default view of the app is displayed.\")\r\n            } catch (error) {\r\n                toast.error(`Trying to clear previous tasks. The error occured. ${error}`)\r\n            }\r\n        };\r\n\r\n\r\nexport const exportToPDF =\r\n    (siteId: number, notebookId: number, notebookPath: string) =>\r\n        async (dispatch: Dispatch<AnyAction>) => {\r\n            try {\r\n                dispatch(setExportingToPDF(true));\r\n                dispatch(resetExportToPDFCounter());\r\n                dispatch(setExportToPDFJobId(\"\"));\r\n\r\n                const sessionId = getSessionId();\r\n                const url = `/api/v1/export_pdf/`;\r\n                // convert from JS camel case to Python undescore variables\r\n                const params = {\r\n                    site_id: siteId,\r\n                    session_id: sessionId,\r\n                    notebook_id: notebookId,\r\n                    notebook_path: notebookPath,\r\n                }\r\n                const { data } = await axios.post(url, params);\r\n                dispatch(setExportToPDFJobId(data.job_id))\r\n            } catch (error) {\r\n                toast.error(`The error occured during PDF export. ${error}`);\r\n                dispatch(stopPDFExport());\r\n            }\r\n        };\r\n\r\nexport const getPDF =\r\n    (jobId: string) =>\r\n        async (dispatch: Dispatch<AnyAction>) => {\r\n            try {\r\n                const url = `/api/v1/get_pdf/${jobId}/`;\r\n                const { data } = await axios.get(url);\r\n                if (data.ready) {\r\n                    dispatch(stopPDFExport());\r\n                    if (data.error !== \"\") {\r\n                        toast.error(data.error);\r\n                    } else {\r\n                        handleDownload(\r\n                            `${axios.defaults.baseURL}${data.url}`,\r\n                            `${data.title}`\r\n                        )\r\n                    }\r\n                } else {\r\n                    dispatch(increaseExportToPDFCounter());\r\n                }\r\n            } catch (error) {\r\n                toast.error(`The error occured during PDF export. ${error}`);\r\n                dispatch(stopPDFExport());\r\n            }\r\n        };\r\n\r\n\r\n\r\nexport const fetchExecutionHistory =\r\n    (notebookId: number, clearPreviousHistory = true) =>\r\n        async (dispatch: Dispatch<AnyAction>) => {\r\n\r\n            dispatch(setHistoricTask({} as ITask));\r\n            if (clearPreviousHistory) {\r\n                dispatch(clearExecutionHistory());\r\n            }\r\n\r\n            const sessionId = getSessionId();\r\n\r\n            try {\r\n                const url = `/api/v1/execution_history/${notebookId}/${sessionId}/`;\r\n                const { data } = await axios.get(url);\r\n                dispatch(setExecutionHistory(data))\r\n            } catch (error) {\r\n                dispatch(clearExecutionHistory());\r\n            }\r\n\r\n        };\r\n\r\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { useSearchParams } from \"react-router-dom\";\n\nimport {\n  setUrlValuesUsed,\n  setWidgetUrlValue,\n  setWidgetValue,\n} from \"../slices/notebooksSlice\";\n\ntype CheckboxProps = {\n  widgetKey: string;\n  label: string | null;\n  value: boolean | null;\n  disabled: boolean;\n  hidden: boolean;\n  runNb: () => void;\n  url_key: string;\n};\n\nexport default function CheckboxWidget({\n  widgetKey,\n  label,\n  value,\n  disabled,\n  hidden,\n  runNb,\n  url_key,\n}: CheckboxProps) {\n  const dispatch = useDispatch();\n  const [updated, userInteraction] = useState(false);\n\n  const [searchParams] = useSearchParams();\n\n  useEffect(() => {\n    if (url_key !== undefined && url_key !== \"\") {\n      const urlValue = searchParams.get(url_key)?.toLowerCase();\n\n      if (\n        !updated &&\n        urlValue !== undefined &&\n        (urlValue === \"true\" || urlValue === \"false\")\n      ) {\n        dispatch(\n          setWidgetUrlValue({\n            key: widgetKey,\n            value: urlValue === \"true\",\n          })\n        );\n        dispatch(setUrlValuesUsed(true));\n      }\n    }\n  }, [dispatch, searchParams, updated, url_key, widgetKey]);\n\n  useEffect(() => {\n    if (updated) {\n      runNb();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [value]);\n\n  return (\n    <div className=\"form-group form-check form-switch mb-3\"  style={{ display: hidden ? \"none\" : \"\" }}>\n      <input\n        className=\"form-check-input\"\n        type=\"checkbox\"\n        id={`checkbox-${label}`}\n        disabled={disabled}\n        onChange={() => {\n          userInteraction(true);\n          dispatch(setWidgetValue({ key: widgetKey, value: !value }));\n        }}\n        checked={value != null ? value : false}\n      />\n      <label\n        className=\"form-check-label\"\n        htmlFor={`checkbox-${label}`}\n        style={{ color: disabled ? \"#555\" : \"#212529\" }}\n      >\n        {label}\n      </label>\n    </div>\n  );\n}\n","import React, { useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { useSearchParams } from \"react-router-dom\";\nimport {\n  setUrlValuesUsed,\n  setWidgetUrlValue,\n  setWidgetValue,\n} from \"../slices/notebooksSlice\";\n\ntype NumericProps = {\n  widgetKey: string;\n  label: string | null;\n  value: number | null;\n  min: number | null;\n  max: number | null;\n  step: number | null;\n  disabled: boolean;\n  hidden: boolean;\n  runNb: () => void;\n  continuousUpdate: boolean;\n  url_key: string;\n};\n\nexport default function NumericWidget({\n  widgetKey,\n  label,\n  value,\n  min,\n  max,\n  step,\n  disabled,\n  hidden,\n  runNb,\n  continuousUpdate,\n  url_key,\n}: NumericProps) {\n  const dispatch = useDispatch();\n  const [apply, showApply] = useState(false);\n  const [updated, userInteraction] = useState(false);\n\n  let minValue = 0;\n  let maxValue = 10;\n  let stepValue = 1;\n  if (min !== null) {\n    minValue = min;\n  }\n  if (max !== null) {\n    maxValue = max;\n  }\n  if (step !== null) {\n    stepValue = step;\n  }\n  let displayValue = value !== null && value !== undefined ? value : 0;\n\n  const [searchParams] = useSearchParams();\n  useEffect(() => {\n    if (url_key !== undefined && url_key !== \"\") {\n      const urlValue = searchParams.get(url_key);\n      if (\n        !updated &&\n        urlValue !== undefined &&\n        urlValue !== null &&\n        !isNaN(parseFloat(urlValue)) &&\n        parseFloat(urlValue) >= minValue &&\n        parseFloat(urlValue) <= maxValue\n      ) {\n        dispatch(\n          setWidgetUrlValue({\n            key: widgetKey,\n            value: parseFloat(urlValue),\n          })\n        );\n        dispatch(setUrlValuesUsed(true));\n      }\n    }\n  }, [dispatch, maxValue, minValue, searchParams, updated, url_key, widgetKey]);\n\n  const validateValue = () => {\n    if (min !== null && value !== null && value < min) {\n      dispatch(setWidgetValue({ key: widgetKey, value: min }));\n    }\n    if (max !== null && value !== null && value > max) {\n      dispatch(setWidgetValue({ key: widgetKey, value: max }));\n    }\n  };\n\n  return (\n    <div className=\"form-group mb-3\" style={{ display: hidden ? \"none\" : \"\" }}>\n      <label\n        htmlFor={`checkbox-${label}`}\n        style={{ color: disabled ? \"#555\" : \"#212529\" }}\n      >\n        {label}\n      </label>\n      <input\n        className=\"form-control\"\n        type=\"number\"\n        value={displayValue} // {displayValue as number | string}\n        onChange={(e) => {\n          userInteraction(true);\n          showApply(true);\n          dispatch(setWidgetValue({ key: widgetKey, value: e.target.value }));\n        }}\n        onBlur={(e) => {\n          validateValue();\n        }}\n        onKeyPress={(e) => {\n          if (e.key === \"Enter\") {\n            validateValue();\n            runNb();\n            showApply(false);\n            e.preventDefault();\n          }\n        }}\n        min={minValue}\n        max={maxValue}\n        step={stepValue}\n        disabled={disabled}\n      />\n      {apply && continuousUpdate && (\n        <div\n          style={{\n            float: \"right\",\n            position: \"relative\",\n            top: \"0px\",\n            left: \"0px\",\n          }}\n        >\n          <button\n            className=\"btn btn-sm btn-outline-primary\"\n            onClick={(e) => {\n              validateValue();\n              runNb();\n              showApply(false);\n              e.preventDefault();\n            }}\n            style={{\n              fontSize: \"0.7em\",\n              border: \"none\",\n            }}\n          >\n            Press enter or click to apply\n          </button>\n        </div>\n      )}\n    </div>\n  );\n}\n","import React, { useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport {\n  clearWidgetsUrlValues,\n  setUrlValuesUsed,\n  setWidgetUrlValue,\n  setWidgetValue,\n} from \"../slices/notebooksSlice\";\nimport { Range, getTrackBackground } from \"react-range\";\nimport { useSearchParams } from \"react-router-dom\";\n\ntype RangeProps = {\n  widgetKey: string;\n  label: string | null;\n  value: [number, number] | null;\n  min: number | null;\n  max: number | null;\n  step: number | null;\n  vertical: boolean | null;\n  disabled: boolean;\n  hidden: boolean;\n  runNb: () => void;\n  url_key: string;\n};\n\nexport default function RangeWidget({\n  widgetKey,\n  label,\n  value,\n  min,\n  max,\n  step,\n  vertical,\n  disabled,\n  hidden,\n  runNb,\n  url_key,\n}: RangeProps) {\n  let minValue = 0;\n  let maxValue = 100;\n  let stepValue = 1;\n  if (min) {\n    minValue = min;\n  }\n  if (max) {\n    maxValue = max;\n  }\n  if (step) {\n    stepValue = step;\n  }\n\n  const dispatch = useDispatch();\n  const [updated, userInteraction] = useState(false);\n  const [searchParams] = useSearchParams();\n\n  useEffect(() => {\n    if (url_key !== undefined && url_key !== \"\") {\n      const urlValue = searchParams\n        .get(url_key)\n        ?.split(\",\")\n        .map((i) => parseFloat(i));\n      if (\n        !updated &&\n        urlValue !== undefined &&\n        urlValue.length === 2 &&\n        urlValue[0] !== undefined &&\n        !isNaN(urlValue[0]) &&\n        urlValue[1] !== undefined &&\n        !isNaN(urlValue[1]) &&\n        urlValue[0] <= urlValue[1] &&\n        urlValue[0] >= minValue &&\n        urlValue[1] <= maxValue\n      ) {\n        dispatch(\n          setWidgetUrlValue({\n            key: widgetKey,\n            value: urlValue as [number, number],\n          })\n        );\n        dispatch(setUrlValuesUsed(true));\n      }\n    }\n  }, [dispatch, maxValue, minValue, searchParams, updated, url_key, widgetKey]);\n\n  const values =\n    value != null && value !== undefined && value.length === 2\n      ? value\n      : [minValue, maxValue];\n\n  return (\n    <div className=\"form-group mb-3\" style={{ display: hidden ? \"none\" : \"\" }}>\n      <label\n        htmlFor={`range-slider-${label}`}\n        style={{ color: disabled ? \"#555\" : \"#212529\" }}\n      >\n        {label}\n      </label>\n\n      <div\n        style={{\n          paddingTop: \"12px\",\n          display: \"flex\",\n          justifyContent: \"center\",\n          flexWrap: \"wrap\",\n        }}\n      >\n        <Range\n          disabled={disabled}\n          values={values}\n          step={stepValue}\n          min={minValue}\n          max={maxValue}\n          onChange={(values) => {\n            userInteraction(true);\n            dispatch(clearWidgetsUrlValues());\n            dispatch(\n              setWidgetValue({\n                key: widgetKey,\n                value: values as [number, number],\n              })\n            );\n          }}\n          onFinalChange={(values) => {\n            runNb();\n          }}\n          renderTrack={({ props, children }) => (\n            <div\n              onMouseDown={props.onMouseDown}\n              onTouchStart={props.onTouchStart}\n              style={{\n                ...props.style,\n                height: \"36px\",\n                display: \"flex\",\n                width: \"100%\",\n              }}\n            >\n              <div\n                ref={props.ref}\n                style={{\n                  height: \"5px\",\n                  width: \"100%\",\n                  borderRadius: \"4px\",\n                  background: getTrackBackground({\n                    values,\n                    colors: [\n                      \"#ccc\",\n                      disabled ? \"rgba(0, 0, 0, 0.3)\" : \"#2684ff\",\n                      \"#ccc\",\n                    ],\n                    min: minValue,\n                    max: maxValue,\n                  }),\n                  alignSelf: \"center\",\n                }}\n              >\n                {children}\n\n                <div\n                  style={{\n                    display: \"inline-block\",\n                    width: \"100%\",\n                    fontSize: \"12px\",\n                    paddingTop: \"13px\",\n                  }}\n                >\n                  <div style={{ float: \"left\" }}>{minValue}</div>\n                  <div style={{ float: \"right\" }}>{maxValue}</div>\n                </div>\n              </div>\n            </div>\n          )}\n          renderThumb={({ index, props, isDragged }) => (\n            <div\n              {...props}\n              style={{\n                ...props.style,\n                height: \"18px\",\n                width: \"18px\",\n                border: \"None !important\",\n                borderRadius: \"4px\",\n                backgroundColor: \"#FFF\",\n                display: \"flex\",\n                justifyContent: \"center\",\n                alignItems: \"center\",\n                boxShadow: \"0px 2px 6px #AAA\",\n                outline: \"none\",\n              }}\n            >\n              <div\n                style={{\n                  position: \"absolute\",\n                  top: \"-24px\",\n                  color: \"#fff\",\n                  fontWeight: \"bold\",\n                  fontSize: \"12px\",\n                  fontFamily: \"Arial,Helvetica Neue,Helvetica,sans-serif\",\n                  padding: \"2px\",\n                  borderRadius: \"3px\",\n                  backgroundColor: disabled ? \"rgba(0, 0, 0, 0.3)\" : \"#2684ff\",\n                }}\n              >\n                {values[index]}\n              </div>\n              <div\n                style={{\n                  height: \"12px\",\n                  width: \"3px\",\n                  backgroundColor: isDragged ? \"#2684ff\" : \"#CCC\",\n                }}\n              />\n            </div>\n          )}\n        />\n      </div>\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { useSearchParams } from \"react-router-dom\";\nimport Select, { MultiValue } from \"react-select\";\nimport {\n  setUrlValuesUsed,\n  setWidgetUrlValue,\n  setWidgetValue,\n} from \"../slices/notebooksSlice\";\n\ntype SingleOption = { value: string; label: string };\ntype MultiOption = MultiValue<{ value: string; label: string } | undefined>;\n\nexport function isSingleOption(\n  options: SingleOption | MultiOption\n): options is SingleOption {\n  return (options as SingleOption).value !== undefined;\n}\n\ntype SelectProps = {\n  widgetKey: string;\n  label: string | null;\n  value: string | string[] | null;\n  choices: string[];\n  multi: boolean | undefined;\n  disabled: boolean;\n  hidden: boolean;\n  runNb: () => void;\n  url_key: string;\n};\n\nexport default function SelectWidget({\n  widgetKey,\n  label,\n  value,\n  choices,\n  multi,\n  disabled,\n  hidden,\n  runNb,\n  url_key,\n}: SelectProps) {\n  const dispatch = useDispatch();\n  const [updated, userInteraction] = useState(false);\n\n  const selectStyles = {\n    menu: (base: any) => ({\n      ...base,\n      zIndex: 100,\n    }),\n  };\n\n  const [searchParams] = useSearchParams();\n  useEffect(() => {\n    if (url_key !== undefined && url_key !== \"\") {\n      const urlValue = searchParams.get(url_key);\n      if (!updated && urlValue !== undefined && urlValue !== null) {\n        if (multi) {\n          const arr = urlValue.split(\",\");\n          if (arr) {\n            dispatch(\n              setWidgetUrlValue({\n                key: widgetKey,\n                value: arr.filter((a) => choices.includes(a)),\n              })\n            );\n            dispatch(setUrlValuesUsed(true));\n          }\n        } else {\n          if (choices.includes(urlValue)) {\n            dispatch(\n              setWidgetUrlValue({\n                key: widgetKey,\n                value: urlValue,\n              })\n            );\n            dispatch(setUrlValuesUsed(true));\n          }\n        }\n      }\n    }\n  }, [choices, dispatch, multi, searchParams, updated, url_key, widgetKey]);\n\n  let selectedValue: SingleOption = { value: \"\", label: \"\" };\n  let selectedValues: SingleOption[] = [{ value: \"\", label: \"\" }];\n\n  let options: { value: string; label: string }[] = choices.map((choice) => {\n    if (value && choice === value && !multi) {\n      selectedValue = { value: choice, label: choice };\n    }\n    return { value: choice, label: choice };\n  });\n\n  if (multi) {\n    selectedValues = [];\n    choices.map((choice) => {\n      if (value && value.includes(choice) && multi) {\n        selectedValues.push({ value: choice, label: choice });\n      }\n      return { value: choice, label: choice };\n    });\n  }\n\n  useEffect(() => {\n    if (!updated) return;\n    runNb();\n    // const timeOutId = setTimeout(() => {\n    //   // console.log(\"run from select\");\n    //   runNb();\n    // }, RUN_DELAY_FAST);\n    // return () => clearTimeout(timeOutId);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [value]);\n\n  return (\n    <div className=\"form-group mb-3\" style={{ display: hidden ? \"none\" : \"\" }}>\n      <label\n        htmlFor={`select-${label}`}\n        style={{ color: disabled ? \"#555\" : \"#212529\" }}\n      >\n        {label}\n      </label>\n      <Select\n        id={`select-${label}`}\n        isDisabled={disabled}\n        name={label ? label : \"Select\"}\n        styles={selectStyles}\n        value={multi ? selectedValues : selectedValue}\n        options={options}\n        isMulti={multi}\n        onChange={(e) => {\n          if (e) {\n            userInteraction(true);\n            if (isSingleOption(e)) {\n              dispatch(setWidgetValue({ key: widgetKey, value: e.value }));\n            } else {\n              // console.log({ msg: \"values\", values: e.values() });\n              const vs = Array.from(e.values()).filter(\n                (i) => i !== undefined\n              ) as { label: string; value: string }[];\n              // console.log({\n              //   key: widgetKey,\n              // });\n              dispatch(\n                setWidgetValue({\n                  key: widgetKey,\n                  value: vs.map((i) => i.value) as string[],\n                })\n              );\n            }\n          }\n        }}\n      />\n    </div>\n  );\n}\n","import React, { useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport {\n  setUrlValuesUsed,\n  setWidgetUrlValue,\n  setWidgetValue,\n} from \"../slices/notebooksSlice\";\nimport { Range, getTrackBackground } from \"react-range\";\nimport { useSearchParams } from \"react-router-dom\";\n\ntype SliderProps = {\n  widgetKey: string;\n  label: string | null;\n  value: number | null;\n  min: number | null;\n  max: number | null;\n  step: number | null;\n  vertical: boolean | null;\n  disabled: boolean;\n  hidden: boolean;\n  runNb: () => void;\n  url_key: string;\n};\n\nexport default function SliderWidget({\n  widgetKey,\n  label,\n  value,\n  min,\n  max,\n  step,\n  vertical,\n  disabled,\n  hidden,\n  runNb,\n  url_key,\n}: SliderProps) {\n  const dispatch = useDispatch();\n  const [updated, userInteraction] = useState(false);\n\n  let minValue = 0;\n  let maxValue = 100;\n  let stepValue = 1;\n  if (min) {\n    minValue = min;\n  }\n  if (max) {\n    maxValue = max;\n  }\n  if (step) {\n    stepValue = step;\n  }\n  const [searchParams] = useSearchParams();\n  useEffect(() => {\n    if (url_key !== undefined && url_key !== \"\") {\n      const urlValue = searchParams.get(url_key);\n      if (\n        !updated &&\n        urlValue !== undefined &&\n        urlValue !== null &&\n        !isNaN(parseFloat(urlValue)) &&\n        parseFloat(urlValue) >= minValue &&\n        parseFloat(urlValue) <= maxValue\n      ) {\n        dispatch(\n          setWidgetUrlValue({\n            key: widgetKey,\n            value: parseFloat(urlValue),\n          })\n        );\n        dispatch(setUrlValuesUsed(true));\n      }\n    }\n  }, [dispatch, maxValue, minValue, searchParams, updated, url_key, widgetKey]);\n\n  const vals: number[] = [value !== null ? value : maxValue];\n\n  return (\n    <div className=\"form-group mb-3\" style={{ display: hidden ? \"none\" : \"\" }}>\n      <label\n        htmlFor={`slider-${label}`}\n        style={{ color: disabled ? \"#555\" : \"#212529\" }}\n      >\n        {label}\n      </label>\n\n      <div\n        style={{\n          paddingTop: \"12px\",\n          display: \"flex\",\n          justifyContent: \"center\",\n          flexWrap: \"wrap\",\n        }}\n      >\n        <Range\n          disabled={disabled}\n          values={vals}\n          step={stepValue}\n          min={minValue}\n          max={maxValue}\n          onChange={(values) => {\n            userInteraction(true);\n            dispatch(setWidgetValue({ key: widgetKey, value: values[0] }));\n          }}\n          onFinalChange={(values) => {\n            runNb();\n          }}\n          renderTrack={({ props, children }) => (\n            <div\n              onMouseDown={props.onMouseDown}\n              onTouchStart={props.onTouchStart}\n              style={{\n                ...props.style,\n                height: \"36px\",\n                display: \"flex\",\n                width: \"100%\",\n              }}\n            >\n              <div\n                ref={props.ref}\n                style={{\n                  height: \"5px\",\n                  width: \"100%\",\n                  borderRadius: \"4px\",\n                  background: getTrackBackground({\n                    values: vals,\n                    colors: [\n                      disabled ? \"rgba(0, 0, 0, 0.3)\" : \"#2684ff\", // \"#548BF4\",\n                      \"#ccc\",\n                    ],\n                    min: minValue,\n                    max: maxValue,\n                  }),\n                  alignSelf: \"center\",\n                }}\n              >\n                {children}\n\n                <div\n                  style={{\n                    display: \"inline-block\",\n                    width: \"100%\",\n                    fontSize: \"12px\",\n                    paddingTop: \"13px\",\n                  }}\n                >\n                  <div style={{ float: \"left\" }}>{minValue}</div>\n                  <div style={{ float: \"right\" }}>{maxValue}</div>\n                </div>\n              </div>\n            </div>\n          )}\n          renderThumb={({ props, isDragged }) => (\n            <div\n              {...props}\n              style={{\n                ...props.style,\n                height: \"18px\",\n                width: \"18px\",\n                border: \"None\",\n                borderRadius: \"4px\",\n                backgroundColor: \"#FFF\",\n                display: \"flex\",\n                justifyContent: \"center\",\n                alignItems: \"center\",\n                boxShadow: \"0px 2px 6px #AAA\",\n                outline: \"none\",\n              }}\n            >\n              <div\n                style={{\n                  position: \"absolute\",\n                  top: \"-24px\",\n                  color: \"#fff\",\n                  fontWeight: \"bold\",\n                  fontSize: \"12px\",\n                  fontFamily: \"Arial,Helvetica Neue,Helvetica,sans-serif\",\n                  padding: \"2px\",\n                  borderRadius: \"3px\",\n                  backgroundColor: disabled ? \"rgba(0, 0, 0, 0.3)\" : \"#2684ff\",\n                }}\n              >\n                {vals[0]}\n              </div>\n              <div\n                style={{\n                  height: \"12px\",\n                  width: \"3px\",\n                  backgroundColor: isDragged ? \"#2684ff\" : \"#CCC\",\n                }}\n              />\n            </div>\n          )}\n        />\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nimport axios, { AxiosProgressEvent } from \"axios\";\n\nimport { setWidgetValue } from \"../slices/notebooksSlice\";\n\nimport { FilePond, registerPlugin } from \"react-filepond\";\nimport FilePondPluginImageExifOrientation from \"filepond-plugin-image-exif-orientation\";\nimport FilePondPluginImagePreview from \"filepond-plugin-image-preview\";\nimport FilePondPluginFileValidateSize from \"filepond-plugin-file-validate-size\";\nimport {\n  deleteUserFileUploaded,\n  fetchStorageType,\n  getStorageType,\n  userFileUploaded,\n} from \"../slices/appSlice\";\nimport { toast } from \"react-toastify\";\nimport { getSiteId } from \"../slices/sitesSlice\";\nimport { getSessionId } from \"../utils\";\n\nregisterPlugin(\n  FilePondPluginImageExifOrientation,\n  FilePondPluginImagePreview,\n  FilePondPluginFileValidateSize\n);\n\ntype FileProps = {\n  widgetKey: string;\n  label: string | null;\n  maxFileSize: string | null;\n  disabled: boolean;\n  hidden: boolean;\n  value: string[];\n  runNb: () => void;\n};\n\nexport default function FileWidget({\n  widgetKey,\n  label,\n  maxFileSize,\n  disabled,\n  hidden,\n  value,\n  runNb,\n}: FileProps) {\n  const dispatch = useDispatch();\n  const [updated, userInteraction] = useState(false);\n  const storageType = useSelector(getStorageType);\n  const siteId = useSelector(getSiteId);\n  const sessionId = useSelector(getSessionId);\n\n  let fileSizeLimit = \"100MB\";\n  if (maxFileSize) {\n    fileSizeLimit = maxFileSize;\n  }\n  useEffect(() => {\n    if (updated && value !== undefined && value.length === 2) {\n      //console.log(\"run from file\");\n      runNb();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [value]);\n\n  useEffect(() => {\n    dispatch(fetchStorageType());\n  }, [dispatch]);\n\n  const mediaServerActions = {\n    url: `${axios.defaults.baseURL}/api/v1/fp`,\n    process: \"/process/\",\n    revert: async (\n      uniqueFileId: any,\n      load: () => void,\n      error: (arg0: string) => void\n    ) => {\n      try {\n        await axios.delete(`${axios.defaults.baseURL}/api/v1/fp/revert`, {\n          data: uniqueFileId,\n        });\n        dispatch(setWidgetValue({ key: widgetKey, value: [] }));\n        // Should call the load method when done, no parameters required\n        load();\n      } catch (e) {\n        // Can call the error method if something is wrong, should exit after\n        error(\"Problem with uploaded file removal\");\n      }\n    },\n  };\n  const s3ServerActions = {\n    process: (\n      fieldName: string,\n      file: { name: any; size: any },\n      metadata: any,\n      load: (arg0: any) => void,\n      error: any,\n      progress: (arg0: boolean, arg1: any, arg2: number) => void,\n      abort: () => void\n    ) => {\n      const abortController = new AbortController();\n\n      axios\n        .get(\n          `/api/v1/nb-file-put/${siteId}/${sessionId}/${file.name}/${file.size}`\n        )\n        .then((response) => {\n          const { url } = response.data;\n\n          let token = axios.defaults.headers.common[\"Authorization\"];\n\n          delete axios.defaults.headers.common[\"Authorization\"];\n\n          const config = {\n            onUploadProgress: (progressEvent: AxiosProgressEvent) => {\n              progress(\n                progressEvent.total !== undefined,\n                progressEvent.loaded,\n                progressEvent.total as number\n              );\n            },\n          };\n\n          axios\n            .put(url, file, {\n              headers: {\n                \"Content-Type\": \"\",\n              },\n              onUploadProgress: config.onUploadProgress,\n              signal: abortController.signal,\n            })\n            .then((response) => {\n              // file uploaded\n              // set it as uploaded in filepond\n              load(file.name);\n              // save it in database\n              if (siteId !== undefined) {\n                dispatch(userFileUploaded(siteId, sessionId, file.name));\n              }\n            })\n            .catch((error) => {\n              toast.error(\"Error when uploading new files\");\n            });\n\n          axios.defaults.headers.common[\"Authorization\"] = token;\n        })\n        .catch((error) => {\n          toast.error(\"Cant upload new files\");\n        });\n\n      // Should expose an abort method so the request can be cancelled\n      return {\n        abort: () => {\n          // This function is entered if the user has tapped the cancel button\n          abortController.abort();\n          // Let FilePond know the request has been cancelled\n          abort();\n        },\n      };\n    },\n    revert: async (\n      uniqueFileId: any,\n      load: () => void,\n      error: (arg0: string) => void\n    ) => {\n      try {\n        if (siteId !== undefined) {\n          dispatch(deleteUserFileUploaded(siteId, sessionId, uniqueFileId));\n        }\n        // Should call the load method when done, no parameters required\n        load();\n      } catch (e) {\n        // Can call the error method if something is wrong, should exit after\n        error(\"Problem with uploaded file removal\");\n      }\n    },\n  };\n\n  return (\n    <div className=\"form-group mb-3\" style={{ display: hidden ? \"none\" : \"\" }}>\n      <label\n        htmlFor={`file-${label}`}\n        style={{ color: disabled ? \"#555\" : \"#212529\" }}\n      >\n        {label}\n      </label>\n      <div>\n        <FilePond\n          disabled={disabled}\n          maxFileSize={fileSizeLimit}\n          onprocessfile={(error, file) => {\n            userInteraction(true);\n            dispatch(\n              setWidgetValue({\n                key: widgetKey,\n                value: [file.filename, file.serverId],\n              })\n            );\n          }}\n          server={\n            storageType === \"media\" ? mediaServerActions : s3ServerActions\n          }\n          labelIdle='Drag & Drop your file or <span class=\"filepond--label-action\">Browse</span>'\n        />\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { useSearchParams } from \"react-router-dom\";\nimport { setUrlValuesUsed, setWidgetUrlValue, setWidgetValue } from \"../slices/notebooksSlice\";\n\ntype TextProps = {\n  widgetKey: string;\n  label: string | null;\n  value: string | undefined;\n  rows: number | null;\n  disabled: boolean;\n  hidden: boolean;\n  runNb: () => void;\n  continuousUpdate: boolean;\n  url_key: string;\n  sanitize: boolean;\n};\n\nexport default function TextWidget({\n  widgetKey,\n  label,\n  value,\n  rows,\n  disabled,\n  hidden,\n  runNb,\n  continuousUpdate,\n  url_key,\n  sanitize,\n}: TextProps) {\n  const dispatch = useDispatch();\n  const [apply, showApply] = useState(false);\n  const [updated, userInteraction] = useState(false);\n  let rowsValue: number = rows ? rows : 1;\n\n  const sanitizeString = (input_string: string) => {\n    return input_string.replace(/[\"'(){}[\\]`^]/gim, \"\");\n  };\n\n  const [searchParams] = useSearchParams();\n  useEffect(() => {\n    if (url_key !== undefined && url_key !== \"\") {\n      const urlValue = searchParams.get(url_key);\n      if (!updated && urlValue !== undefined && urlValue !== null) {\n        dispatch(\n          setWidgetUrlValue({\n            key: widgetKey,\n            value: urlValue,\n          })\n        );\n        dispatch(setUrlValuesUsed(true));\n      }\n    }\n  }, [dispatch, searchParams, updated, url_key, widgetKey]);\n\n  return (\n    <div className=\"form-group mb-3\" style={{ display: hidden ? \"none\" : \"\" }}>\n      <label\n        htmlFor={`textarea-${label}`}\n        style={{ color: disabled ? \"#555\" : \"#212529\" }}\n      >\n        {label}\n      </label>\n      {rowsValue === 1 && (\n        <input\n          className=\"form-control\"\n          type=\"text\"\n          id={`text-${label}`}\n          value={value ? value : \"\"}\n          onChange={(e) => {\n            userInteraction(true);\n            showApply(true);\n            dispatch(\n              setWidgetValue({\n                key: widgetKey,\n                value: sanitize ? sanitizeString(e.target.value) : e.target.value,\n              })\n            );\n          }}\n          onKeyPress={(e) => {\n            if (e.key === \"Enter\") {\n              runNb();\n              showApply(false);\n              e.preventDefault();\n            }\n          }}\n          disabled={disabled}\n        />\n      )}\n      {rowsValue > 1 && (\n        <textarea\n          className=\"form-control\"\n          id={`text-area-${label}`}\n          rows={rowsValue}\n          value={value ? value : \"\"}\n          onChange={(e) => {\n            userInteraction(true);\n            showApply(true);\n            dispatch(\n              setWidgetValue({\n                key: widgetKey,\n                value: sanitize ? sanitizeString(e.target.value) : e.target.value,\n              })\n            );\n          }}\n          disabled={disabled}\n        />\n      )}\n\n      {apply && continuousUpdate && rowsValue === 1 && (\n        // <div\n        //   style={{\n        //     fontSize: \"0.7em\",\n        //     float: \"right\",\n        //     position: \"relative\",\n        //     top: \"0px\",\n        //     left: \"-5px\",\n        //     color: \"#2684ff\",\n        //   }}\n        // >\n        //   Press enter to apply\n        // </div>\n\n        <div\n          style={{\n            float: \"right\",\n            position: \"relative\",\n            top: \"2px\",\n            left: \"0px\",\n          }}\n        >\n          <button\n            className=\"btn btn-sm btn-outline-primary\"\n            onClick={(e) => {\n              runNb();\n              showApply(false);\n              e.preventDefault();\n            }}\n            style={{\n              fontSize: \"0.7em\",\n              border: \"none\",\n            }}\n          >\n            Press enter or click to apply\n          </button>\n        </div>\n      )}\n      {apply && continuousUpdate && rowsValue > 1 && (\n        <div\n          style={{\n            float: \"right\",\n            position: \"relative\",\n            top: \"2px\",\n            left: \"0px\",\n          }}\n        >\n          <button\n            className=\"btn btn-sm btn-outline-primary\"\n            onClick={(e) => {\n              runNb();\n              showApply(false);\n              e.preventDefault();\n            }}\n            style={{\n              fontSize: \"0.7em\",\n              border: \"none\",\n            }}\n          >\n            Apply\n          </button>\n        </div>\n      )}\n    </div>\n  );\n}\n","/* eslint-disable import/no-cycle */\nimport { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { RootState } from \"../store\";\n\nexport enum WebSocketState {\n  Connecting = \"Connecting\",\n  Connected = \"Connected\",\n  Unknown = \"Unknown\",\n  Disconnected = \"Disconnected\",\n}\n\nexport enum WorkerState {\n  Unknown = \"Unknown\",\n  Starting = \"Starting\",\n  Running = \"Running\",\n  Missing = \"Missing\",\n  Busy = \"Busy\",\n  Queued = \"Queued\",\n  MaxRunTimeReached = \"MaxRunTimeReached\",\n  MaxIdleTimeReached = \"MaxIdleTimeReached\",\n  UsageLimitReached = \"UsageLimitReached\",\n  //InstallPackages = \"InstallPackages\",\n}\n\nconst initialState = {\n  webSocketState: WebSocketState.Unknown,\n  workerState: WorkerState.Unknown,\n  workerId: undefined as undefined | number,\n  notebookSrc: \"\",\n  tryConnectCount: 0,\n};\n\nconst wsSlice = createSlice({\n  name: \"ws\",\n  initialState,\n  reducers: {\n    setWebSocketState(state, action: PayloadAction<WebSocketState>) {\n      state.webSocketState = action.payload;\n    },\n    setWorkerState(state, action: PayloadAction<WorkerState>) {\n      state.workerState = action.payload;\n    },\n    setWorkerId(state, action: PayloadAction<undefined | number>) {\n      state.workerId = action.payload;\n    },\n    setNotebookSrc(state, action: PayloadAction<string>) {\n      state.notebookSrc = action.payload;\n    },\n    increaseTryConnectCount(state) {\n      state.tryConnectCount += 1;\n    },\n    resetTryConnectCount(state) {\n      state.tryConnectCount = 0;\n    },\n  },\n});\n\nexport default wsSlice.reducer;\n\nexport const {\n  setWebSocketState,\n  setWorkerState,\n  setWorkerId,\n  setNotebookSrc,\n  increaseTryConnectCount,\n  resetTryConnectCount,\n} = wsSlice.actions;\n\nexport const getWebSocketState = (state: RootState) => state.ws.webSocketState;\nexport const getWorkerState = (state: RootState) => state.ws.workerState;\nexport const getWorkerId = (state: RootState) => state.ws.workerId;\nexport const getNotebookSrc = (state: RootState) => state.ws.notebookSrc;\nexport const getTryConnectCount = (state: RootState) =>\n  state.ws.tryConnectCount;\n\nexport const runNotebook = (widgets_params: string) => {\n  return {\n    purpose: \"run-notebook\",\n    widgets: widgets_params,\n  };\n};\n\nexport const saveNotebook = () => {\n  return {\n    purpose: \"save-notebook\",\n  };\n};\n\nexport const displayNotebook = (taskId: number) => {\n  return {\n    purpose: \"display-notebook\",\n    taskId,\n  };\n};\n\nexport const downloadHTML = () => {\n  return {\n    purpose: \"download-html\",\n  };\n};\n\nexport const downloadPDF = () => {\n  return {\n    purpose: \"download-pdf\",\n  };\n};\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\n\nimport ReactMarkdown from \"react-markdown\";\nimport rehypeHighlight from \"rehype-highlight\";\nimport remarkGfm from \"remark-gfm\";\nimport emoji from \"remark-emoji\";\nimport rehypeRaw from \"rehype-raw\";\n\ntype MarkdownProps = {\n  value: string;\n  disabled: boolean;\n};\n\nexport default function MarkdownWidget({ value, disabled }: MarkdownProps) {\n  return (\n    <div\n      className=\"form-group mb-3\"\n      style={{ color: disabled ? \"#555\" : \"#212529\" }}\n    >\n      <ReactMarkdown\n        rehypePlugins={[remarkGfm, rehypeHighlight, emoji, rehypeRaw]}\n      >\n        {value}\n      </ReactMarkdown>\n    </div>\n  );\n}\n","import React, { createContext, useEffect } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport {\n  getSelectedNotebookId,\n  hideWidgets,\n  isStaticNotebook,\n  updateWidgetsParams,\n  initWidgets,\n  fetchNotebook,\n  updateTitle,\n  updateShowCode,\n  setWidgetsInitialized,\n} from \"../slices/notebooksSlice\";\nimport {\n  setNotebookSrc,\n  setWebSocketState,\n  setWorkerState,\n  setWorkerId,\n  WebSocketState,\n  WorkerState,\n  resetTryConnectCount,\n  increaseTryConnectCount,\n} from \"../slices/wsSlice\";\n\nimport { useSelector } from \"react-redux\";\nimport { getSessionId, handleDownload } from \"../utils\";\nimport { setExportingToPDF } from \"../slices/tasksSlice\";\nimport { getSiteId, setSiteStatus, SiteStatus } from \"../slices/sitesSlice\";\nimport { getToken } from \"../slices/authSlice\";\n\nconst WebSocketContext = createContext(undefined as any);\n\nexport { WebSocketContext };\n\nlet wsServer = \"ws://127.0.0.1:8000\";\nlet localServer = true;\nif (process.env.REACT_APP_SERVER_WS) {\n  wsServer = process.env.REACT_APP_SERVER_WS;\n  localServer = false;\n} else {\n  if (window.location.origin === \"http://localhost:3000\") {\n    wsServer = \"ws://127.0.0.1:8000\";\n    localServer = true;\n  } else {\n    wsServer = window.location.origin\n      .replace(\"http://\", \"ws://\")\n      .replace(\"https://\", \"wss://\");\n    localServer = false;\n  }\n}\n\nif (window.location.origin.endsWith(\"hf.space\")) {\n  wsServer = window.location.origin\n    .replace(\"http://\", \"ws://\")\n    .replace(\"https://\", \"wss://\");\n  localServer = false;\n}\n\nconst MAX_CONNECT_COUNT = 5;\nlet connectCounter = 0;\nlet globalConnection: WebSocket | undefined = undefined;\n\nexport default function WebSocketProvider({\n  children,\n}: {\n  children: JSX.Element;\n}) {\n  console.log(\"WebSocketProvider\");\n\n  const dispatch = useDispatch();\n  const siteId = useSelector(getSiteId);\n  const selectedNotebookId = useSelector(getSelectedNotebookId);\n  const token = useSelector(getToken);\n  const isStatic = useSelector(isStaticNotebook);\n\n  let connection: WebSocket | undefined = undefined;\n  let workerState = \"Unknown\" as WorkerState;\n\n  useEffect(() => {\n    connectCounter = 0;\n    // returned function will be called on component unmount\n    return () => {\n      connectCounter = MAX_CONNECT_COUNT + 1;\n      globalConnection?.close();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const sendMessage = (payload: string) => {\n    if (connection !== undefined && connection.readyState === connection.OPEN) {\n      connection.send(payload);\n    }\n  };\n\n  function onOpen(event: any): void {\n    dispatch(resetTryConnectCount());\n    sendMessage(\n      JSON.stringify({\n        purpose: \"server-address\",\n        address: wsServer,\n      })\n    );\n    dispatch(setWebSocketState(WebSocketState.Connected));\n    ping();\n  }\n\n  function onMessage(event: any): void {\n    // console.log(\"reveived from server\", event.data);\n\n    const response = JSON.parse(event.data);\n    if (\"purpose\" in response) {\n      if (response.purpose === \"worker-state\") {\n        console.log(\"worker-state\", response.state);\n        workerState = response.state;\n\n        dispatch(setWorkerState(response.state));\n        dispatch(setWorkerId(response.workerId));\n\n        if (\n          workerState === WorkerState.MaxIdleTimeReached ||\n          workerState === WorkerState.MaxRunTimeReached\n        ) {\n          connection?.close();\n        }\n      } else if (response.purpose === \"executed-notebook\") {\n        //console.log(response?.reloadNotebook, selectedNotebookId);\n        if (response?.reloadNotebook && selectedNotebookId !== undefined) {\n          //console.log(\"reload notebook ...........................\");\n          dispatch(fetchNotebook(siteId, selectedNotebookId));\n        }\n        dispatch(setNotebookSrc(response.body));\n        // } else if (response.purpose === \"saved-notebook\") {\n        //   if (selectedNotebookId !== undefined) {\n        //     dispatch(fetchExecutionHistory(selectedNotebookId, false));\n        //   }\n      } else if (response.purpose === \"update-widgets\") {\n        dispatch(updateWidgetsParams(response));\n      } else if (response.purpose === \"hide-widgets\") {\n        dispatch(hideWidgets(response));\n      } else if (response.purpose === \"init-widgets\") {\n        dispatch(initWidgets(response));\n        dispatch(setWidgetsInitialized(true));\n      } else if (response.purpose === \"update-title\") {\n        dispatch(updateTitle(response.title));\n      } else if (response.purpose === \"update-show-code\") {\n        dispatch(updateShowCode(response.showCode));\n      } else if (\n        response.purpose === \"download-html\" ||\n        response.purpose === \"download-pdf\"\n      ) {\n        if (response.url && response.filename) {\n          dispatch(setExportingToPDF(false));\n          handleDownload(response.url, response.filename);\n        }\n      }\n    }\n  }\n\n  function onError(event: any): void {\n    dispatch(setWebSocketState(WebSocketState.Disconnected));\n    dispatch(setWorkerState(WorkerState.Unknown));\n  }\n\n  function onClose(event: any): void {\n    dispatch(setWebSocketState(WebSocketState.Disconnected));\n    connection = undefined;\n    if (\n      workerState !== WorkerState.MaxIdleTimeReached &&\n      workerState !== WorkerState.MaxRunTimeReached\n    ) {\n      dispatch(setWorkerState(WorkerState.Unknown));\n      dispatch(setWorkerId(undefined));\n      if (connectCounter < MAX_CONNECT_COUNT) {\n        setTimeout(() => connect(), 5000);\n      }\n    }\n  }\n\n  function ping(): void {\n    sendMessage(\n      JSON.stringify({\n        purpose: \"worker-ping\",\n      })\n    );\n    if (connection !== undefined && connection.readyState === connection.OPEN) {\n      setTimeout(() => ping(), 10000);\n    }\n  }\n\n  function connect() {\n    if (\n      (localServer || !isStatic) &&\n      selectedNotebookId !== undefined &&\n      connection === undefined &&\n      workerState !== WorkerState.MaxIdleTimeReached &&\n      workerState !== WorkerState.MaxRunTimeReached &&\n      connectCounter < MAX_CONNECT_COUNT\n    ) {\n      console.log(\"WS connect ...\" + workerState + \" \" + connectCounter);\n      dispatch(increaseTryConnectCount());\n      let url = `${wsServer}/ws/client/${selectedNotebookId}/${getSessionId()}/`;\n      if (token !== undefined && token !== null && token !== \"\") {\n        url += `?token=${token}`;\n      }\n      connection = new WebSocket(url);\n      connection.onopen = onOpen;\n      connection.onmessage = onMessage;\n      connection.onerror = onError;\n      connection.onclose = onClose;\n      connectCounter += 1;\n\n      globalConnection = connection;\n      if (connectCounter >= MAX_CONNECT_COUNT) {\n        dispatch(setSiteStatus(SiteStatus.NetworkError));\n      }\n    }\n  }\n  connect();\n\n  const ws = {\n    sendMessage,\n  };\n\n  return (\n    <WebSocketContext.Provider value={ws}>{children}</WebSocketContext.Provider>\n  );\n}\n","import React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getSessionId, handleDownload } from \"../utils\";\nimport {\n  WorkerState,\n  WebSocketState,\n  getWebSocketState,\n  getWorkerState,\n  getTryConnectCount,\n} from \"../slices/wsSlice\";\nimport { getSiteId, setSiteStatus, SiteStatus } from \"../slices/sitesSlice\";\nimport axios from \"axios\";\nimport { exportToPDF, setExportingToPDF } from \"../slices/tasksSlice\";\nimport { setShowShareDialog } from \"../slices/appSlice\";\n\ntype Props = {\n  allowDownload: boolean;\n  allowShare: boolean;\n  waiting: boolean;\n  continuousUpdate: boolean;\n  staticNotebook: boolean;\n  notebookId: number;\n  notebookPath: string;\n  notebookTitle: string;\n  runDownloadHTML: () => void;\n  runDownloadPDF: () => void;\n};\n\nexport default function StatusBar({\n  allowDownload,\n  allowShare,\n  waiting,\n  continuousUpdate,\n  staticNotebook,\n  notebookId,\n  notebookPath,\n  notebookTitle,\n  runDownloadHTML,\n  runDownloadPDF,\n}: Props) {\n  const dispatch = useDispatch();\n  const wsStatus = useSelector(getWebSocketState);\n  const workerState = useSelector(getWorkerState);\n  const tryConnectCount = useSelector(getTryConnectCount);\n  const siteId = useSelector(getSiteId);\n\n  useEffect(() => {\n    if (tryConnectCount >= 5) {\n      dispatch(setSiteStatus(SiteStatus.LostConnection));\n    }\n  }, [dispatch, tryConnectCount]);\n\n  let wifiColor = \"orange\";\n  if (wsStatus === WebSocketState.Connected) {\n    wifiColor = \"green\";\n  } else if (\n    wsStatus === WebSocketState.Disconnected ||\n    wsStatus === WebSocketState.Unknown\n  ) {\n    wifiColor = \"red\";\n  }\n\n  let workerColor = \"orange\";\n  if (workerState === WorkerState.Running || workerState === WorkerState.Busy) {\n    workerColor = \"green\";\n  } else if (\n    workerState === WorkerState.Missing ||\n    workerState === WorkerState.Unknown\n  ) {\n    workerColor = \"red\";\n  }\n\n  return (\n    <div style={{ paddingBottom: \"25px\" }}>\n      {notebookId !== undefined && !staticNotebook && (\n        <>\n          <span title={`WebSocket: ${wsStatus}`}>\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              width=\"16\"\n              height=\"16\"\n              fill={wifiColor}\n              className=\"bi bi-wifi\"\n              viewBox=\"0 0 16 16\"\n            >\n              <path d=\"M15.384 6.115a.485.485 0 0 0-.047-.736A12.444 12.444 0 0 0 8 3C5.259 3 2.723 3.882.663 5.379a.485.485 0 0 0-.048.736.518.518 0 0 0 .668.05A11.448 11.448 0 0 1 8 4c2.507 0 4.827.802 6.716 2.164.205.148.49.13.668-.049z\" />\n              <path d=\"M13.229 8.271a.482.482 0 0 0-.063-.745A9.455 9.455 0 0 0 8 6c-1.905 0-3.68.56-5.166 1.526a.48.48 0 0 0-.063.745.525.525 0 0 0 .652.065A8.46 8.46 0 0 1 8 7a8.46 8.46 0 0 1 4.576 1.336c.206.132.48.108.653-.065zm-2.183 2.183c.226-.226.185-.605-.1-.75A6.473 6.473 0 0 0 8 9c-1.06 0-2.062.254-2.946.704-.285.145-.326.524-.1.75l.015.015c.16.16.407.19.611.09A5.478 5.478 0 0 1 8 10c.868 0 1.69.201 2.42.56.203.1.45.07.61-.091l.016-.015zM9.06 12.44c.196-.196.198-.52-.04-.66A1.99 1.99 0 0 0 8 11.5a1.99 1.99 0 0 0-1.02.28c-.238.14-.236.464-.04.66l.706.706a.5.5 0 0 0 .707 0l.707-.707z\" />\n            </svg>\n          </span>{\" \"}\n          <span title={`Worker: ${workerState}\\nSession Id: ${getSessionId()}`}>\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              width=\"16\"\n              height=\"16\"\n              fill={workerColor}\n              className=\"bi bi-cpu\"\n              viewBox=\"0 0 16 16\"\n            >\n              <path d=\"M5 0a.5.5 0 0 1 .5.5V2h1V.5a.5.5 0 0 1 1 0V2h1V.5a.5.5 0 0 1 1 0V2h1V.5a.5.5 0 0 1 1 0V2A2.5 2.5 0 0 1 14 4.5h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14a2.5 2.5 0 0 1-2.5 2.5v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14A2.5 2.5 0 0 1 2 11.5H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2A2.5 2.5 0 0 1 4.5 2V.5A.5.5 0 0 1 5 0zm-.5 3A1.5 1.5 0 0 0 3 4.5v7A1.5 1.5 0 0 0 4.5 13h7a1.5 1.5 0 0 0 1.5-1.5v-7A1.5 1.5 0 0 0 11.5 3h-7zM5 6.5A1.5 1.5 0 0 1 6.5 5h3A1.5 1.5 0 0 1 11 6.5v3A1.5 1.5 0 0 1 9.5 11h-3A1.5 1.5 0 0 1 5 9.5v-3zM6.5 6a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z\" />\n            </svg>\n          </span>\n        </>\n      )}\n      {workerState === WorkerState.Busy && (\n        <span title=\"Worker is busy\">\n          {\" \"}\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            width=\"16\"\n            height=\"16\"\n            fill=\"green\"\n            className=\"bi bi-activity\"\n            viewBox=\"0 0 16 16\"\n          >\n            <path\n              fillRule=\"evenodd\"\n              d=\"M6 2a.5.5 0 0 1 .47.33L10 12.036l1.53-4.208A.5.5 0 0 1 12 7.5h3.5a.5.5 0 0 1 0 1h-3.15l-1.88 5.17a.5.5 0 0 1-.94 0L6 3.964 4.47 8.171A.5.5 0 0 1 4 8.5H.5a.5.5 0 0 1 0-1h3.15l1.88-5.17A.5.5 0 0 1 6 2Z\"\n            />\n          </svg>\n        </span>\n      )}\n      <div style={{ float: \"right\" }}>\n        {allowDownload && (\n          <div\n            className=\"dropdown mx-2 btn-group\"\n            style={\n              {\n                //display: \"inline\",\n                // width: \"47%\",\n                // float: continuousUpdate ? \"left\" : \"right\",\n              }\n            }\n          >\n            <button\n              className=\"btn btn-sm btn-primary dropdown-toggle\"\n              // style={{ margin: \"0px\", width: \"100%\" }}\n              type=\"button\"\n              data-bs-toggle=\"dropdown\"\n              disabled={waiting}\n            >\n              <svg\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"14\"\n                height=\"14\"\n                viewBox=\"0 0 24 24\"\n                strokeWidth=\"2\"\n                stroke=\"currentColor\"\n                fill=\"none\"\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                style={{ paddingBottom: \"1px\" }}\n              >\n                <path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path>\n                <path d=\"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2\"></path>\n                <path d=\"M7 11l5 5l5 -5\"></path>\n                <path d=\"M12 4l0 12\"></path>\n              </svg>{\" \"}\n              Download\n            </button>\n\n            {/* dropdown-menu-end */}\n            <ul className=\"dropdown-menu my-2\">\n              <li>\n                <button\n                  type=\"button\"\n                  style={{ cursor: \"pointer\" }}\n                  className=\"dropdown-item\"\n                  onClick={() => {\n                    if (staticNotebook) {\n                      handleDownload(\n                        `${axios.defaults.baseURL}${notebookPath}`,\n                        `${notebookTitle}.html`\n                      );\n                    } else {\n                      runDownloadHTML();\n                    }\n                  }}\n                >\n                  <i className=\"fa fa-file-code-o\" aria-hidden=\"true\"></i>{\" \"}\n                  Download as HTML\n                </button>\n              </li>\n              <li>\n                <hr className=\"dropdown-divider\" />\n              </li>\n              <li>\n                <button\n                  type=\"button\"\n                  className=\"dropdown-item\"\n                  onClick={() => {\n                    if (staticNotebook) {\n                      dispatch(exportToPDF(siteId, notebookId, notebookPath));\n                    } else {\n                      dispatch(setExportingToPDF(true));\n                      runDownloadPDF();\n                    }\n                  }}\n                >\n                  <i className=\"fa fa-file-pdf-o\" aria-hidden=\"true\"></i>{\" \"}\n                  Download as PDF\n                </button>\n              </li>\n            </ul>\n          </div>\n        )}\n        {allowShare && (\n          <button\n            className=\"btn btn-sm btn-primary\"\n            onClick={() => dispatch(setShowShareDialog(true))}\n            disabled={waiting}\n          >\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              width=\"14\"\n              height=\"14\"\n              viewBox=\"0 0 24 24\"\n              strokeWidth=\"2\"\n              stroke=\"currentColor\"\n              fill=\"none\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n            >\n              <path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path>\n              <path d=\"M6 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0\"></path>\n              <path d=\"M18 6m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0\"></path>\n              <path d=\"M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0\"></path>\n              <path d=\"M8.7 10.7l6.6 -3.4\"></path>\n              <path d=\"M8.7 13.3l6.6 3.4\"></path>\n            </svg>{\" \"}\n            Share\n          </button>\n        )}\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { setWidgetValue } from \"../slices/notebooksSlice\";\n\ntype ButtonProps = {\n  widgetKey: string;\n  label: string | null;\n  style: string;\n  value: string | boolean | null;\n  disabled: boolean;\n  hidden: boolean;\n  runNb: () => void;\n};\n\nexport default function ButtonWidget({\n  widgetKey,\n  label,\n  style,\n  value,\n  disabled,\n  hidden,\n  runNb,\n}: ButtonProps) {\n  const dispatch = useDispatch();\n\n  let selectedClass = \"btn-primary\";\n  if (style === \"success\") {\n    selectedClass = \"btn-success\";\n  } else if (style === \"danger\") {\n    selectedClass = \"btn-danger\";\n  } else if (style === \"info\") {\n    selectedClass = \"btn-info\";\n  } else if (style === \"warning\") {\n    selectedClass = \"btn-warning\";\n  }\n\n  useEffect(() => {\n    if (value) {\n      runNb();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [value]);\n\n  return (\n    <div className=\"form-group mb-3\" style={{ display: hidden ? \"none\" : \"\" }}>\n      <button\n        type=\"button\"\n        className={`btn ${selectedClass}`}\n        style={{ marginRight: \"10px\", width: \"47%\" }}\n        onClick={() => {\n          dispatch(\n            setWidgetValue({\n              key: widgetKey,\n              value: true,\n            })\n          );\n        }}\n        disabled={disabled}\n      >\n        {label}\n      </button>\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\nimport { WorkerState } from \"../slices/wsSlice\";\n\ntype RunButtonProps = {\n  runNb: () => void;\n  waiting: boolean;\n  workerState: WorkerState;\n};\n\nexport default function RunButton({\n  runNb,\n  waiting,\n  workerState,\n}: RunButtonProps) {\n  return (\n    <button\n      type=\"button\"\n      className=\"btn btn-success\"\n      style={{ marginRight: \"10px\", width: \"100%\" }}\n      onClick={() => {\n        runNb();\n      }}\n      disabled={\n        waiting ||\n        // !allFilesUploaded() ||\n        workerState !== WorkerState.Running\n      }\n    >\n      {workerState === WorkerState.Running && (\n        <span>\n          <i className=\"fa fa-play\" aria-hidden=\"true\"></i> Run\n        </span>\n      )}\n      {workerState === WorkerState.Busy && (\n        <span>\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            width=\"16\"\n            height=\"16\"\n            fill=\"white\"\n            className=\"bi bi-activity\"\n            viewBox=\"0 0 16 16\"\n          >\n            <path\n              fillRule=\"evenodd\"\n              d=\"M6 2a.5.5 0 0 1 .47.33L10 12.036l1.53-4.208A.5.5 0 0 1 12 7.5h3.5a.5.5 0 0 1 0 1h-3.15l-1.88 5.17a.5.5 0 0 1-.94 0L6 3.964 4.47 8.171A.5.5 0 0 1 4 8.5H.5a.5.5 0 0 1 0-1h3.15l1.88-5.17A.5.5 0 0 1 6 2Z\"\n            />\n          </svg>{\" \"}\n          Busy\n        </span>\n      )}\n      {workerState !== WorkerState.Busy &&\n        workerState !== WorkerState.Running && <span>Waiting ...</span>}\n    </button>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useContext } from \"react\";\nimport { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { scrapeSlidesHash } from \"../slices/tasksSlice\";\nimport CheckboxWidget from \"../widgets/Checkbox\";\nimport NumericWidget from \"../widgets/Numeric\";\nimport RangeWidget from \"../widgets/Range\";\nimport SelectWidget from \"../widgets/Select\";\nimport SliderWidget from \"../widgets/Slider\";\n\nimport {\n  isCheckboxWidget,\n  isFileWidget,\n  isNumericWidget,\n  isRangeWidget,\n  isSelectWidget,\n  isSliderWidget,\n  isTextWidget,\n  isMarkdownWidget,\n  IWidget,\n  isOutputFilesWidget,\n  isButtonWidget,\n  isAPIResponseWidget,\n} from \"../widgets/Types\";\n\nimport {\n  clearWidgetsUrlValues,\n  getUrlValuesUsed,\n  getWidgetsInitialized,\n  getWidgetsUrlValues,\n  getWidgetsValues,\n  setSlidesHash,\n  setUrlValuesUsed,\n  setWidgetsInitialized,\n  setWidgetValue,\n  WidgetValueType,\n} from \"../slices/notebooksSlice\";\nimport FileWidget from \"../widgets/File\";\nimport TextWidget from \"../widgets/Text\";\nimport { setShowSideBar, setView } from \"../slices/appSlice\";\nimport MarkdownWidget from \"../widgets/Markdown\";\n\nimport { WebSocketContext } from \"../websocket/Provider\";\nimport WebSocketStateBar from \"./StatusBar\";\nimport {\n  downloadHTML,\n  downloadPDF,\n  getWorkerState,\n  runNotebook,\n  WorkerState,\n} from \"../slices/wsSlice\";\nimport ButtonWidget from \"../widgets/Button\";\nimport RunButton from \"./RunButton\";\nimport BlockUi from \"react-block-ui\";\n\ntype SideBarProps = {\n  notebookTitle: string;\n  notebookId: number;\n  notebookSchedule: string;\n  taskCreatedAt: Date;\n  loadingState: string;\n  waiting: boolean;\n  widgetsParams: Record<string, IWidget>;\n  watchMode: boolean;\n  notebookPath: string;\n  displayEmbed: boolean;\n  showFiles: boolean;\n  isPresentation: boolean;\n  notebookParseErrors: string;\n  continuousUpdate: boolean;\n  staticNotebook: boolean;\n  allowDownload: boolean;\n  allowShare: boolean;\n};\n\nexport default function SideBar({\n  notebookTitle,\n  notebookId,\n  notebookSchedule,\n  taskCreatedAt,\n  loadingState,\n  waiting,\n  widgetsParams,\n  watchMode,\n  notebookPath,\n  displayEmbed,\n  showFiles,\n  isPresentation,\n  notebookParseErrors,\n  continuousUpdate,\n  staticNotebook,\n  allowDownload,\n  allowShare,\n}: SideBarProps) {\n  const dispatch = useDispatch();\n  const widgetsValues: Record<string, WidgetValueType> = useSelector(\n    getWidgetsValues\n  ) as Record<string, WidgetValueType>;\n  const widgetsUrlValues = useSelector(getWidgetsUrlValues);\n  const workerState = useSelector(getWorkerState);\n  const widgetsInitialized = useSelector(getWidgetsInitialized);\n  const urlValuesUsed = useSelector(getUrlValuesUsed);\n  const ws = useContext(WebSocketContext);\n\n  const runNb = () => {\n    if (continuousUpdate) {\n      execNb();\n    }\n  };\n\n  const execNb = () => {\n    const slidesHash = scrapeSlidesHash();\n    dispatch(setSlidesHash(slidesHash));\n\n    if (widgetsUrlValues) {\n      let params = {} as Record<string, WidgetValueType>;\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      for (let [key, widgetParams] of Object.entries(widgetsParams)) {\n        if (key in widgetsUrlValues) {\n          params[key] = widgetsUrlValues[key];\n          dispatch(setWidgetValue({ key, value: params[key] }));\n        } else if (key in widgetsValues) {\n          params[key] = widgetsValues[key];\n        }\n      }\n      ws.sendMessage(JSON.stringify(runNotebook(JSON.stringify(params))));\n      dispatch(clearWidgetsUrlValues());\n    } else {\n      ws.sendMessage(\n        JSON.stringify(runNotebook(JSON.stringify(widgetsValues)))\n      );\n    }\n  };\n\n  useEffect(() => {\n    if (widgetsInitialized && urlValuesUsed) {\n      execNb();\n      dispatch(setUrlValuesUsed(false));\n      dispatch(setWidgetsInitialized(false));\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [widgetsInitialized, urlValuesUsed]);\n\n  const runDownloadHTML = () => {\n    if (!staticNotebook) {\n      ws.sendMessage(JSON.stringify(downloadHTML()));\n    }\n  };\n\n  const runDownloadPDF = () => {\n    if (!staticNotebook) {\n      ws.sendMessage(JSON.stringify(downloadPDF()));\n    }\n  };\n\n  useEffect(() => {\n    if (widgetsParams) {\n      for (let [key, widgetParams] of Object.entries(widgetsParams)) {\n        if (key in widgetsValues) {\n          continue;\n        }\n\n        if (widgetParams.input === \"file\") {\n          dispatch(setWidgetValue({ key, value: [] as string[] }));\n        } else if (widgetParams.input === \"text\") {\n          dispatch(\n            setWidgetValue({\n              key,\n              value: widgetParams.value ? widgetParams.value : \"\",\n            })\n          );\n        } else if (isMarkdownWidget(widgetParams)) {\n          // do nothing\n          // dont put value into store\n        } else if (isOutputFilesWidget(widgetParams)) {\n          dispatch(setWidgetValue({ key, value: \"output-dir\" }));\n        } else {\n          dispatch(setWidgetValue({ key, value: widgetParams.value }));\n        }\n      }\n    }\n  }, [dispatch, widgetsParams, widgetsValues]);\n\n  let widgets = [];\n  let fileKeys = [] as string[]; // keys to file widgets, all need to be selected to enable RUN button\n\n  if (widgetsParams && !staticNotebook) {\n    // sort widgets keys based on cell index and code line number\n    let widgetKeys = [];\n    for (let key of Object.keys(widgetsParams)) {\n      const parts = key.split(\".\");\n      widgetKeys.push([key, parseFloat(`${parts[1]}.${parts[2]}`)]);\n    }\n    widgetKeys.sort(function (a, b) {\n      const a1 = a[1] as number;\n      const b1 = b[1] as number;\n      return a1 - b1;\n    });\n\n    for (let wKey of widgetKeys) {\n      const key = wKey[0] as string;\n      const widgetParams = widgetsParams[key];\n\n      if (isSelectWidget(widgetParams)) {\n        widgets.push(\n          <SelectWidget\n            widgetKey={key}\n            disabled={waiting || widgetParams?.disabled}\n            hidden={widgetParams?.hidden}\n            label={widgetParams?.label}\n            value={widgetsValues[key] as string}\n            choices={widgetParams?.choices}\n            multi={widgetParams?.multi}\n            key={key}\n            runNb={runNb}\n            url_key={widgetParams?.url_key}\n          />\n        );\n      } else if (isCheckboxWidget(widgetParams)) {\n        widgets.push(\n          <CheckboxWidget\n            widgetKey={key}\n            disabled={waiting || widgetParams?.disabled}\n            hidden={widgetParams?.hidden}\n            label={widgetParams?.label}\n            value={widgetsValues[key] as boolean}\n            key={key}\n            runNb={runNb}\n            url_key={widgetParams?.url_key}\n          />\n        );\n      } else if (isNumericWidget(widgetParams)) {\n        widgets.push(\n          <NumericWidget\n            widgetKey={key}\n            disabled={waiting || widgetParams?.disabled}\n            hidden={widgetParams?.hidden}\n            label={widgetParams?.label}\n            value={widgetsValues[key] as number}\n            min={widgetParams?.min}\n            max={widgetParams?.max}\n            step={widgetParams?.step}\n            key={key}\n            runNb={runNb}\n            continuousUpdate={continuousUpdate}\n            url_key={widgetParams?.url_key}\n          />\n        );\n      } else if (isSliderWidget(widgetParams)) {\n        widgets.push(\n          <SliderWidget\n            widgetKey={key}\n            disabled={waiting || widgetParams?.disabled}\n            hidden={widgetParams?.hidden}\n            label={widgetParams?.label}\n            value={widgetsValues[key] as number}\n            min={widgetParams?.min}\n            max={widgetParams?.max}\n            step={widgetParams?.step}\n            vertical={widgetParams?.vertical}\n            key={key}\n            runNb={runNb}\n            url_key={widgetParams?.url_key}\n          />\n        );\n      } else if (isRangeWidget(widgetParams)) {\n        widgets.push(\n          <RangeWidget\n            widgetKey={key}\n            disabled={waiting || widgetParams?.disabled}\n            hidden={widgetParams?.hidden}\n            label={widgetParams?.label}\n            value={widgetsValues[key] as [number, number]}\n            min={widgetParams?.min}\n            max={widgetParams?.max}\n            step={widgetParams?.step}\n            vertical={widgetParams?.vertical}\n            key={key}\n            runNb={runNb}\n            url_key={widgetParams.url_key}\n          />\n        );\n      } else if (isFileWidget(widgetParams)) {\n        widgets.push(\n          <FileWidget\n            widgetKey={key}\n            disabled={waiting || widgetParams?.disabled}\n            hidden={widgetParams?.hidden}\n            label={widgetParams?.label}\n            maxFileSize={widgetParams?.maxFileSize}\n            key={key}\n            value={widgetsValues[key] as string[]}\n            runNb={runNb}\n          />\n        );\n        fileKeys.push(key);\n      } else if (isTextWidget(widgetParams)) {\n        widgets.push(\n          <TextWidget\n            widgetKey={key}\n            disabled={waiting || widgetParams?.disabled}\n            hidden={widgetParams?.hidden}\n            label={widgetParams?.label}\n            value={widgetsValues[key] as string}\n            rows={widgetParams?.rows}\n            key={key}\n            runNb={runNb}\n            continuousUpdate={continuousUpdate}\n            url_key={widgetParams?.url_key}\n            sanitize={widgetParams?.sanitize}\n          />\n        );\n      } else if (isMarkdownWidget(widgetParams)) {\n        widgets.push(\n          <MarkdownWidget\n            value={widgetParams.value as string}\n            disabled={waiting}\n            key={key}\n          />\n        );\n      } else if (isButtonWidget(widgetParams)) {\n        widgets.push(\n          <ButtonWidget\n            widgetKey={key}\n            disabled={waiting || widgetParams?.disabled}\n            hidden={widgetParams?.hidden}\n            label={widgetParams?.label}\n            value={widgetsValues[key] as boolean}\n            style={widgetParams?.style}\n            key={key}\n            runNb={runNb}\n          />\n        );\n      } else if (isOutputFilesWidget(widgetParams)) {\n        // do nothing\n      } else if (isAPIResponseWidget(widgetParams)) {\n        // do nothing\n      } else {\n        console.log(\"Unknown widget type\", widgetParams);\n      }\n    }\n  }\n\n  let additionalStyle = {};\n  if (displayEmbed) {\n    additionalStyle = { padding: \"0px\" };\n  }\n\n  const addSpaceInsteadTitle =\n    notebookTitle === undefined ||\n    notebookTitle === null ||\n    notebookTitle === \"\";\n\n  return (\n    <nav\n      id=\"sidebarMenu\"\n      className=\"col-lg-3 d-md-block bg-light sidebar\"\n      style={{ ...additionalStyle, overflowY: \"auto\" }}\n    >\n      <BlockUi blocking={false} message=\"\">\n        <div className=\"position-sticky p-3\">\n          <h4>\n            {notebookTitle}\n            <button\n              className=\"btn btn-sm  btn-outline-primary\"\n              type=\"button\"\n              style={{\n                float: \"right\",\n                zIndex: \"101\",\n              }}\n              onClick={() => dispatch(setShowSideBar(false))}\n              data-toggle=\"tooltip\"\n              data-placement=\"right\"\n              title=\"Hide sidebar\"\n            >\n              <i className=\"fa fa-chevron-left\" aria-hidden=\"true\" />\n            </button>\n          </h4>\n\n          <div style={{ padding: \"0px\" }}>\n            <form>\n              {widgets}\n\n              {addSpaceInsteadTitle && <div style={{ padding: \"15px\" }}></div>}\n\n              <div className=\"form-group mb-3 pb-1 pt-2\">\n                {!continuousUpdate && (\n                  <RunButton\n                    runNb={execNb}\n                    waiting={waiting}\n                    workerState={workerState}\n                  />\n                )}\n              </div>\n\n              {workerState === WorkerState.UsageLimitReached && (\n                <div className=\"alert alert-info mb-3 mt-3\" role=\"alert\">\n                  <i className=\"fa fa-info-circle\" aria-hidden=\"true\"></i> Usage\n                  limit was reached. Please upgrade the plan.\n                </div>\n              )}\n\n              {workerState === WorkerState.MaxIdleTimeReached && (\n                <div className=\"alert alert-info mb-3 mt-3\" role=\"alert\">\n                  <i className=\"fa fa-info-circle\" aria-hidden=\"true\"></i> Your\n                  worker was idle for too long, that's why we have stopped it.\n                  Do you need a worker?\n                  <br />\n                  <button\n                    className=\"btn btn-sm btn-primary my-2\"\n                    onClick={() => window.location.reload()}\n                  >\n                    Restart worker\n                  </button>\n                </div>\n              )}\n              {workerState === WorkerState.MaxRunTimeReached && (\n                <div className=\"alert alert-info mb-3 mt-3\" role=\"alert\">\n                  <i className=\"fa fa-info-circle\" aria-hidden=\"true\"></i> Your\n                  worker was running for too long, that's why we have stopped\n                  it. Do you need a worker?\n                  <br />\n                  <button\n                    className=\"btn btn-sm btn-primary my-2\"\n                    onClick={() => window.location.reload()}\n                  >\n                    Restart worker\n                  </button>\n                </div>\n              )}\n              {waiting &&\n                (workerState === WorkerState.Unknown ||\n                  workerState === WorkerState.Queued) && (\n                  <div className=\"alert alert-warning mb-3 mt-3\" role=\"alert\">\n                    <i className=\"fa fa-cogs\" aria-hidden=\"true\"></i> Waiting\n                    for worker ...\n                  </div>\n                )}\n              {waiting && workerState === WorkerState.Starting && (\n                <div className=\"alert alert-success mb-3 mt-3\" role=\"alert\">\n                  <i className=\"fa fa-cogs\" aria-hidden=\"true\"></i> Initializing\n                  worker ...\n                </div>\n              )}\n              {watchMode && (\n                <div className=\"alert alert-secondary mb-3 mt-3\" role=\"alert\">\n                  <i className=\"fa fa-refresh\" aria-hidden=\"true\"></i> Notebook\n                  in watch mode. All changes to Notebook will be automatically\n                  visible in Mercury.\n                </div>\n              )}\n\n              {isPresentation && (\n                <div className=\"alert alert-primary mb-3\" role=\"alert\">\n                  <i className=\"fa fa-television\" aria-hidden=\"true\"></i> Click\n                  on presentation and press <b>F</b> for full screen. Press{\" \"}\n                  <b>Esc</b> to quit.\n                  <br />\n                  <br />\n                  <i className=\"fa fa-arrows\" aria-hidden=\"true\"></i> Click on\n                  presentation and press <b>Esc</b> to navigate slides.\n                </div>\n              )}\n\n              {/* {notebookParseErrors && (\n                <div className=\"alert alert-danger mb-3\" role=\"alert\">\n                  <i\n                    className=\"fa fa-exclamation-circle\"\n                    aria-hidden=\"true\"\n                  ></i>{\" \"}\n                  <b>Errors in the YAML</b>\n                  <br />\n                  {notebookParseErrors}\n                </div>\n              )} */}\n            </form>\n          </div>\n\n          {showFiles && (\n            <div>\n              <hr />\n              <button\n                className=\"btn btn-sm btn-outline-secondary\"\n                style={{\n                  border: \"none\",\n                  //fontWeight: 500,\n                }}\n                onClick={() => {\n                  dispatch(setView(\"app\"));\n                }}\n              >\n                <i className=\"fa fa-laptop\" aria-hidden=\"true\"></i> App\n              </button>\n\n              <button\n                className=\"btn btn-sm btn-outline-secondary\"\n                style={{\n                  border: \"none\",\n                  //fontWeight: 500,\n                }}\n                onClick={() => {\n                  dispatch(setView(\"files\"));\n                }}\n              >\n                <i className=\"fa fa-folder-open-o\" aria-hidden=\"true\"></i>{\" \"}\n                Output Files\n              </button>\n            </div>\n          )}\n\n          <div>\n            <hr />\n            <div style={{ paddingLeft: \"10px\" }}>\n              <WebSocketStateBar\n                notebookId={notebookId}\n                notebookPath={notebookPath}\n                notebookTitle={notebookTitle}\n                staticNotebook={staticNotebook}\n                allowDownload={allowDownload}\n                allowShare={allowShare}\n                waiting={waiting}\n                continuousUpdate={continuousUpdate}\n                runDownloadHTML={runDownloadHTML}\n                runDownloadPDF={runDownloadPDF}\n              />{\" \"}\n            </div>\n          </div>\n        </div>\n      </BlockUi>\n    </nav>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useEffect } from \"react\";\nimport axios from \"axios\";\nimport useWindowDimensions from \"./WindowDimensions\";\n\nimport BlockUi from \"react-block-ui\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getNotebookSrc, setNotebookSrc } from \"../slices/wsSlice\";\n\nimport InnerHTML from \"dangerously-set-html-content\";\nimport { getSelectedNotebook } from \"../slices/notebooksSlice\";\nimport { Link } from \"react-router-dom\";\n\ntype MainViewProps = {\n  appView: string;\n  loadingState: string;\n  notebookPath: string;\n  waiting: boolean;\n  errorMsg: string;\n  watchMode: boolean;\n  displayEmbed: boolean;\n  username: string;\n  slidesHash: string;\n  columnsWidth: number;\n  isPresentation: boolean;\n  fullScreen: boolean;\n};\n\nexport default function MainView({\n  appView,\n  loadingState,\n  notebookPath,\n  waiting,\n  errorMsg,\n  watchMode,\n  displayEmbed,\n  username,\n  slidesHash,\n  columnsWidth,\n  isPresentation,\n  fullScreen,\n}: MainViewProps) {\n  const { height } = useWindowDimensions();\n\n  const iframeHeight = displayEmbed ? height - 10 : height - 58;\n  const dispatch = useDispatch();\n  let nb = useSelector(getSelectedNotebook);\n  let notebookSrc = useSelector(getNotebookSrc);\n\n  let showCode = false;\n  if (nb !== undefined && nb.params !== undefined) {\n    if (\n      nb.params[\"show-code\"] !== undefined &&\n      nb.params[\"show-code\"] !== null\n    ) {\n      showCode = nb.params[\"show-code\"];\n    }\n  }\n\n  if (notebookSrc !== \"\" && !isPresentation) {\n    notebookSrc = \"<script>init_mathjax();</script>\" + notebookSrc;\n\n    if (!showCode) {\n      const hideCodeStyle = `<style type=\"text/css\">\n      .jp-mod-noOutputs {\n          padding: 0px; \n      }\n      .jp-mod-noInput {\n        padding-top: 0px;\n        padding-bottom: 0px;\n      }\n      </style>`;\n      notebookSrc = hideCodeStyle + notebookSrc;\n    }\n  }\n\n  if (notebookSrc !== \"\" && isPresentation && slidesHash !== \"\") {\n    if (notebookSrc.indexOf(\"Reveal.slide(\") === -1) {\n      const splitted = slidesHash.split(\"/\");\n      let injectCode = \"\";\n      if (splitted.length === 4) {\n        injectCode = `Reveal.slide(${splitted[1]}, ${splitted[2]}, ${splitted[3]});`;\n      } else if (splitted.length === 3) {\n        injectCode = `Reveal.slide(${splitted[1]}, ${splitted[2]});`;\n      } else if (splitted.length === 2) {\n        injectCode = `Reveal.slide(${splitted[1]});`;\n      }\n\n      if (injectCode !== \"\") {\n        notebookSrc = notebookSrc.replace(\n          \"setScrollingSlide);\",\n          `setScrollingSlide); Reveal.on( 'ready', event => { try{ Reveal.configure({transition: \"none\"}); ${injectCode} Reveal.configure({transition: \"slide\"}); } catch(error) {} } );`\n        );\n      }\n    }\n  }\n\n  useEffect(() => {\n    if (notebookPath !== undefined && notebookSrc === \"\") {\n      let nbPath = notebookPath;\n\n      if (window.location.origin === \"http://localhost:3000\") {\n        if (nbPath.startsWith(\"/media\")) {\n          nbPath = \"http://127.0.0.1:8000\" + nbPath;\n        }\n      }\n      if (window.location.origin.startsWith(\"https\")) {\n        nbPath = nbPath.replace(\"http://\", \"https://\");\n      }\n\n      let token = axios.defaults.headers.common[\"Authorization\"];\n      if (nbPath.includes(\"s3.amazonaws.com\")) {\n        // we cant do requests to s3 with auth token\n        // we need to remove auth token before request\n        delete axios.defaults.headers.common[\"Authorization\"];\n      }\n      axios.get(`${nbPath}${slidesHash}`).then((response) => {\n        let nbSrc = response.data;\n        if (!isPresentation) {\n          nbSrc = nbSrc.replace(/<head>[\\s\\S]*?<\\/head>/, \"\");\n          nbSrc = nbSrc.replace(\"<html>\", \"\");\n          nbSrc = nbSrc.replace(\"</html>\", \"\");\n          nbSrc = nbSrc.replace(\"<body\", \"<div\");\n          nbSrc = nbSrc.replace(\"</body>\", \"</div>\");\n          nbSrc = nbSrc.replace(\"<!DOCTYPE html>\", \"\");\n        }\n        dispatch(setNotebookSrc(nbSrc));\n      });\n      if (nbPath.includes(\"s3.amazonaws.com\")) {\n        // after request we set token back\n        axios.defaults.headers.common[\"Authorization\"] = token;\n      }\n    }\n  }, [dispatch, notebookPath, slidesHash, isPresentation, notebookSrc]);\n\n  let mainStyle = {\n    paddingTop: \"0px\",\n    paddingRight: \"0px\",\n    paddingLeft: fullScreen ? \"12px\" : \"0px\",\n    display: appView === \"files\" ? \"none\" : \"block\",\n  };\n\n  let divStyle = {};\n  if (!fullScreen) {\n    divStyle = { maxWidth: \"1140px\", margin: \"auto\" };\n  }\n\n  // hide blocking for small screens when sidebar is only showed\n  // because it causes some strange shadow\n  // see https://github.com/mljar/mercury/issues/250\n  let hideBlockUi = false;\n  if (columnsWidth < 12 && window.innerWidth < 992) {\n    hideBlockUi = true;\n  }\n\n  return (\n    <main className={`ms-sm-auto col-${columnsWidth}`} style={mainStyle}>\n      <BlockUi tag=\"div\" blocking={!hideBlockUi && waiting}>\n        <div style={divStyle}>\n          {loadingState === \"loading\" && !watchMode && (\n            <p>Loading notebook. Please wait ...</p>\n          )}\n          {loadingState === \"error\" && (\n            <p style={{ margin: \"20px\" }}>\n              Problem while loading notebook. Please try again later or contact\n              Mercury administrator.\n            </p>\n          )}\n\n          {loadingState === \"error\" && username === \"\" && (\n            <p style={{ margin: \"20px\" }}>\n              <h5>Please log in to see the notebook</h5>\n              <Link to=\"/login\" className=\"btn btn-primary btn-sm\" reloadDocument>\n                <i className=\"fa fa-sign-in\" aria-hidden=\"true\"></i> Log in\n              </Link>\n            </p>\n          )}\n\n          {errorMsg && (\n            <div className=\"alert alert-danger mb-3\" role=\"alert\">\n              <b>Notebook is executed with errors.</b>\n              <p>{errorMsg}</p>\n            </div>\n          )}\n\n          {errorMsg === \"\" &&\n            loadingState !== \"loading\" &&\n            isPresentation &&\n            notebookSrc !== \"\" && (\n              <iframe\n                width=\"100%\"\n                height={iframeHeight}\n                key={notebookPath}\n                srcDoc={notebookSrc}\n                title=\"display\"\n                id=\"main-iframe\"\n                onError={() => {\n                  console.log(\"iframe error\");\n                }}\n              ></iframe>\n            )}\n\n          {notebookSrc !== \"\" && !isPresentation && (\n            <InnerHTML html={notebookSrc} />\n          )}\n        </div>\n      </BlockUi>\n      \n    </main>\n  );\n}\n","import axios from \"axios\";\nimport fileDownload from \"js-file-download\";\n\ntype Props = {\n  fname: string;\n  downloadLink: string;\n  firstItem: boolean;\n  lastItem: boolean;\n};\n\nexport default function FileItem({\n  fname,\n  downloadLink,\n  firstItem,\n  lastItem,\n}: Props) {\n  const handleDownload = (url: string, filename: string) => {\n    let token = axios.defaults.headers.common[\"Authorization\"];\n\n    if (url.includes(\"s3.amazonaws.com\")) {\n      // we cant do requests to s3 with auth token\n      // we need to remove auth token before request\n      delete axios.defaults.headers.common[\"Authorization\"];\n    }\n\n    axios\n      .get(url, {\n        responseType: \"blob\",\n      })\n      .then((res) => {\n        fileDownload(res.data, filename);\n      });\n\n    if (url.includes(\"s3.amazonaws.com\")) {\n      // after request we set token back\n      axios.defaults.headers.common[\"Authorization\"] = token;\n    }\n  };\n\n  return (\n    <div\n      style={{\n        border: \"1px solid #ddd\",\n        marginBottom: \"-1px\",\n        padding: \"13px\",\n        borderTopRightRadius: firstItem ? \"7px\" : \"0px\",\n        borderTopLeftRadius: firstItem ? \"7px\" : \"0px\",\n        borderBottomRightRadius: lastItem ? \"7px\" : \"0px\",\n        borderBottomLeftRadius: lastItem ? \"7px\" : \"0px\",\n      }}\n    >\n      <i\n        className=\"fa fa-file-text-o\"\n        aria-hidden=\"true\"\n        style={{ paddingRight: \"5px\" }}\n      ></i>{\" \"}\n      {fname}\n      <div style={{ float: \"right\", margin: \"-4px\" }}>\n        <button\n          style={{ float: \"right\" }}\n          type=\"button\"\n          className=\"btn btn-outline-primary btn-sm\"\n          onClick={() => handleDownload(downloadLink, fname!)}\n        >\n          <i className=\"fa fa-download\" aria-hidden=\"true\"></i> Download\n        </button>\n      </div>\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport axios from \"axios\";\nimport BlockUi from \"react-block-ui\";\nimport { setView } from \"../slices/appSlice\";\nimport FileItem from \"./FileItem\";\n\ntype FilesViewProps = {\n  files: string[];\n  filesState: string;\n  waiting: boolean;\n};\n\nexport default function FilesView({\n  files,\n  filesState,\n  waiting,\n}: FilesViewProps) {\n  const dispatch = useDispatch();\n\n  let filesLinks = [];\n\n  let myFiles = [...files]; \n  \n  myFiles.sort();\n\n  for (let f of myFiles) {\n    let fname = f.split(\"/\").pop();\n    fname = fname?.split(\"?\")[0];\n\n    if (f && fname) {\n      let downloadLink = `${axios.defaults.baseURL}${f}`;\n      if (f.includes(\"s3.amazonaws.com\")) {\n        downloadLink = f;\n      }\n      filesLinks.push(\n        <FileItem\n          fname={fname}\n          downloadLink={downloadLink}\n          firstItem={f === files[0]}\n          lastItem={f === files[files.length - 1]}\n        />\n      );\n    }\n  }\n\n  return (\n    <main className=\"col-md-9 ms-sm-auto col-lg-9\" style={{ padding: \"20px\" }}>\n      <div className=\"col-12\" style={{ maxWidth: \"900px\" }}>\n        <h3 style={{ paddingBottom: \"10px\" }}>\n          <i className=\"fa fa-folder-open-o\" aria-hidden=\"true\"></i> Output\n          Files\n        </h3>\n        <BlockUi tag=\"div\" blocking={waiting}>\n          <div>\n            {filesState === \"loaded\" && filesLinks}\n            {filesState === \"loaded\" && filesLinks.length === 0 && (\n              <div>No files available for download</div>\n            )}\n            {filesState === \"unknown\" && (\n              <p>Please run the notebook to produce output files ...</p>\n            )}\n            {filesState === \"loading\" && <p>Loading files please wait ...</p>}\n            {filesState === \"error\" && (\n              <div className=\"alert alert-danger mb-3\" role=\"alert\">\n                There was an error during loading files. Please try to run the\n                app again or contact the administrator.\n              </div>\n            )}\n          </div>\n        </BlockUi>\n      </div>\n\n      <button\n        className=\"btn btn-secondary btn-sm\"\n        style={{ marginTop: \"20px\" }}\n        onClick={() => {\n          dispatch(setView(\"app\"));\n        }}\n      >\n        <i className=\"fa fa-arrow-left\" aria-hidden=\"true\"></i> Back to App\n      </button>\n    </main>\n  );\n}\n","import React from \"react\";\n\nexport default function MadeWithDiv() {\n  return (\n    <a href=\"https://runmercury.com\" target=\"_blank\" rel=\"noreferrer\">\n      <div className=\"poweredby\">\n        <div className=\"text-center\">\n          {\" \"}\n          <b style={{ fontSize: \"0.9em\" }}>created with</b>{\" \"}\n        </div>\n        <div>\n          <img\n            alt=\"Mercury\"\n            src={\n              process.env.PUBLIC_URL +\n              process.env.REACT_APP_LOCAL_URL +\n              \"/mercury_black_logo.svg\"\n            }\n            style={{ height: \"27px\" }}\n          />\n        </div>\n      </div>\n    </a>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { IWidget } from \"../widgets/Types\";\nimport { useSelector } from \"react-redux\";\nimport { getWidgetsValues } from \"../slices/notebooksSlice\";\n\ntype Props = {\n  slug: string;\n  widgetsParams: Record<string, IWidget>;  \n  notebookPath: string;\n  columnsWidth: number;\n  taskSessionId: string | undefined;\n};\n\nexport default function RestAPIView({\n  slug,\n  widgetsParams,\n  notebookPath,\n  columnsWidth,\n  taskSessionId,\n}: Props) {\n  const [response, setResponse] = useState(\n    JSON.stringify({ msg: \"Example output\" })\n  );\n  const widgetsValues = useSelector(getWidgetsValues);\n\n  let examplePostData = {} as Record<\n    string,\n    | string\n    | number\n    | null\n    | undefined\n    | boolean\n    | [number, number]\n    | string[]\n    | unknown\n  >;\n  for (let [key, widgetParams] of Object.entries(widgetsParams)) {\n    if (widgetParams.input) {\n      examplePostData[key] = widgetsValues[key];\n    }\n  }\n\n  async function fetchResponse() {\n    try {\n      const { data } = await axios.get(`get/${taskSessionId}`);\n      setResponse(JSON.stringify(data));\n    } catch (error) {}\n  }\n\n  useEffect(() => {\n    if (taskSessionId) {\n      fetchResponse();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [taskSessionId, notebookPath]);\n\n  let sessionId = \"id-with-some-random-string\";\n  if (taskSessionId) {\n    sessionId = taskSessionId;\n  }\n\n  let postRequest = `curl -X POST -H \"Content-Type: application/json\" -d '${JSON.stringify(\n    examplePostData\n  )}' ${axios.defaults.baseURL}/run/${slug}`;\n  return (\n    <div\n      className={`ms-sm-auto col-lg-${columnsWidth}`}\n      style={{\n        border: \"none\",\n        paddingTop: \"0px\",\n        paddingRight: \"0px\",\n        paddingLeft: \"0px\",\n        padding: \"10px\",\n      }}\n    >\n      <h4>Notebook as REST API</h4>\n      <p>\n        This notebook can be executed as REST API. Please see the examples below\n        on how to access the notebook.\n      </p>\n\n      <div className=\"alert alert-secondary\" role=\"alert\">\n        <h5>POST request to execute the notebook</h5>\n        <textarea\n          disabled\n          style={{ width: \"100%\" }}\n          rows={3}\n          value={postRequest}\n        ></textarea>\n        The above request should return a JSON with `id`. The `id` should be\n        used in the GET request to fetch the result.\n        <br />\n        Example response:\n        <pre>{`{\"id\": \"${sessionId}\"}`}</pre>\n      </div>\n      <div className=\"alert alert-secondary\" role=\"alert\">\n        <h5>GET request to get execution result in JSON</h5>\n        <textarea\n          disabled\n          style={{ width: \"100%\" }}\n          rows={1}\n          value={`curl ${axios.defaults.baseURL}/get/${sessionId}`}\n        ></textarea>\n      </div>\n\n      <div className=\"alert alert-primary\" role=\"alert\">\n        <h5>Response</h5>\n        <pre>{response}</pre>\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { toast } from \"react-toastify\";\nimport { getExportingToPDF, getExportToPDFCounter, getExportToPDFJobId, getPDF, stopPDFExport } from \"../slices/tasksSlice\";\n\nexport default function WaitPDFExport() {\n  const dispatch = useDispatch();\n  const counter = useSelector(getExportToPDFCounter);\n  const jobId = useSelector(getExportToPDFJobId);\n  const exportingPDF = useSelector(getExportingToPDF);\n\n  useEffect(() => {\n    if(jobId === '') {\n      return;\n    } \n    if(!exportingPDF) {\n      return;\n    }\n    // raise error after 2 minutes of waiting ...\n    if (counter < 120) {\n      setTimeout(() => {\n        dispatch(getPDF(jobId));\n      }, 1000); // every 1 second\n    } else {\n      dispatch(stopPDFExport());\n      toast.error(\"Problem with PDF export. Please try again later or ask your admin for help.\", { autoClose: 6000 })\n    }\n  }, [dispatch, counter, jobId, exportingPDF]);\n\n  return <div></div>;\n}\n","import React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  isCheckboxWidget,\n  isNumericWidget,\n  isRangeWidget,\n  isSelectWidget,\n  isSliderWidget,\n  isTextWidget,\n  IWidget,\n} from \"../widgets/Types\";\nimport { getWidgetsValues, WidgetValueType } from \"../slices/notebooksSlice\";\nimport { getShowShareDialog, setShowShareDialog } from \"../slices/appSlice\";\n\ntype Props = {\n  //widgetsValues: Record<string, WidgetValueType>;\n  widgetsParams: Record<string, IWidget>;\n};\n\nexport default function ShareDialog({\n  //widgetsValues,\n  widgetsParams,\n}: Props) {\n  const dispatch = useDispatch();\n  const showShareDialog = useSelector(getShowShareDialog);\n  const widgetsValues: Record<string, WidgetValueType> = useSelector(\n    getWidgetsValues\n  ) as Record<string, WidgetValueType>;\n\n  let noUrlKeys = true;\n  let urlParams = \"?\";\n  if (\n    widgetsParams !== undefined &&\n    widgetsParams !== null &&\n    widgetsValues !== undefined &&\n    widgetsValues !== null\n  ) {\n    for (let [key, widgetParams] of Object.entries(widgetsParams)) {\n      if (widgetsValues[key] === undefined) {\n        continue;\n      }\n\n      if (\n        isCheckboxWidget(widgetParams) ||\n        isNumericWidget(widgetParams) ||\n        isRangeWidget(widgetParams) ||\n        isSelectWidget(widgetParams) ||\n        isSliderWidget(widgetParams) ||\n        isTextWidget(widgetParams)\n      ) {\n        if (widgetParams?.url_key !== null && widgetParams?.url_key !== \"\") {\n          noUrlKeys = false;\n        }\n      }\n\n      if (\n        isCheckboxWidget(widgetParams) ||\n        isNumericWidget(widgetParams) ||\n        isSliderWidget(widgetParams) ||\n        isTextWidget(widgetParams)\n      ) {\n        if (widgetParams?.url_key !== null && widgetParams?.url_key !== \"\") {\n          urlParams += `${widgetParams?.url_key}=${widgetsValues[key]}&`;\n        }\n      }\n\n      if (isRangeWidget(widgetParams)) {\n        if (widgetParams?.url_key !== null && widgetParams?.url_key !== \"\") {\n          const v = widgetsValues[key] as [number, number];\n\n          urlParams += `${widgetParams?.url_key}=${v[0]},${v[1]}&`;\n        }\n      }\n      if (isSelectWidget(widgetParams)) {\n        if (widgetParams?.url_key !== null && widgetParams?.url_key !== \"\") {\n          if (widgetParams?.multi) {\n            const v = widgetsValues[key] as string[];\n\n            urlParams += `${widgetParams?.url_key}=${v.join(\",\")}&`;\n          } else {\n            const v = widgetsValues[key] as string;\n            urlParams += `${widgetParams?.url_key}=${v}&`;\n          }\n        }\n      }\n    }\n    if (urlParams !== \"?\") {\n      urlParams = urlParams.slice(0, urlParams.length - 1);\n    }\n  }\n\n  return (\n    <div\n      className=\"\"\n      style={{\n        position: \"fixed\",\n        top: \"0\",\n        left: \"0\",\n        width: \"100%\",\n        height: \"100%\",\n        background: \"rgba(0, 0, 0, 0.6)\",\n        display: showShareDialog ? \"block\" : \"none\",\n        zIndex: 100\n      }}\n    >\n      <section\n        className=\"\"\n        style={{\n          position: \"fixed\",\n          width: \"100%\",\n          height: \"auto\",\n          top: \"50%\",\n          left: \"50%\",\n          transform: \"translate(-50%,-50%)\",\n        }}\n      >\n        <div className=\"modal-dialog\">\n          <div className=\"modal-content\">\n            <div className=\"modal-header\">\n              <h3 className=\"modal-title\">\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  width=\"24\"\n                  height=\"24\"\n                  viewBox=\"0 0 24 24\"\n                  strokeWidth=\"2\"\n                  stroke=\"currentColor\"\n                  fill=\"none\"\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                >\n                  <path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path>\n                  <path d=\"M6 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0\"></path>\n                  <path d=\"M18 6m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0\"></path>\n                  <path d=\"M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0\"></path>\n                  <path d=\"M8.7 10.7l6.6 -3.4\"></path>\n                  <path d=\"M8.7 13.3l6.6 3.4\"></path>\n                </svg>{\" \"}\n                Share\n              </h3>\n              <button\n                type=\"button\"\n                className=\"btn-close\"\n                aria-label=\"Close\"\n                onClick={() => dispatch(setShowShareDialog(false))}\n              ></button>\n            </div>\n            <div className=\"modal-body\">\n              <div className=\"py-2\">\n                <label>App address</label>\n                <input\n                  type=\"text\"\n                  className=\"form-control\"\n                  disabled={true}\n                  value={window.location.origin + window.location.pathname}\n                ></input>\n              </div>\n\n              {!noUrlKeys && (\n                <div className=\"py-2\">\n                  <label>App address with current paramters</label>\n                  <textarea\n                    rows={5}\n                    className=\"form-control\"\n                    disabled={true}\n                    value={window.location.origin + window.location.pathname + urlParams}\n                  />\n                </div>\n              )}\n              {noUrlKeys && (\n                <div className=\"py-2\">\n                  There are no <code>url_key</code> defined for any widget. You\n                  can easily share URL to your notebook with preset values by\n                  using <code>url_key</code> in the widget. Please check{\" \"}\n                  <a\n                    href=\"https://runmercury.com/docs/input-widgets/\"\n                    target=\"_blank\"\n                    rel=\"noreferrer\"\n                  >\n                    documentation\n                  </a>\n                  .\n                </div>\n              )}\n              <div className=\"py-2\"></div>\n            </div>\n            <div className=\"modal-footer\">\n              <button\n                type=\"button\"\n                className=\"btn btn-secondary\"\n                onClick={() => dispatch(setShowShareDialog(false))}\n              >\n                Close\n              </button>\n            </div>\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n}\n","export default process.env.PUBLIC_URL +\n  process.env.REACT_APP_LOCAL_URL +\n  \"/mercury_logo.svg\";\n","import React, { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport \"./App.css\";\nimport NavBar from \"../components/NavBar\";\nimport SideBar from \"../components/SideBar\";\nimport MainView from \"../components/MainView\";\n\nimport {\n  fetchNotebookWithSlug,\n  getLoadingStateSelected,\n  getSelectedNotebook,\n  getSlidesHash,\n  // getWatchModeCounter,\n} from \"../slices/notebooksSlice\";\nimport {\n  //fetchCurrentTask,\n  //fetchExecutionHistory,\n  getCurrentTask,\n  getExportingToPDF,\n  getHistoricTask,\n  getPreviousTask,\n  //ITask,\n  //setPreviousTask,\n} from \"../slices/tasksSlice\";\nimport { isOutputFilesWidget, IWidget } from \"../widgets/Types\";\nimport {\n  fetchWorkerOutputFiles,\n  getOutputFiles,\n  getOutputFilesState,\n  getShowSideBar,\n  getView,\n  setShowSideBar,\n} from \"../slices/appSlice\";\nimport FilesView from \"../components/FilesView\";\nimport { getToken, getUsername } from \"../slices/authSlice\";\nimport MadeWithDiv from \"../components/MadeWithDiv\";\nimport RestAPIView from \"../components/RestAPIView\";\nimport BlockUi from \"react-block-ui\";\nimport WaitPDFExport from \"../components/WaitPDFExport\";\nimport { getWorkerId, getWorkerState, WorkerState } from \"../slices/wsSlice\";\nimport {\n  getLogoFilename,\n  getNavbarColor,\n  getSiteId,\n  isPublic,\n} from \"../slices/sitesSlice\";\nimport ShareDialog from \"../components/ShareDialog\";\nimport axios from \"axios\";\nimport DefaultLogoSrc from \"../components/DefaultLogo\";\n\ntype AppProps = {\n  isSingleApp: boolean;\n  notebookSlug: string;\n  displayEmbed: boolean;\n};\n\nfunction App({ isSingleApp, notebookSlug, displayEmbed }: AppProps) {\n  const dispatch = useDispatch();\n  const notebook = useSelector(getSelectedNotebook);\n  const loadingState = useSelector(getLoadingStateSelected);\n  const task = useSelector(getCurrentTask);\n  const historicTask = useSelector(getHistoricTask);\n  const previousTask = useSelector(getPreviousTask);\n  const appView = useSelector(getView);\n  const outputFiles = useSelector(getOutputFiles);\n  const outputFilesState = useSelector(getOutputFilesState);\n  const username = useSelector(getUsername);\n  const token = useSelector(getToken);\n  const slidesHash = useSelector(getSlidesHash);\n  const showSideBar = useSelector(getShowSideBar);\n  const exportingToPDF = useSelector(getExportingToPDF);\n  const workerId = useSelector(getWorkerId);\n  const workerState = useSelector(getWorkerState);\n  const siteId = useSelector(getSiteId);\n  const isSitePublic = useSelector(isPublic);\n  const navbarColor = useSelector(getNavbarColor);\n  const [logoSrc, setLogoSrc] = useState(\"loading\");\n  const logoFilename = useSelector(getLogoFilename);\n\n  const pleaseWait = () => {\n    if (notebook?.params?.static_notebook) {\n      return false;\n    }\n    if (\n      workerState === WorkerState.UsageLimitReached ||\n      workerState === WorkerState.MaxIdleTimeReached ||\n      workerState === WorkerState.MaxRunTimeReached\n    ) {\n      return false;\n    }\n    return workerState !== WorkerState.Running;\n  };\n\n  const isWatchMode = () => {\n    return (\n      notebook.state === \"WATCH_READY\" ||\n      notebook.state === \"WATCH_WAIT\" ||\n      notebook.state === \"WATCH_ERROR\"\n    );\n  };\n\n  useEffect(() => {\n    if (siteId !== undefined) {\n      dispatch(fetchNotebookWithSlug(siteId, notebookSlug));\n    }\n  }, [dispatch, siteId, notebookSlug, token]);\n\n  useEffect(() => {\n    if (\n      appView === \"files\" &&\n      notebook?.params?.version === \"2\" &&\n      workerId !== undefined &&\n      notebook.id !== undefined\n    ) {\n      dispatch(fetchWorkerOutputFiles(workerId, notebook.id));\n    }\n  }, [dispatch, appView, notebook, workerId]);\n\n  let notebookPath = notebook.default_view_path;\n  if (task.state && task.state === \"DONE\" && task.result) {\n    notebookPath = task.result;\n  }\n  let errorMsg = \"\";\n  if (task.state && task.result && task.state === \"ERROR\") {\n    errorMsg = task.result;\n  }\n\n  // set historic task to display if available\n  if (\n    historicTask.state &&\n    historicTask.state === \"DONE\" &&\n    historicTask.result\n  ) {\n    notebookPath = historicTask.result;\n  }\n  if (\n    historicTask.state &&\n    historicTask.result &&\n    historicTask.state === \"ERROR\"\n  ) {\n    errorMsg = historicTask.result;\n  }\n\n  // if we have previous task to show, just show it\n  if (\n    notebookPath === notebook.default_view_path &&\n    previousTask.state &&\n    previousTask.state === \"DONE\" &&\n    previousTask.result\n  ) {\n    notebookPath = previousTask.result;\n  }\n\n  const areOutputFilesAvailable = (\n    widgetsParams: Record<string, IWidget>\n  ): boolean => {\n    if (widgetsParams) {\n      for (let [, widgetParams] of Object.entries(widgetsParams)) {\n        if (isOutputFilesWidget(widgetParams)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  };\n\n  let showRestApi = false;\n  if (notebook.output && notebook.output.toLowerCase().startsWith(\"rest\")) {\n    showRestApi = true;\n  }\n\n  const isFullScreen = () => {\n    if (notebook !== undefined && notebook !== null) {\n      return notebook?.params?.full_screen !== undefined &&\n        notebook?.params?.full_screen !== null\n        ? notebook.params.full_screen\n        : true;\n    }\n    return true;\n  };\n\n  const doAllowDownload = () => {\n    if (notebook !== undefined && notebook !== null) {\n      return notebook?.params?.allow_download !== undefined &&\n        notebook?.params?.allow_download !== null\n        ? notebook.params.allow_download\n        : true;\n    }\n    return true;\n  };\n\n  const doAllowShare = () => {\n    if (notebook !== undefined && notebook !== null) {\n      return notebook?.params?.allow_share !== undefined &&\n        notebook?.params?.allow_share !== null\n        ? notebook.params.allow_share\n        : true;\n    }\n    return true;\n  }\n\n  useEffect(() => {\n    if (logoFilename === \"\") {\n      setLogoSrc(DefaultLogoSrc);\n    } else {\n      axios\n        .get(`/api/v1/get-style/${siteId}/${logoFilename}`)\n        .then((response) => {\n          const { url } = response.data;\n          setLogoSrc(url);\n        });\n    }\n  }, [dispatch, logoFilename, siteId]);\n\n  return (\n    <div className=\"App\">\n      {!displayEmbed && (\n        <NavBar\n          isSitePublic={isSitePublic}\n          username={username}\n          logoSrc={logoSrc}\n          navbarColor={navbarColor}\n        />\n      )}\n      <BlockUi\n        blocking={exportingToPDF}\n        message=\"Exporting to PDF. Please wait ...\"\n      >\n        {exportingToPDF && <WaitPDFExport />}\n        <div className=\"container-fluid\">\n          <div className=\"row\">\n            {/* {notebook.schedule !== undefined && notebook.schedule !== \"\" && (\n              <AutoRefresh notebookId={notebookId} />\n            )} */}\n\n            {showSideBar && (\n              <SideBar\n                notebookTitle={notebook.title}\n                notebookId={notebook.id}\n                notebookSchedule={notebook.schedule}\n                taskCreatedAt={task.created_at}\n                loadingState={loadingState}\n                waiting={pleaseWait()}\n                widgetsParams={notebook?.params?.params}\n                watchMode={isWatchMode()}\n                notebookPath={notebookPath}\n                displayEmbed={displayEmbed}\n                showFiles={areOutputFilesAvailable(notebook?.params?.params)}\n                isPresentation={\n                  notebook.output !== undefined && notebook.output === \"slides\"\n                }\n                notebookParseErrors={notebook.errors}\n                continuousUpdate={notebook?.params?.continuous_update}\n                staticNotebook={notebook?.params?.static_notebook}\n                allowDownload={doAllowDownload()}\n                allowShare={doAllowShare()}\n              />\n            )}\n\n            {!showSideBar && (\n              <div>\n                <button\n                  className=\"btn btn-sm  btn-outline-primary\"\n                  type=\"button\"\n                  style={{\n                    position: \"absolute\",\n                    top: displayEmbed ? \"5px\" : \"50px\",\n                    left: \"5px\",\n                    zIndex: \"2000\",\n                  }}\n                  onClick={() => dispatch(setShowSideBar(true))}\n                  data-toggle=\"tooltip\"\n                  data-placement=\"right\"\n                  title=\"Show sidebar\"\n                >\n                  <i className=\"fa fa-chevron-right\" aria-hidden=\"true\" />\n                </button>\n              </div>\n            )}\n\n            {showRestApi && (\n              <RestAPIView\n                slug={notebook.slug}\n                widgetsParams={notebook?.params?.params}\n                notebookPath={notebookPath}\n                columnsWidth={showSideBar ? 9 : 12}\n                taskSessionId={task.session_id}\n              />\n            )}\n\n            <MainView\n              appView={appView}\n              loadingState={loadingState}\n              notebookPath={notebookPath}\n              errorMsg={errorMsg}\n              waiting={pleaseWait()}\n              watchMode={isWatchMode()}\n              displayEmbed={displayEmbed}\n              username={username}\n              slidesHash={slidesHash}\n              columnsWidth={showSideBar ? 9 : 12}\n              isPresentation={\n                notebook.output !== undefined && notebook.output === \"slides\"\n              }\n              fullScreen={isFullScreen()}\n            />\n\n            {appView === \"files\" && (\n              <FilesView\n                files={outputFiles}\n                filesState={outputFilesState}\n                waiting={pleaseWait()}\n              />\n            )}\n\n            <ShareDialog widgetsParams={notebook?.params?.params} />\n          </div>\n        </div>\n      </BlockUi>\n      {/* dont show created with logo for embedded notebooks when we are using custom logo */}\n      {displayEmbed && logoSrc === DefaultLogoSrc && <MadeWithDiv />}\n    </div>\n  );\n}\n\nconst AppView = App;\nexport default AppView;\n","import { useParams } from \"react-router-dom\";\nimport AppView from \"./AppView\";\n\nexport default function MyApp() {\n  const { slug } = useParams<{ slug: string }>();\n  const { embed } = useParams<{ embed: string }>();\n  const displayEmbed = !!(embed && embed === \"embed\");\n\n  return (\n    <AppView\n      isSingleApp={false}\n      notebookSlug={slug as string}\n      displayEmbed={displayEmbed}\n    />\n  );\n}\n","import React from \"react\";\n\ntype FooterProps = {\n  footerText: string;\n};\n\nexport default function Footer({ footerText }: FooterProps) {\n  return (\n    <footer\n      className=\"footer\"\n      style={{\n        position: \"absolute\",\n        bottom: \"0\",\n        width: \"100%\",\n        height: \"40px\",\n        lineHeight: \"40px\",\n        backgroundColor: \"#f5f5f5\",\n        borderTop: \"1px solid #e5e5e5\",\n      }}\n    >\n      {footerText === \"\" && (\n        <div className=\"container\" style={{ textAlign: \"center\"}}>\n          \n          <span className=\"text-muted\" style={{ color: \"gray\", float: \"left\" }}>\n            {\" \"}\n            <a\n              style={{ textDecoration: \"none\", color: \"gray\" }}\n              href=\"/openapi\"\n            >\n              OpenAPI\n            </a>\n          </span>\n\n          <span className=\"text-muted\" style={{ color: \"gray\", margin: \"auto\", display: \"inline-block\" }}>\n            {\" \"}\n            <a\n              style={{ textDecoration: \"none\", color: \"gray\" }}\n              href=\"https://runmercury.com\"\n              target=\"_blank\"\n              rel=\"noreferrer\"\n            >\n              Notebooks served as Web Apps with Mercury\n            </a>\n          </span>\n\n          <span className=\"text-muted\" style={{ float: \"right\" }}>\n            <a\n              style={{ textDecoration: \"none\", color: \"gray\" }}\n              href=\"https://github.com/mljar/mercury\"\n              target=\"_blank\"\n              rel=\"noreferrer\"\n            >\n              Mercury\n            </a>{\" \"}\n            <i className=\"fa fa-github\" aria-hidden=\"true\"></i>\n          </span>\n        </div>\n      )}\n      {footerText !== \"\" && (\n        <div\n          className=\"container\"\n          style={{ color: \"gray\", textAlign: \"center\" }}\n        >\n          <span className=\"text-muted\" style={{ color: \"gray\" }}>\n            {footerText}\n          </span>\n        </div>\n      )}\n    </footer>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport LoginButton from \"./LoginButton\";\nimport UserButton from \"./UserButton\";\n\ntype NavBarProps = {\n  isSitePublic: boolean;\n  username: string;\n  logoSrc: string;\n  navbarColor: string;\n};\n\nexport default function NavBar({\n  isSitePublic,\n  username,\n  logoSrc,\n  navbarColor,\n}: NavBarProps) {\n  let headerBgClass = \"\";\n  let headerStyle = {};\n  if (navbarColor === \"\") {\n    headerBgClass = \"bg-dark\";\n  } else {\n    headerStyle = {\n      backgroundColor: navbarColor,\n    };\n  }\n\n  return (\n    <header\n      className={`navbar navbar-dark sticky-top p-0 ${headerBgClass}`}\n      style={headerStyle}\n    >\n      <div className=\"row\" style={{ width: \"100%\", paddingRight: \"0px\" }}>\n        <div className=\"col-4\"></div>\n        <div className=\"col-4 text-center\">\n          {logoSrc !== \"\" && logoSrc !== \"loading\" && (\n            <Link to=\"/\">\n              <img alt=\"\" src={logoSrc} style={{ height: \"40px\" }} />\n            </Link>\n          )}\n          {logoSrc === \"loading\" && (\n            <Link to=\"/\">\n              <div style={{ height: \"40px\" }} />\n            </Link>\n          )}\n        </div>\n        <div\n          className=\"col-4\"\n          style={{ marginRight: \"0px\", paddingRight: \"0px\" }}\n        >\n          {!isSitePublic && username === \"\" && <LoginButton />}\n          {username !== \"\" && <UserButton username={username} />}\n        </div>\n      </div>\n    </header>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  changePassword,\n  fetchUserInfo,\n  getUserInfo,\n  getUsername,\n} from \"../slices/authSlice\";\nimport Footer from \"../components/Footer\";\nimport HomeNavBar from \"../components/HomeNavBar\";\nimport {\n  getFooterText,\n  getLogoFilename,\n  getNavbarColor,\n  getSiteId,\n  isPublic,\n} from \"../slices/sitesSlice\";\nimport axios from \"axios\";\n\nimport DefaultLogoSrc from \"../components/DefaultLogo\";\n\nexport default function AccountView() {\n  const dispatch = useDispatch();\n  const [oldPassword, setOldPassword] = useState(\"\");\n  const [newPassword1, setNewPassword1] = useState(\"\");\n  const [newPassword2, setNewPassword2] = useState(\"\");\n  const [logoSrc, setLogoSrc] = useState(\"loading\");\n\n  const username = useSelector(getUsername);\n  const user = useSelector(getUserInfo);\n  const isSitePublic = useSelector(isPublic);\n  const logoFilename = useSelector(getLogoFilename);\n  const siteId = useSelector(getSiteId);\n  const navbarColor = useSelector(getNavbarColor);\n  const footerText = useSelector(getFooterText);\n\n  document.body.style.backgroundColor = \"white\";\n\n  useEffect(() => {\n    dispatch(fetchUserInfo());\n  }, [dispatch]);\n\n  useEffect(() => {\n    if (siteId !== undefined) {\n      if (logoFilename === \"\") {\n        setLogoSrc(DefaultLogoSrc);\n      } else {\n        axios\n          .get(`/api/v1/get-style/${siteId}/${logoFilename}`)\n          .then((response) => {\n            const { url } = response.data;\n            setLogoSrc(url);\n          });\n      }\n    }\n  }, [dispatch, logoFilename, siteId]);\n\n  return (\n    <div className=\"App\">\n      <HomeNavBar\n        isSitePublic={isSitePublic}\n        username={username}\n        logoSrc={logoSrc}\n        navbarColor={navbarColor}\n      />\n\n      <div className=\"container\">\n        <div className=\"mx-auto\" style={{ width: \"700px\" }}>\n          <div className=\"row\" style={{ marginTop: \"40px\" }}>\n            <h2>\n              <i className=\"fa fa-user\" aria-hidden=\"true\"></i> Account\n            </h2>\n            <form>\n              <div className=\"mb-3\">\n                <label className=\"form-label\">Username</label>\n                <input\n                  className=\"form-control\"\n                  value={user.username}\n                  disabled\n                />\n              </div>\n              <div className=\"mb-3\">\n                <label className=\"form-label\">First name</label>\n                <input\n                  className=\"form-control\"\n                  value={user.first_name}\n                  disabled\n                />\n              </div>\n              <div className=\"mb-3\">\n                <label className=\"form-label\">Last name</label>\n                <input\n                  className=\"form-control\"\n                  value={user.last_name}\n                  disabled\n                />\n              </div>\n\n              <div className=\"mb-3\">\n                <label className=\"form-label\">Email address</label>\n                <input className=\"form-control\" value={user.email} disabled />\n              </div>\n            </form>\n          </div>\n          <hr />\n          <div className=\"row\">\n            <h2>\n              <i className=\"fa fa-key\" aria-hidden=\"true\"></i> Change password\n            </h2>\n            <div>\n              <div className=\"mb-3\">\n                <label className=\"form-label\">Old password</label>\n                <input\n                  type=\"password\"\n                  className=\"form-control\"\n                  value={oldPassword}\n                  onChange={(e) => setOldPassword(e.target.value)}\n                />\n              </div>\n              <div className=\"mb-3\">\n                <label className=\"form-label\">New password</label>\n                <input\n                  type=\"password\"\n                  className=\"form-control\"\n                  value={newPassword1}\n                  onChange={(e) => setNewPassword1(e.target.value)}\n                />\n              </div>\n              <div className=\"mb-3\">\n                <label className=\"form-label\">Repeat new password</label>\n                <input\n                  type=\"password\"\n                  className=\"form-control\"\n                  value={newPassword2}\n                  onChange={(e) => setNewPassword2(e.target.value)}\n                />\n              </div>\n              <div className=\"mb-3\" style={{ paddingBottom: \"50px\" }}>\n                <button\n                  className=\"btn btn-primary\"\n                  onClick={() =>\n                    dispatch(\n                      changePassword(oldPassword, newPassword1, newPassword2)\n                    )\n                  }\n                  disabled={\n                    oldPassword === \"\" ||\n                    newPassword1 === \"\" ||\n                    newPassword2 === \"\"\n                  }\n                >\n                  Change password\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <Footer footerText={footerText} />\n    </div>\n  );\n}\n","/* eslint-disable import/no-cycle */\r\nimport {\r\n  createSlice,\r\n  PayloadAction,\r\n  AnyAction,\r\n  Dispatch,\r\n} from '@reduxjs/toolkit';\r\nimport axios from 'axios';\r\n\r\nimport { RootState } from '../store';\r\nimport { setToken, setUsername } from './authSlice';\r\n\r\n\r\nconst initialState = {\r\n  fetchingIsPro: true,\r\n  isPro: false,\r\n  welcome: \"\"\r\n};\r\n\r\nconst versionSlice = createSlice({\r\n  name: 'version',\r\n  initialState,\r\n  reducers: {\r\n    setVersion(state, action: PayloadAction<{ isPro: boolean }>) {\r\n      const { isPro } = action.payload;\r\n      state.isPro = isPro;\r\n      state.fetchingIsPro = false;\r\n    },\r\n    setWelcome(state, action: PayloadAction<string>) {\r\n      state.welcome = action.payload;\r\n    }\r\n  },\r\n});\r\n\r\nexport default versionSlice.reducer;\r\n\r\nexport const {\r\n  setVersion,\r\n  setWelcome,\r\n} = versionSlice.actions;\r\n\r\nexport const getIsPro = (state: RootState) => state.version.isPro;\r\nexport const getFetchingIsPro = (state: RootState) => state.version.fetchingIsPro;\r\nexport const getWelcome = (state: RootState) => state.version.welcome;\r\n\r\nexport const fetchVersion =\r\n  () =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n\r\n      try {\r\n        const url = '/api/v1/version/';\r\n        const { data } = await axios.get(url);\r\n        dispatch(setVersion(data));\r\n      } catch (error) {\r\n        console.log(`Problem during loading Mercury version. ${error}`);\r\n        if (axios.isAxiosError(error)) {\r\n          if (error.response?.status === 401) {\r\n            // clear auth data \r\n            dispatch(setToken(null));\r\n            dispatch(setUsername(null));\r\n            window.location.reload();\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n\r\nexport const fetchWelcome =\r\n  (siteId: number) =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n\r\n      try {\r\n        const url = `/api/v1/${siteId}/welcome/`;\r\n        const { data } = await axios.get(url);\r\n        dispatch(setWelcome(data.msg));\r\n      } catch (error) {\r\n        console.log(`Problem during loading Mercury welcome message. ${error}`);\r\n      }\r\n\r\n    };\r\n\r\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nimport HomeNavBar from \"../components/HomeNavBar\";\nimport Footer from \"../components/Footer\";\nimport {\n  // fetchNbIframes,\n  fetchNotebooks,\n  getLoadingState,\n  // getNbIframes,\n  getNotebooks,\n} from \"../slices/notebooksSlice\";\nimport { fetchWelcome, getWelcome } from \"../slices/versionSlice\";\n\nimport ReactMarkdown from \"react-markdown\";\nimport rehypeHighlight from \"rehype-highlight\";\nimport remarkGfm from \"remark-gfm\";\nimport emoji from \"remark-emoji\";\nimport rehypeRaw from \"rehype-raw\";\nimport { getToken, getUsername } from \"../slices/authSlice\";\nimport {\n  getFooterText,\n  getLogoFilename,\n  getNavbarColor,\n  getSiteId,\n  getSiteWelcome,\n  isPublic,\n} from \"../slices/sitesSlice\";\nimport axios from \"axios\";\n\nimport DefaultLogoSrc from \"../components/DefaultLogo\";\nimport { Link } from \"react-router-dom\";\n\nexport default function HomeView() {\n  const dispatch = useDispatch();\n  const notebooks = useSelector(getNotebooks);\n  const loadingState = useSelector(getLoadingState);\n  const welcome = useSelector(getWelcome);\n  const username = useSelector(getUsername);\n  const token = useSelector(getToken);\n  const [showButton, setShowButton] = useState(\"\");\n  const siteId = useSelector(getSiteId);\n  const isSitePublic = useSelector(isPublic);\n  const siteWelcome = useSelector(getSiteWelcome);\n  const [logoSrc, setLogoSrc] = useState(\"loading\");\n  const logoFilename = useSelector(getLogoFilename);\n  const navbarColor = useSelector(getNavbarColor);\n  const footerText = useSelector(getFooterText);\n\n  useEffect(() => {\n    console.log({logoFilename})\n    if (siteId !== undefined) {\n      if (logoFilename === \"\") {\n        setLogoSrc(DefaultLogoSrc);\n      } else {\n        axios\n          .get(`/api/v1/get-style/${siteId}/${logoFilename}`)\n          .then((response) => {\n            const { url } = response.data;\n            setLogoSrc(url);\n          });\n      }\n    }\n  }, [dispatch, logoFilename, siteId]);\n\n  useEffect(() => {\n    if (siteId !== undefined) {\n      dispatch(fetchNotebooks(siteId));\n      if (siteWelcome === undefined || siteWelcome === \"\") {\n        dispatch(fetchWelcome(siteId));\n      }\n    }\n    // fetchNotebooks depends on token\n    // if token is set then private notebooks are returned\n  }, [dispatch, siteId, token, siteWelcome]);\n\n  const firstLetters = (text: string | null, count: number): string => {\n    if (text !== null && text !== undefined) {\n      return text.slice(0, count) + (text.length > count ? \" ...\" : \"\");\n    }\n    return \"\";\n  };\n\n  const notebookItems = notebooks.map((notebook, index) => {\n    let nbPath = notebook.default_view_path;\n\n    if (window.location.origin.startsWith(\"https\")) {\n      nbPath = nbPath.replace(\"http://\", \"https://\");\n    }\n\n    if (window.location.origin === \"http://localhost:3000\") {\n      if (nbPath.startsWith(\"/media\")) {\n        nbPath = \"https://127.0.0.1:8000\" + nbPath;\n      }\n    }\n\n    // if (window.location.origin !== \"http://localhost:3000\") {\n    //   if (nbPath.startsWith(\"https://127.0.0.1:8000\")) {\n    //     nbPath = nbPath.replace(\n    //       \"https://127.0.0.1:8000\",\n    //       window.location.origin\n    //     );\n    //   }\n    //   if (nbPath.startsWith(\"http://127.0.0.1:8000\")) {\n    //     nbPath = nbPath.replace(\n    //       \"http://127.0.0.1:8000\",\n    //       window.location.origin\n    //     );\n    //   }\n    // }\n\n    return (\n      <div\n        className=\"col-md-4\"\n        style={{ paddingBottom: \"20px\" }}\n        key={`notebook-${notebook.id}}`}\n      >\n        <div className=\"card\">\n          <div\n            style={{\n              height: \"200px\",\n              width: \"100%\",\n              padding: \"1px\",\n              overflow: \"hidden\",\n            }}\n          >\n            <iframe\n              className=\"thumbnailIframe\"\n              width=\"200%\"\n              height={800}\n              src={nbPath}\n              title=\"display\"\n              scrolling=\"no\"\n            ></iframe>\n\n            {/* <img\n              alt=\"some alt\" \n              \n              width=\"100%\"\n              src={`${notebook.default_view_path.replace(\".html\", \".png\")}`}\n            ></img> */}\n          </div>\n          <Link\n            to={`/app/${notebook.slug}`}\n            style={{ textDecoration: \"none\", color: \"black\" }}\n            className=\"title-card\"\n            onMouseEnter={() => {\n              setShowButton(notebook.slug);\n            }}\n            onMouseLeave={() => {\n              setShowButton(\"\");\n            }}\n            reloadDocument\n          >\n            <div\n              className=\"card-body\"\n              style={{\n                borderTop: \"1px solid rgba(0,0,0,0.1)\",\n                height: \"110px\",\n              }}\n            >\n              <h5 className=\"card-title\">{firstLetters(notebook.title, 40)}</h5>\n\n              <p className=\"card-text\">\n                {firstLetters(notebook.params.description, 100)}\n              </p>\n            </div>\n            {showButton === notebook.slug && (\n              <button\n                className=\"btn btn-outline-primary\"\n                type=\"button\"\n                style={{\n                  zIndex: \"101\",\n                  border: \"none\",\n                  margin: \"5px\",\n                  position: \"absolute\",\n                  right: \"0px\",\n                  bottom: \"0px\",\n                }}\n                data-toggle=\"tooltip\"\n                data-placement=\"right\"\n                title={`Open ${notebook.title}`}\n              >\n                <i className=\"fa fa-chevron-right\" aria-hidden=\"true\" />\n                <i className=\"fa fa-chevron-right\" aria-hidden=\"true\" />\n              </button>\n            )}\n            \n          </Link>\n        </div>\n      </div>\n    );\n  });\n\n  document.body.style.backgroundColor = \"white\";\n\n  let welcomeMd = siteWelcome;\n  if (welcomeMd === undefined || welcomeMd === \"\") {\n    welcomeMd = welcome;\n  }\n\n  return (\n    <div className=\"App\">\n      <HomeNavBar\n        isSitePublic={isSitePublic}\n        username={username}\n        logoSrc={logoSrc}\n        navbarColor={navbarColor}\n      />\n      <div className=\"container\" style={{ paddingBottom: \"50px\" }}>\n        {welcomeMd === \"\" && (\n          <h1 style={{ padding: \"30px\", textAlign: \"center\" }}>Welcome!</h1>\n        )}\n        {welcomeMd !== \"\" && (\n          <div style={{ paddingTop: \"20px\", paddingBottom: \"10px\" }}>\n            <ReactMarkdown\n              rehypePlugins={[remarkGfm, rehypeHighlight, emoji, rehypeRaw]}\n            >\n              {welcomeMd}\n            </ReactMarkdown>\n          </div>\n        )}\n\n        <div className=\"row\">\n          {loadingState === \"loading\" && (\n            <p>Loading notebooks. Please wait ...</p>\n          )}\n\n          {loadingState === \"loaded\" && notebooks.length === 0 && (\n            <div>\n              <p>There are no notebooks available.</p>\n            </div>\n          )}\n          {loadingState === \"error\" && (\n            <p>\n              Problem while loading notebooks. Please try again later or contact\n              Mercury administrator.\n            </p>\n          )}\n          {notebookItems}\n        </div>\n      </div>\n      <Footer footerText={footerText} />\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { fetchToken } from \"../slices/authSlice\";\nimport Footer from \"../components/Footer\";\nimport HomeNavBar from \"../components/HomeNavBar\";\n\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport {\n  getFooterText,\n  getLogoFilename,\n  getNavbarColor,\n  getSiteId,\n  isPublic,\n} from \"../slices/sitesSlice\";\nimport axios from \"axios\";\n\nimport DefaultLogoSrc from \"../components/DefaultLogo\";\n\ntype LocationState = {\n  from: {\n    pathname: string;\n  };\n};\n\nexport default function LoginView() {\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const isSitePublic = useSelector(isPublic);\n  const [logoSrc, setLogoSrc] = useState(\"loading\");\n  const logoFilename = useSelector(getLogoFilename);\n  const siteId = useSelector(getSiteId);\n  const navbarColor = useSelector(getNavbarColor);\n  const footerText = useSelector(getFooterText);\n\n  document.body.style.backgroundColor = \"#f5f5f5\";\n\n  let redirectPath = \"/\";\n  let location = useLocation();\n  if (location && location.state) {\n    // redirect from ...\n    const { from } = location.state as LocationState;\n    redirectPath = from.pathname;\n  }\n\n  useEffect(() => {\n    if (siteId !== undefined) {\n      if (logoFilename === \"\") {\n        setLogoSrc(DefaultLogoSrc);\n      } else {\n        axios\n          .get(`/api/v1/get-style/${siteId}/${logoFilename}`)\n          .then((response) => {\n            const { url } = response.data;\n            setLogoSrc(url);\n          });\n      }\n    }\n  }, [dispatch, logoFilename, siteId]);\n\n  return (\n    <div className=\"App\">\n      <HomeNavBar\n        isSitePublic={isSitePublic}\n        username={\"\"}\n        logoSrc={logoSrc}\n        navbarColor={navbarColor}\n      />\n\n      <div className=\"div-signin text-center\">\n        <form\n          className=\"form-signin\"\n          onSubmit={(e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            dispatch(fetchToken(email, password, redirectPath, navigate));\n          }}\n        >\n          <h3 className=\"h3 mb-3 font-weight-normal\">Please sign in</h3>\n          <label className=\"sr-only\">Email</label>\n          <input\n            type=\"email\"\n            id=\"inputEmail\"\n            className=\"form-control\"\n            placeholder=\"Email\"\n            value={email}\n            onChange={(e) => {\n              setEmail(e.target.value);\n            }}\n            required\n          />\n          <label className=\"sr-only\">Password</label>\n          <input\n            type=\"password\"\n            id=\"inputPassword\"\n            className=\"form-control\"\n            placeholder=\"Password\"\n            value={password}\n            onChange={(e) => {\n              setPassword(e.target.value);\n            }}\n            required\n          />\n          <button\n            className=\"btn btn-lg btn-primary btn-block\"\n            type=\"submit\"\n            style={{ margin: \"5px\" }}\n            disabled={email === \"\" || password === \"\"}\n          >\n            <i className=\"fa fa-sign-in\" aria-hidden=\"true\"></i> Log in\n          </button>\n        </form>\n        <div className=\"mx-auto\" style={{ width: \"400px\", marginTop: \"40px\" }}>\n          <p className=\"text-muted\">\n            No account? <br /> Please contact administrator to create account\n            for you.\n          </p>\n        </div>\n      </div>\n\n      <Footer footerText={footerText} />\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\n\nexport default function LostConnection() {\n  return (\n    <div className=\"App\">\n      <div\n        style={{\n          width: \"100%\",\n          maxWidth: \"500px\",\n          padding: \"15px\",\n          margin: \"0 auto\",\n        }}\n      >\n        <h3>Lost connection</h3>\n        <p>\n          App lost connection to the server. Please try again in a moment or\n          contact administrator.\n        </p>\n      </div>\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\nimport { Link } from \"react-router-dom\";\n\nexport default function SiteAccessForbiddenView() {\n  return (\n    <div className=\"App\">\n      <div\n        style={{\n          width: \"100%\",\n          maxWidth: \"500px\",\n          padding: \"15px\",\n          margin: \"0 auto\",\n        }}\n      >\n        <h3>Access forbidden</h3>\n        <p>\n          Please <Link to=\"/login\">login</Link> to access site.\n        </p>\n      </div>\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\n\nexport default function SiteLoadingView() {\n  return (\n    <div className=\"App\">\n      <div\n        style={{\n          width: \"100%\",\n          maxWidth: \"500px\",\n          padding: \"15px\",\n          margin: \"0 auto\",\n        }}\n      >\n        <p style={{ color: \"gray\" }}>Please wait. Loading site ...</p>\n      </div>\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\n\nexport default function SiteNetworkErrorView() {\n  return (\n    <div className=\"App\">\n      <div\n        style={{\n          width: \"100%\",\n          maxWidth: \"500px\",\n          padding: \"15px\",\n          margin: \"0 auto\",\n        }}\n      >\n        <h3>Network Error</h3>\n        <p>\n          Please check if you have internet connection and server is running. In\n          case of problems, please contact administrator.\n        </p>\n      </div>\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\n\nexport default function SiteNotFoundView() {\n  return (\n    <div className=\"App\">\n      <div\n        style={{\n          width: \"100%\",\n          maxWidth: \"500px\",\n          padding: \"15px\",\n          margin: \"0 auto\",\n        }}\n      >\n        <h3>Site does not exist</h3>\n        <p>\n          We can't find site you are looking for. Please make sure that URL\n          address is correct.\n        </p>\n      </div>\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\n\nexport default function SitePleaseRefreshView() {\n  return (\n    <div className=\"App\">\n      <div\n        style={{\n          width: \"100%\",\n          maxWidth: \"500px\",\n          padding: \"15px\",\n          margin: \"0 auto\",\n        }}\n      >\n        <h3>Please refresh</h3>\n        <p>Please try to refresh the website ...</p>\n      </div>\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\n\nexport default function SiteNotReadyView() {\n  return (\n    <div className=\"App\">\n      <div\n        style={{\n          width: \"100%\",\n          maxWidth: \"500px\",\n          padding: \"15px\",\n          margin: \"0 auto\",\n        }}\n      >\n        <h3>Site not ready</h3>\n        <p>\n          Your site is not ready yet. Please refresh page in a while or check\n          the dashboard.\n        </p>\n        <button\n          className=\"btn btn-success\"\n          onClick={() => window.location.reload()}\n        >\n          Refresh\n        </button>\n      </div>\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\n\nexport default function NotebookNotFoundView() {\n  return (\n    <div className=\"App\">\n      <div\n        style={{\n          width: \"100%\",\n          maxWidth: \"500px\",\n          padding: \"15px\",\n          margin: \"0 auto\",\n        }}\n      >\n        <h3>Notebook not found</h3>\n        <p>\n          We can't find your notebook. Please double check the URL address and\n          permissions.\n        </p>\n      </div>\n    </div>\n  );\n}\n","import { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useLocation, Navigate } from \"react-router-dom\";\nimport { getToken } from \"../slices/authSlice\";\nimport {\n  fetchSite,\n  getSiteStatus,\n  isPublic,\n  SiteStatus,\n} from \"../slices/sitesSlice\";\nimport LostConnection from \"../views/LostConnection\";\nimport SiteAccessForbiddenView from \"../views/SiteAccessForbiddenView\";\nimport SiteLoadingView from \"../views/SiteLoadingView\";\nimport SiteNetworkErrorView from \"../views/SiteNetworkErrorView\";\nimport SiteNotFoundView from \"../views/SiteNotFoundView\";\nimport SitePleaseRefreshView from \"../views/SitePleaseRefreshView\";\nimport SiteNotReadyView from \"../views/SiteNotReadyView\";\nimport NotebookNotFoundView from \"../views/NotebookNotFoundView\";\n\nexport default function RequireAuth({ children }: { children: JSX.Element }) {\n  const token = useSelector(getToken);\n  const isPublicSite = useSelector(isPublic);\n  let location = useLocation();\n  const dispatch = useDispatch();\n  const siteStatus = useSelector(getSiteStatus);\n\n  useEffect(() => {\n    dispatch(fetchSite());\n  }, [dispatch]);\n\n  if (siteStatus === SiteStatus.Unknown) {\n    return <SiteLoadingView />;\n  } else if (siteStatus === SiteStatus.NotFound) {\n    return <SiteNotFoundView />;\n  } else if (siteStatus === SiteStatus.NotReady) {\n    return <SiteNotReadyView />;\n  } else if (siteStatus === SiteStatus.AccessForbidden) {\n    return <SiteAccessForbiddenView />;\n  } else if (siteStatus === SiteStatus.NetworkError) {\n    return <SiteNetworkErrorView />;\n  } else if (siteStatus === SiteStatus.PleaseRefresh) {\n    return <SitePleaseRefreshView />;\n  } else if (siteStatus === SiteStatus.LostConnection) {\n    window.location.reload();\n    return <LostConnection />;\n  } else if (siteStatus === SiteStatus.NotebookNotFound) {\n    return <NotebookNotFoundView />;\n  }\n\n  if (!isPublicSite && !token) {\n    return <Navigate to=\"/login\" state={{ from: location }} replace />;\n  }\n\n  return children;\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getSiteId } from \"../slices/sitesSlice\";\nimport axios from \"axios\";\n\nimport { fetchNotebooks, getNotebooks } from \"../slices/notebooksSlice\";\nimport {\n  isCheckboxWidget,\n  isNumericWidget,\n  isRangeWidget,\n  isSelectWidget,\n  isSliderWidget,\n  isTextWidget,\n} from \"../widgets/Types\";\n\nexport default function OpenAPIView() {\n  const dispatch = useDispatch();\n  const siteId = useSelector(getSiteId);\n  const notebooks = useSelector(getNotebooks);\n\n  useEffect(() => {\n    if (siteId !== undefined) {\n      dispatch(fetchNotebooks(siteId));\n    }\n  }, [dispatch, siteId]);\n\n  const createTaskResponse = `, \"responses\": {\n    \"201\": {\n        \"description\": \"Request accepted for preprocessing, please check the processing state of the request using task_id\",\n        \"content\": {\n            \"application/json\": {\n                \"schema\": {\n                    \"type\": \"object\",\n                    \"properties\": {\n                        \"task_id\": {\n                          \"type\": \"string\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }`;\n\n  const notebookApis = notebooks.map((nb) => {\n    const endpoint = `/api/v1/${siteId}/run/${nb.slug}`;\n\n    const parameters = Object.entries(nb.params.params)\n      .map((p) => {\n        const w = p[1];\n\n        if (isSliderWidget(w)) {\n          if (w.url_key !== \"\") {\n            return `{\n            \"name\": \"${w.url_key}\",\n            \"in\": \"body\",\n            \"description\": \"${w.label}, value should be from range ${w.min} to ${w.max}\",\n            \"required\": false,\n            \"schema\": {\n                \"type\": \"number\"\n                }\n            }`;\n          }\n        } else if (isSelectWidget(w)) {\n          if (w.url_key !== \"\") {\n            return `{\n            \"name\": \"${w.url_key}\",\n            \"in\": \"body\",\n            \"description\": \"${\n              w.label\n            }, value should be from list [${w.choices.join(\",\")}]\",\n            \"required\": false,\n            \"schema\": {\n                \"type\": \"string\"\n                }\n            }`;\n          }\n        } else if (isCheckboxWidget(w)) {\n          if (w.url_key !== \"\") {\n            return `{\n            \"name\": \"${w.url_key}\",\n            \"in\": \"body\",\n            \"description\": \"${w.label}\",\n            \"required\": false,\n            \"schema\": {\n                \"type\": \"boolean\"\n                }\n            }`;\n          }\n        } else if (isNumericWidget(w)) {\n          if (w.url_key !== \"\") {\n            return `{\n            \"name\": \"${w.url_key}\",\n            \"in\": \"body\",\n            \"description\": \"${w.label}, value should be in range  ${w.min} to ${w.max}\",\n            \"required\": false,\n            \"schema\": {\n                \"type\": \"number\"\n                }\n            }`;\n          }\n        } else if (isRangeWidget(w)) {\n          if (w.url_key !== \"\") {\n            return `{\n            \"name\": \"${w.url_key}\",\n            \"in\": \"body\",\n            \"description\": \"${w.label}, parameter should be string with comma separated values, for example 3,5, allowed range is ${w.min} to ${w.max}\",\n            \"required\": false,\n            \"schema\": {\n                \"type\": \"string\"\n                }\n            }`;\n          }\n        } else if (isTextWidget(w)) {\n          if (w.url_key !== \"\") {\n            return `{\n            \"name\": \"${w.url_key}\",\n            \"in\": \"body\",\n            \"description\": \"${w.label}\",\n            \"required\": false,\n            \"schema\": {\n                \"type\": \"string\"\n              }\n            }`;\n          }\n        }\n\n        return ``;\n      })\n      .filter((s) => s !== \"\");\n\n    let desc = `\"${endpoint}\": {\n      \"post\": {\n          \"operationId\": \"Execute notebook ${nb.slug}\",\n          \"description\": \"${nb.params.description}\"\n       `;\n    if (parameters.length > 0) {\n      desc += `, \"parameters\": [`;\n      desc += parameters.join(\",\");\n      desc += `]`;\n    }\n    desc += createTaskResponse;\n    desc += `\n        }\n      }\n    `;\n    return desc;\n  });\n\n  const getTaskResponse = `\"responses\": {\n    \"200\": {\n        \"description\": \"Request processing completed successfully\",\n        \"content\": {\n            \"application/json\": {\n                \"schema\": {\n                    \"type\": \"object\",\n                    \"properties\": {\n                      \"state\": {\n                        \"type\": \"string\"\n                      },\n                      \"message\": {\n                        \"type\": \"string\"\n                      },\n                      \"result\": {\n                        \"type\": \"string\"\n                      }\n                  }\n                }\n            }\n        }\n    },\n    \"202\": {\n      \"description\": \"Request is still processing, please retry in 3 seconds\",\n      \"content\": {\n          \"application/json\": {\n              \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"state\": {\n                      \"type\": \"string\"\n                    },\n                    \"message\": {\n                      \"type\": \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }  \n        }`;\n\n  const getTask = `, \"/api/v1/get/{task_id}\": {\n    \"get\" : {\n      \"operationId\": \"Get state and result of processed request\",\n      \"description\": \"Use this endpoint to check if request processing state and result\",\n      \"parameters\": [\n        {\n          \"name\": \"task_id\",\n          \"in\": \"path\",\n          \"description\": \"task_id of your request\",\n          \"required\": true,\n          \"schema\": {\n            \"type\": \"string\"\n          }\n        }\n      ],\n      ${getTaskResponse}\n      }\n    }`;\n\n  const schema = `{\n    \"openapi\": \"3.0\",\n    \"info\": {\n        \"description\": \"Execute Python notebook and get JSON response\",\n        \"title\": \"Mercury OpenAPI\",\n        \"version\": \"1.0.0\"\n    },\n    \"servers\": [\n        {\n            \"url\": \"${axios.defaults.baseURL}\"\n        }\n    ],\n    \"paths\": {\n        ${notebookApis.join(\",\")}\n        ${getTask}\n  }\n}`;\n\n  return <pre>{schema}</pre>;\n}\n","/* eslint react/jsx-props-no-spreading: off */\nimport React, { ReactNode, useEffect } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport {\n  BrowserRouter as Router,\n  Routes,\n  Route,\n  Outlet,\n} from \"react-router-dom\";\n\nimport { setToken, setUsername } from \"./slices/authSlice\";\n// import { fetchVersion } from \"./slices/versionSlice\";\nimport { getSessionId } from \"./utils\";\nimport MainApp from \"./views/App\";\nimport AccountView from \"./views/AccountView\";\nimport HomeView from \"./views/HomeView\";\nimport LoginView from \"./views/LoginView\";\nimport { fetchSite } from \"./slices/sitesSlice\";\nimport RequireAuth from \"./components/RequireAuth\";\nimport WebSocketProvider from \"./websocket/Provider\";\nimport OpenAPIView from \"./views/OpenAPIView\";\ntype Props = {\n  children: ReactNode;\n};\n\nfunction App(props: Props) {\n  const { children } = props;\n  return <>{children}</>;\n}\n\nfunction AppLayout() {\n  return (\n    <RequireAuth>\n      <>\n        <Outlet />\n      </>\n    </RequireAuth>\n  );\n}\n\nexport default function AppRoutes() {\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    getSessionId(true);\n    // dispatch(fetchVersion());\n    if (localStorage.getItem(\"token\")) {\n      dispatch(setToken(localStorage.getItem(\"token\")));\n    }\n    if (localStorage.getItem(\"username\")) {\n      dispatch(setUsername(localStorage.getItem(\"username\")));\n    }\n\n    dispatch(fetchSite());\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <Router>\n      <App>\n        <Routes>\n          <Route path=\"/\" element={<AppLayout />}>\n            <Route path=\"/\" element={<HomeView />} />\n            <Route\n              path=\"/app/:slug/:embed?\"\n              element={\n                <WebSocketProvider>\n                  <MainApp />\n                </WebSocketProvider>\n              }\n            />\n            <Route path=\"/account\" element={<AccountView />} />\n            <Route path=\"/openapi\" element={<OpenAPIView />} />\n          </Route>\n          <Route path=\"/login\" element={<LoginView />} />\n        </Routes>\n      </App>\n    </Router>\n  );\n}\n","import React from \"react\";\nimport { Provider } from \"react-redux\";\nimport { History } from \"history\";\nimport { Store } from \"./store\";\nimport Routes from \"./Routes\";\n\ntype Props = {\n  store: Store;\n  history: History;\n};\nconst Root = ({ store, history }: Props) => (\n  <Provider store={store}>\n    <Routes />\n  </Provider>\n);\n\nexport default Root;\n","/* eslint-disable import/no-cycle */\nimport { configureStore, getDefaultMiddleware, Action } from '@reduxjs/toolkit';\nimport { createBrowserHistory } from 'history';\n\nimport { ThunkAction } from 'redux-thunk';\nimport createRootReducer from './rootReducer';\n\nexport const history = createBrowserHistory();\nconst rootReducer = createRootReducer(history);\nexport type RootState = ReturnType<typeof rootReducer>;\n\nconst middleware = [...getDefaultMiddleware()]; // , router];\n\nexport const configuredStore = (initialState?: RootState) => {\n  // Create Store\n  const store = configureStore({\n    reducer: rootReducer,\n    middleware,\n    preloadedState: initialState,\n  });\n  return store;\n};\nexport type Store = ReturnType<typeof configuredStore>;\nexport type AppThunk = ThunkAction<void, RootState, unknown, Action<string>>;\n","/* eslint-disable import/no-cycle */\nimport { combineReducers } from 'redux';\nimport { History } from 'history';\nimport notebooksReducer from './slices/notebooksSlice';\nimport tasksReducer from './slices/tasksSlice';\nimport versionReducer from './slices/versionSlice';\nimport appReducer from './slices/appSlice';\nimport authReducer from \"./slices/authSlice\";\nimport wsReducer from \"./slices/wsSlice\";\nimport sitesReducer from \"./slices/sitesSlice\";\n\nexport default function createRootReducer(history: History) {\n    return combineReducers({\n        notebooks: notebooksReducer,\n        tasks: tasksReducer,\n        // widgets: widgetsReducer,\n        version: versionReducer,\n        app: appReducer,\n        auth: authReducer,\n        ws: wsReducer,\n        sites: sitesReducer,\n    });\n}\n","import React from \"react\";\nimport { render } from \"react-dom\";\nimport axios from \"axios\";\nimport Root from \"./Root\";\nimport { history, configuredStore } from \"./store\";\n\nimport { ToastContainer } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport \"bootstrap/dist/js/bootstrap.min.js\";\nimport \"bootstrap/dist/css/bootstrap.css\";\nimport \"font-awesome/css/font-awesome.min.css\";\nimport \"react-block-ui/style.css\";\nimport \"filepond/dist/filepond.min.css\";\nimport \"filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css\";\nimport \"./index.css\";\n\nconst store = configuredStore();\n\nif (process.env.REACT_APP_SERVER_URL) {\n  axios.defaults.baseURL = process.env.REACT_APP_SERVER_URL;\n} else {\n  if (window.location.origin === \"http://localhost:3000\") {\n    axios.defaults.baseURL = \"http://127.0.0.1:8000\";\n  } else {\n    axios.defaults.baseURL = window.location.origin;\n  }  \n}\n\nif (window.location.origin.endsWith(\"hf.space\")) {\n  axios.defaults.baseURL = window.location.origin;\n}\n\n// in the case of some special params in the url\naxios.defaults.baseURL = axios.defaults.baseURL.split(\"+\")[0];\naxios.defaults.baseURL = axios.defaults.baseURL.split(\"?\")[0];\naxios.defaults.baseURL = axios.defaults.baseURL.split(\"#\")[0];\n\n\ndocument.addEventListener(\"DOMContentLoaded\", () =>\n  render(\n    <div>\n      <Root store={store} history={history} />\n      <ToastContainer\n        position=\"top-right\"\n        autoClose={3000}\n        hideProgressBar={true}\n        newestOnTop={true}\n        closeOnClick\n        pauseOnHover\n      />\n    </div>,\n    document.getElementById(\"root\")\n  )\n);\n"],"sourceRoot":""}
